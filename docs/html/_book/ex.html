<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>27&nbsp; Exercises – Bayes, AI and Deep Learning</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./references.html" rel="next">
<link href="./26-robots.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-680e7c22d93ef26f016bec9199f8e6d8.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="site_libs/quarto-diagram/mermaid.min.js"></script>
<script src="site_libs/quarto-diagram/mermaid-init.js"></script>
<link href="site_libs/quarto-diagram/mermaid.css" rel="stylesheet">
<script>
  // Load MathJax with custom macros
  window.MathJax = {
    tex: {
      macros: {
        Cov: ["\\mathrm{Cov}\\left(#1\\right)", 1],
        Cor: ["\\mathrm{Cor}\\left(#1\\right)", 1],
        Var: ["\\mathrm{Var}\\left(#1\\right)", 1],
        sd: ["\\mathrm{sd}\\left(#1\\right)", 1],
        E: ["\\mathrm{E}_{#1}\\left(#2\\right)", 2, ""],
        prob: ["\\mathrm{P}\\left(#1\\right)", 1],
        defeq: "\\stackrel{\\mathrm{def}}{=}",
        mini: "\\operatorname*{minimize}"
      }
    }
  };
</script>

<style>
  /* Custom styling for math content */
  .MathJax {
    font-size: 1em !important;
  }
  
  /* Ensure consistent math rendering */
  mjx-container[jax="CHTML"] {
    line-height: 1.2;
  }
</style>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="27&nbsp; Exercises – Bayes, AI and Deep Learning">
<meta property="og:image" content="ex_files/figure-html/unnamed-chunk-9-1.png">
<meta property="og:site_name" content="Bayes, AI and Deep Learning">
<meta name="twitter:title" content="27&nbsp; Exercises – Bayes, AI and Deep Learning">
<meta name="twitter:image" content="ex_files/figure-html/unnamed-chunk-9-1.png">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar docked quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./ex.html"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Exercises</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Bayes, AI and Deep Learning</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Principles of Data Science</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Bayes</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-prob.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Probability and Uncertainty</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-bayes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Bayes Rule</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-bl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Bayesian Learning</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-dec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Utility, Risk and Decisions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-ab.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">AB Testing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-hyp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Bayesian Hypothesis Testing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-sp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Stochastic Processes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-gp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Gaussian Processes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-rl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Reinforcement Learning</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">AI</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Unreasonable Effectiveness of Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-pattern.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Pattern Matching</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Linear Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Logistic Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-tree.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Tree Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-forecasting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Forecasting</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-rct.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Randomized Controlled Trials</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17-select.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Model Selection</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./18-theoryai.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Theory of AI: From MLE to Bayesian Regularization</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Deep Learning</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./19-nn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Neural Networks</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./20-theorydl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Theory of Deep Learning</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./21-sgd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Gradient Descent</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./22-qnn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Quantile Neural Networks</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./23-cnn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Convolutional Neural Networks</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./24-nlp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Natural Language Processing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./25-llm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Large Language Models: A Revolution in AI</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./26-robots.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">AI Agents</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ex.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Exercises</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#probability" id="toc-probability" class="nav-link active" data-scroll-target="#probability"><span class="header-section-number">27.1</span> Probability</a>
  <ul class="collapse">
  <li><a href="#computing" id="toc-computing" class="nav-link" data-scroll-target="#computing">Computing</a></li>
  </ul></li>
  <li><a href="#bayes-rule" id="toc-bayes-rule" class="nav-link" data-scroll-target="#bayes-rule"><span class="header-section-number">27.2</span> Bayes Rule</a></li>
  <li><a href="#utility-and-decisions" id="toc-utility-and-decisions" class="nav-link" data-scroll-target="#utility-and-decisions"><span class="header-section-number">27.3</span> Utility and Decisions</a></li>
  <li><a href="#bayesian-parameter-learning" id="toc-bayesian-parameter-learning" class="nav-link" data-scroll-target="#bayesian-parameter-learning"><span class="header-section-number">27.4</span> Bayesian Parameter Learning</a></li>
  <li><a href="#ab-testing-1" id="toc-ab-testing-1" class="nav-link" data-scroll-target="#ab-testing-1"><span class="header-section-number">27.5</span> AB Testing</a></li>
  <li><a href="#field-vs-observational" id="toc-field-vs-observational" class="nav-link" data-scroll-target="#field-vs-observational"><span class="header-section-number">27.6</span> Field vs Observational</a></li>
  <li><a href="#added-after-course-started" id="toc-added-after-course-started" class="nav-link" data-scroll-target="#added-after-course-started"><span class="header-section-number">27.7</span> Added After Course Started</a></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Exercises</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="probability" class="level2" data-number="27.1">
<h2 data-number="27.1" class="anchored" data-anchor-id="probability"><span class="header-section-number">27.1</span> Probability</h2>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.1 (Joint Distributions)</strong></span> A credit card company collects data on <span class="math inline">\(10,000\)</span> users. The data contained two variables: an indicator of he customer status: whether they are in default (<code>def</code> =1) or if they are current with their payments (<code>def</code> =0). Moreover, they have a measure of their loan balance relative to income with three categories: a low balance (<code>bal</code>=1), medium (<code>bal</code>=2) and high (<code>bal</code>=3). The data are given in the following table:</p>
<table class="caption-top table">
<tbody>
<tr class="odd">
<td></td>
<td style="text-align: center;">def</td>
<td></td>
</tr>
<tr class="even">
<td>bal</td>
<td style="text-align: center;">0</td>
<td>1</td>
</tr>
<tr class="odd">
<td>1</td>
<td style="text-align: center;">8,940</td>
<td>64</td>
</tr>
<tr class="even">
<td>2</td>
<td style="text-align: center;">651</td>
<td>136</td>
</tr>
<tr class="odd">
<td>3</td>
<td style="text-align: center;">76</td>
<td>133</td>
</tr>
</tbody>
</table>
<ol type="a">
<li>Compute the marginal distribution of customer status</li>
<li>What is the conditional distribution of bal given <code>def</code> =1</li>
<li>Make a prediction for the status of a customer with a high balance</li>
</ol>
<p><strong>Solution</strong>:</p>
<ol type="a">
<li>The marginal distribution of customer status is given by the sum of the rows of the table.</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">def0=</span><span class="fu">c</span>(<span class="dv">8940</span>,<span class="dv">651</span>,<span class="dv">76</span>),<span class="at">def1=</span><span class="fu">c</span>(<span class="dv">64</span>,<span class="dv">136</span>,<span class="dv">133</span>),<span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">"bal1"</span>,<span class="st">"bal2"</span>,<span class="st">"bal3"</span>))</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(d,<span class="dv">2</span>,sum)<span class="sc">/</span><span class="dv">10000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##  def0  def1 
## 0.967 0.033</code></pre>
</div>
</div>
<ol start="2" type="a">
<li>The conditional distribution of <code>bal</code> given <code>def</code> =1 is given by the ratio of the joint (elements of the table) to the marginal (sum of the <code>def</code> =1 column)</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>d[,<span class="st">"def1"</span>]<span class="sc">/</span><span class="fu">sum</span>(d[,<span class="st">"def1"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.19 0.41 0.40</code></pre>
</div>
</div>
<ol start="3" type="a">
<li>The prediction for the status of a customer with a high balance is the conditional distribution over <code>def</code> =1, given balance. <span class="math display">\[
P(def\mid bal) = \frac{P(def \text{ and } bal)}{P(bal)}
\]</span></li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>balmarginal <span class="ot">=</span> <span class="fu">apply</span>(d,<span class="dv">1</span>,sum)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>d1b3 <span class="ot">=</span> d[<span class="st">"bal3"</span>,<span class="st">"def1"</span>]<span class="sc">/</span>balmarginal[<span class="st">"bal3"</span>]</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>d1b1 <span class="ot">=</span> d[<span class="st">"bal1"</span>,<span class="st">"def1"</span>]<span class="sc">/</span>balmarginal[<span class="st">"bal1"</span>]</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(d1b3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## bal3 
## 0.64</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(d1b1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##   bal1 
## 0.0071</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The ratio is </span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>d1b3<span class="sc">/</span>d1b1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## bal3 
##   90</code></pre>
</div>
</div>
<p>Person with high balance has 63% chance of being in default, while a person with low balance has 0.7% chance of being in default, 90-times less likely!</p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.2 (Marginal)</strong></span> The table below is taken from the Hoff text and shows the joint distribution of occupations taken from a 1983 study of social mobility by <span class="citation" data-cites="logan1983multivariate">Logan (<a href="references.html#ref-logan1983multivariate" role="doc-biblioref">1983</a>)</span>. Each cell is P(father’s occupation, son’s occupation).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">farm =</span> <span class="fu">c</span>(<span class="fl">0.018</span>,<span class="fl">0.002</span>,<span class="fl">0.001</span>,<span class="fl">0.001</span>,<span class="fl">0.001</span>),<span class="at">operatives=</span><span class="fu">c</span>(<span class="fl">0.035</span>,<span class="fl">0.112</span>,<span class="fl">0.066</span>,<span class="fl">0.018</span>,<span class="fl">0.029</span>),<span class="at">craftsman=</span><span class="fu">c</span>(<span class="fl">0.031</span>,<span class="fl">0.064</span>,<span class="fl">0.094</span>,<span class="fl">0.019</span>,<span class="fl">0.032</span>),<span class="at">sales=</span><span class="fu">c</span>(<span class="fl">0.008</span>,<span class="fl">0.032</span>,<span class="fl">0.032</span>,<span class="fl">0.010</span>,<span class="fl">0.043</span>),<span class="at">professional=</span><span class="fu">c</span>(<span class="fl">0.018</span>,<span class="fl">0.069</span>,<span class="fl">0.084</span>,<span class="fl">0.051</span>,<span class="fl">0.130</span>), <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">"farm"</span>,<span class="st">"operative"</span>,<span class="st">"craftsman"</span>,<span class="st">"sales"</span>,<span class="st">"professional"</span>))</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">farm</th>
<th style="text-align: right;">operatives</th>
<th style="text-align: right;">craftsman</th>
<th style="text-align: right;">sales</th>
<th style="text-align: right;">professional</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">farm</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">0.02</td>
</tr>
<tr class="even">
<td style="text-align: left;">operative</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.07</td>
</tr>
<tr class="odd">
<td style="text-align: left;">craftsman</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.07</td>
<td style="text-align: right;">0.09</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.08</td>
</tr>
<tr class="even">
<td style="text-align: left;">sales</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">0.05</td>
</tr>
<tr class="odd">
<td style="text-align: left;">professional</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">0.13</td>
</tr>
</tbody>
</table>
</div>
</div>
<ol type="a">
<li>Find the marginal distribution of fathers’ occupations.</li>
<li>Find the marginal distribution of sons’ occupations.</li>
<li>Find the conditional distribution of the son’s occupation given that the father is a farmer.</li>
<li>Find the conditional distribution of the father’s occupation given that the son is a farmer.</li>
<li>Comment on these results. What do they say about changes in farming in the population from which these data are drawn?</li>
</ol>
<p><strong>Solution</strong>:</p>
<ol type="a">
<li></li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(d,<span class="dv">1</span>,sum)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##         farm    operative    craftsman        sales professional 
##        0.110        0.279        0.277        0.099        0.235</code></pre>
</div>
</div>
<ol start="2" type="a">
<li></li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(d,<span class="dv">2</span>,sum)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##         farm   operatives    craftsman        sales professional 
##        0.023        0.260        0.240        0.125        0.352</code></pre>
</div>
</div>
<ol start="3" type="a">
<li></li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>d[<span class="st">"farm"</span>,]<span class="sc">/</span><span class="fu">sum</span>(d[<span class="st">"farm"</span>,])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">farm</th>
<th style="text-align: right;">operatives</th>
<th style="text-align: right;">craftsman</th>
<th style="text-align: right;">sales</th>
<th style="text-align: right;">professional</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">farm</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">0.32</td>
<td style="text-align: right;">0.28</td>
<td style="text-align: right;">0.07</td>
<td style="text-align: right;">0.16</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<ol start="4" type="a">
<li></li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>d[,<span class="st">"farm"</span>]<span class="sc">/</span><span class="fu">sum</span>(d[,<span class="st">"farm"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.783 0.087 0.043 0.043 0.043</code></pre>
</div>
</div>
<ol start="5" type="a">
<li></li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>dd <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">son=</span><span class="fu">as.double</span>(d[<span class="st">"farm"</span>,]<span class="sc">/</span><span class="fu">sum</span>(d[<span class="st">"farm"</span>,])),<span class="at">father=</span><span class="fu">as.double</span>(d[,<span class="st">"farm"</span>]<span class="sc">/</span><span class="fu">sum</span>(d[,<span class="st">"farm"</span>])))</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="at">height =</span> <span class="fu">t</span>(<span class="fu">as.matrix</span>(dd)),<span class="at">beside=</span><span class="cn">TRUE</span>,<span class="at">legend=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ex_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>The bar chart allows us to visualize the marginal distributions of occupations of fathers and sons. The striking feature of this chart is that in the sons, the proportion of farmers has greatly decreased and the proportion of professionals has increased. From Part d, we see that of the sons who are farmers, 78% had fathers who are farmers. On the other hand, Part c shows that only 16% of the fathers who farmed produced sons who farmed. This is higher than the 2.3% of sons in the general population who became farmers, showing that sons of farmers went into farming at a rate higher than the general population of the study. However, most of the sons of farmers went into another profession. There was a great deal of movement out of farming and very little movement into farming from the fathers’ to the sons’ generation.</p>
<p>To determine the validity of inference outside the sample, we would need to know more about how the study was designed. We do not know how the sample was selected or what steps were taken to ensure it was representative of the population being studied. We also are not given the sample size, so we don’t know the accuracy of our probability estimates. The paper from which the table was taken, cited in the problem, provides more detail on the study.</p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.3 (Conditional)</strong></span> Netflix surveyed the general population as to the number of hours per week that you used their service. The following table provides the proportions of each category according to whether you are a teenager or adults.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Hours</th>
<th style="text-align: center;">Teenager</th>
<th style="text-align: center;">Adult</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(&lt;4\)</span></td>
<td style="text-align: center;">0.18</td>
<td style="text-align: center;">0.20</td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(4\)</span> to <span class="math inline">\(6\)</span></td>
<td style="text-align: center;">0.12</td>
<td style="text-align: center;">0.32</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(&gt;6\)</span></td>
<td style="text-align: center;">0.04</td>
<td style="text-align: center;">0.14</td>
</tr>
</tbody>
</table>
<p>Calculate the following probabilities:</p>
<ol type="a">
<li>Given that you spend <span class="math inline">\(4\)</span> to <span class="math inline">\(6\)</span> hours a week watching movies, what’s the probability that you are a teenager?</li>
<li>What is the marginal distribution of hours spent watching movies.</li>
<li>Are hours spent watching Netflix movies independent of age?</li>
</ol>
<p><strong>Solution</strong>:</p>
<ol type="a">
<li><p><span class="math inline">\(\frac{0.12}{0.12+0.32}=0.2727\)</span></p></li>
<li><p>See Table:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Hours</th>
<th style="text-align: center;">Probability</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(&lt;4\)</span></td>
<td style="text-align: center;">0.18+0.20=0.38</td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(4\)</span> to <span class="math inline">\(6\)</span></td>
<td style="text-align: center;">00.12+0.32=0.44</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(&gt;6\)</span></td>
<td style="text-align: center;">0.04+0.14=0.18</td>
</tr>
</tbody>
</table></li>
<li><p>No, the marginal distribution of hours given you are a teenager or adult are not the same:</p></li>
</ol>
<table class="caption-top table">
<colgroup>
<col style="width: 13%">
<col style="width: 43%">
<col style="width: 42%">
</colgroup>
<thead>
<tr class="header">
<th>Hours</th>
<th>Teenager</th>
<th>Adult</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(&lt;4\)</span></td>
<td><span class="math inline">\(\frac{0.18}{0.18+0.12+0.04}=0.5294\)</span></td>
<td><span class="math inline">\(\frac{0.20}{0.20+0.32+0.14}=0.3030\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(4\)</span> to <span class="math inline">\(6\)</span></td>
<td><span class="math inline">\(\frac{0.12}{0.18+0.12+0.04}=0.3529\)</span></td>
<td><span class="math inline">\(\frac{0.32}{0.20+0.32+0.14}=0.4848\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(&gt;6\)</span></td>
<td><span class="math inline">\(\frac{0.04}{0.18+0.12+0.04}=0.1176\)</span></td>
<td><span class="math inline">\(\frac{0.14}{0.20+0.32+0.14}=0.2121\)</span></td>
</tr>
</tbody>
</table>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.4 (Joint and Conditional)</strong></span> The following probability table relates <span class="math inline">\(Y\)</span> the number of TV shows watched by the typical student in an evening to the number of drinks <span class="math inline">\(X\)</span> consumed.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th style="text-align: center;">Y</th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>X</td>
<td style="text-align: center;">0</td>
<td>1</td>
<td>2</td>
<td>3</td>
</tr>
<tr class="even">
<td>0</td>
<td style="text-align: center;">0.07</td>
<td>0.09</td>
<td>0.06</td>
<td>0.01</td>
</tr>
<tr class="odd">
<td>1</td>
<td style="text-align: center;">0.07</td>
<td>0.06</td>
<td>0.07</td>
<td>0.01</td>
</tr>
<tr class="even">
<td>2</td>
<td style="text-align: center;">0.06</td>
<td>0.07</td>
<td>0.14</td>
<td>0.03</td>
</tr>
<tr class="odd">
<td>3</td>
<td style="text-align: center;">0.02</td>
<td>0.04</td>
<td>0.16</td>
<td>0.04</td>
</tr>
</tbody>
</table>
<ol type="a">
<li>What is the probability that a student has more than two drinks in an evening?</li>
<li>What is the probability that a student drink more than the number of TV shows they watch?</li>
<li>What’s the conditional distribution of the number of TV shows watched given they consume <span class="math inline">\(3\)</span> drinks?</li>
<li>What’s the expected number of drinks given they do not watch TV</li>
<li>Are drinking and watching TV independent?</li>
</ol>
<p><strong>Solution</strong>:</p>
<ol type="a">
<li><span class="math inline">\(P(X &gt; 2 ) = 0.26\)</span>.</li>
<li><span class="math inline">\(P(X&gt;Y) = 0.42\)</span></li>
<li><span class="math inline">\(P( Y | X=4 )\)</span> are given by <span class="math inline">\(( 1/13 , 2/13 , 8/13 , 2/13 )\)</span>.</li>
<li><span class="math inline">\(P( X | Y=0 )\)</span> are given by <span class="math inline">\(( 7/22 , 7/22 , 1/11 , 3/11 )\)</span> and so <span class="math inline">\(E(X| Y=0) = 25/22 = 1.13\)</span></li>
<li>No.&nbsp;<span class="math inline">\(P( X = 2 \text{ and } Y=2 )= 0.14 \neq 0.43 \times 0.30 = P(X=2 ) P(Y=2)\)</span></li>
</ol>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.5 (Conditional probability)</strong></span> Shipments from an online retailer take between 1 and 7 days to arrive, depending on where they ship from, when they were ordered, the size of the item, etc. Suppose the distribution of delivery times has the following distribution function:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">x</th>
<th style="text-align: center;">1</th>
<th style="text-align: center;">2</th>
<th style="text-align: center;">3</th>
<th style="text-align: center;">4</th>
<th style="text-align: center;">5</th>
<th style="text-align: center;">6</th>
<th style="text-align: center;">7</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(\mbox{P}(X = x)\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(\mbox{P}(X \leq x)\)</span></td>
<td style="text-align: center;">0.10</td>
<td style="text-align: center;">0.20</td>
<td style="text-align: center;">0.70</td>
<td style="text-align: center;">0.75</td>
<td style="text-align: center;">0.80</td>
<td style="text-align: center;">0.90</td>
<td style="text-align: center;">1</td>
</tr>
</tbody>
</table>
<ol type="a">
<li>Fill in the above probability table.</li>
<li>What is the conditional probability of a delivery arriving on day four given that it did not arrive in the first three days? (Hint: find <span class="math inline">\(P(X = 4 \mid X &gt;= 4)\)</span>)</li>
</ol>
<p><strong>Solution</strong>:</p>
<p><span class="math display">\[P(X = 1) = P(X \leq 1) = 0.1\]</span> <span class="math display">\[P(X = 2) = P(X \leq 2) - P(X \leq 1) = 0.2 - 0.1 = 0.1\]</span> <span class="math display">\[P(X = 3) = P(X \leq 3) - P(X \leq 2) = 0.7 - 0.2 = 0.5\]</span></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">x</th>
<th style="text-align: center;">1</th>
<th style="text-align: center;">2</th>
<th style="text-align: center;">3</th>
<th style="text-align: center;">4</th>
<th style="text-align: center;">5</th>
<th style="text-align: center;">6</th>
<th style="text-align: center;">7</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(\mbox{P}(X = x)\)</span></td>
<td style="text-align: center;">0.10</td>
<td style="text-align: center;">0.10</td>
<td style="text-align: center;">0.50</td>
<td style="text-align: center;">0.05</td>
<td style="text-align: center;">0.05</td>
<td style="text-align: center;">0.10</td>
<td style="text-align: center;">0.10</td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(\mbox{P}(X \leq x)\)</span></td>
<td style="text-align: center;">0.10</td>
<td style="text-align: center;">0.20</td>
<td style="text-align: center;">0.70</td>
<td style="text-align: center;">0.75</td>
<td style="text-align: center;">0.80</td>
<td style="text-align: center;">0.90</td>
<td style="text-align: center;">1</td>
</tr>
</tbody>
</table>
<p><span class="math display">\[
\begin{aligned}
P(X &gt;= 4) &amp;= 0.05 + 0.05 + 0.10 + 0.10 = 0.30\\
P(X = 4 \text{ and } X &gt;=4) &amp;= P(X = 4) = 0.05\\
P(X = 4 \mid X &gt;= 4) &amp;= \frac{P(X = 4 \text{ and } X &gt;=4)}{P(X &gt;= 4)} = \frac{0.05}{0.30} = \frac{1}{6}\end{aligned}
\]</span></p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.6 (Joint and Conditional)</strong></span> A cable television company has <span class="math inline">\(10000\)</span> subscribers in a suburban community. The company offers two premium channels, HBO and Showtime. Suppose <span class="math inline">\(2750\)</span> subscribers receive HBO and <span class="math inline">\(2050\)</span> receive Showtime and <span class="math inline">\(6200\)</span> do not receive any premium channel.</p>
<ol type="a">
<li>What is the probability that a randomly selected subscriber receives both HBO and Showtime.</li>
<li>What is the probability that a randomly selected subscriber receives HBO but not Showtime.</li>
</ol>
<p>You now obtain a new dataset, categorized by gender, on the proportions of people who watch HBO and Showtime given below</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">Cable</th>
<th style="text-align: left;">Female</th>
<th style="text-align: left;">Male</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">HBO</td>
<td style="text-align: left;">0.14</td>
<td style="text-align: left;">0.48</td>
</tr>
<tr class="even">
<td style="text-align: left;">Showtime</td>
<td style="text-align: left;">0.17</td>
<td style="text-align: left;">0.21</td>
</tr>
</tbody>
</table>
<ol start="3" type="a">
<li>Conditional on being female, what’s the probability you receive HBO?</li>
<li>Conditional on being female, what’s the probability you receive Showtime?</li>
</ol>
<p><strong>Solution</strong>:</p>
<ol type="a">
<li>We can calculate the number of people who receive both HBO and Showtime by calculating how many were “double counted” in the HBO and Showtime counts.</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="dv">10000</span> <span class="sc">-</span> <span class="dv">6200</span> <span class="sc">-</span> <span class="dv">2750</span> <span class="sc">-</span> <span class="dv">2050</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] -1000</code></pre>
</div>
</div>
<p>Thus, the answer is <span class="math inline">\(1000/10000 = 0.1\)</span>.</p>
<ol type="a">
<li><span class="math inline">\(\frac{2750-1000}{10000}=\frac{1750}{10000}=0.175\)</span></li>
<li><span class="math inline">\(P(HBO|F)=\frac{0.14}{0.14+0.17}=0.4516\)</span></li>
<li><span class="math inline">\(P(Show|F)=\frac{0.17}{0.14+0.17}=0.5484\)</span></li>
</ol>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.7 (Conditionals and Expectations)</strong></span> The following probability table describes the daily sales volume, <span class="math inline">\(X\)</span>, in thousands of dollars for a salesperson for the number of years <span class="math inline">\(Y\)</span> of sales experience for a particular company.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th style="text-align: center;">Y</th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>X</td>
<td style="text-align: center;">1</td>
<td>2</td>
<td>3</td>
<td>4</td>
</tr>
<tr class="even">
<td>10</td>
<td style="text-align: center;">0.14</td>
<td>0.03</td>
<td>0.03</td>
<td>0</td>
</tr>
<tr class="odd">
<td>20</td>
<td style="text-align: center;">0.05</td>
<td>0.10</td>
<td>0.12</td>
<td>0.07</td>
</tr>
<tr class="even">
<td>30</td>
<td style="text-align: center;">0.10</td>
<td>0.06</td>
<td>0.25</td>
<td>0.05</td>
</tr>
</tbody>
</table>
<ol type="a">
<li>Verify that this is a legal probability table.</li>
<li>What is the probability of at least two years experience?</li>
<li>Calculate the mean daily sales volume</li>
<li>Given a salesperson has three years experience, calculate the mean daily sales volume.</li>
<li>A salesperson is paid $1000 per week plus 2% of total sales. What is the expected compensation for a salesperson?</li>
</ol>
<p><strong>Solution</strong>:</p>
<ol type="a">
<li>All probabilities are between zero and one, and the entire table adds to one</li>
<li><span class="math inline">\(P(Y\geq 2)=0.19+0.40+0.12=0.71\)</span></li>
<li><span class="math inline">\(E(X) = 10 \times 0.20 + 20 \times 0.34 + 30 \times 0.46 = 22.6\)</span>, that is $22,600</li>
<li>First, the conditional probability distribution <span class="math inline">\(p( X|Y)\)</span> is given by, <span class="math inline">\(0.03 /0.4 , 0.12/0.4 , 0.25/0.4\)</span>. Hence <span class="math inline">\(E(X|Y=3)=10\times 0.075+20\times 0.3+30\times 0.625=25.5,\)</span> that is $25,500</li>
<li>Assuming a 5-day workweek, <span class="math inline">\(E(Comp)=1000+0.02E(X_{1}+X_{2}+X_{3}+X_{4}+X_{5})=1000+0.02\cdot 5\cdot E(X)=1000+0.02\cdot 5\cdot 22600=\$3,260\)</span>. With a 7-day week, <span class="math inline">\(E(Comp)=1000+0.02\cdot 7\cdot 22600=\$4,164\)</span></li>
</ol>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.8 (Expectation)</strong></span> <span class="math inline">\(E(X+Y) = E(X) + E(Y)\)</span> only if the random variables <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are independent</p>
<p><strong>Solution</strong>:</p>
<p>False. By the plug-in rule, this relation holds irrespective of whether <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are independent.</p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.9 (Conditional Probability)</strong></span> A super market carried out a survey and found the following probabilities for people who buy generic products depending on whether they visit the store frequently or not</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th style="text-align: center;">Purchase Generic</th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Visit</td>
<td style="text-align: center;">Often</td>
<td>Sometime</td>
<td>Never</td>
</tr>
<tr class="even">
<td>Frequent</td>
<td style="text-align: center;">0.10</td>
<td>0.50</td>
<td>0.17</td>
</tr>
<tr class="odd">
<td>Infrequent</td>
<td style="text-align: center;">0.03</td>
<td>0.05</td>
<td>0.15</td>
</tr>
</tbody>
</table>
<ol type="a">
<li>What is the probability that a customer who never buys generics visits the store?</li>
<li>What is the probability that a customer often purchases generic?</li>
<li>Are buying generics and visiting the store independent decisions?</li>
<li>What is the conditional distribution of purchasing generics given that you frequently visit the store?</li>
</ol>
<p><strong>Solution</strong>:</p>
<ol type="a">
<li><span class="math inline">\(P ( F \text{ and } N ) + P ( \bar{F} \text{ and } N ) = 0.17 + 0.15 = 0.32\)</span></li>
<li><span class="math inline">\(P( F \text{ and } O ) + P( \bar{F} \text{ and } O ) = 0.10 + 0.03 = 0.13\)</span></li>
<li><span class="math inline">\(P( F | S ) = 0.9091 , P( \bar{F} | S ) = 0.0909\)</span> and <span class="math inline">\(P( F | O ) = 0.7692 , P( \bar{F} | O ) = 0.2308\)</span>. The probabilities are not the same so the events are not independent.</li>
<li><span class="math inline">\(P( O | F ) = 0.1299 , P( S| F) = 0.6494 , P( N | F ) = 0.2208\)</span>.</li>
</ol>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.10 (Conditional Probability)</strong></span> Cooper Realty is a small real estate company located in Albany, New York, specializing primarily in residential listings. They have recently become interested in determining the likelihood of one of their listings being sold within a certain number of days. An analysis of recent company sales of 800 homes in produced the following table:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Days Listed until Sold</th>
<th style="text-align: center;">Under 20</th>
<th style="text-align: center;">31-90</th>
<th style="text-align: center;">Over 90</th>
<th style="text-align: center;">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Under $50K</td>
<td style="text-align: center;">50</td>
<td style="text-align: center;">40</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">100</td>
</tr>
<tr class="even">
<td style="text-align: center;">$50-$100K</td>
<td style="text-align: center;">20</td>
<td style="text-align: center;">150</td>
<td style="text-align: center;">80</td>
<td style="text-align: center;">250</td>
</tr>
<tr class="odd">
<td style="text-align: center;">$100-$150K</td>
<td style="text-align: center;">20</td>
<td style="text-align: center;">280</td>
<td style="text-align: center;">100</td>
<td style="text-align: center;">400</td>
</tr>
<tr class="even">
<td style="text-align: center;">Over $ 150K</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">30</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">50</td>
</tr>
</tbody>
</table>
<ol type="a">
<li>Estimate the probability that a home listed for over 90 days before being sold</li>
<li>Estimate the probability that the initial asking price is under $50K.</li>
<li>What the the probability of both of the above happening? Are these two events independent?</li>
<li>Assuming that a contract has just been signed to list a home that has an initial asking price of less than $100K, what is the probability that the home will take Cooper Realty more than 90 days to sell?</li>
</ol>
<p><strong>Solution</strong>: Let <span class="math inline">\(A\)</span> be the event that it takes more than 90 days to sell. Let <span class="math inline">\(B\)</span> denote the event that the initial asking price is under $50K.</p>
<ol type="a">
<li><span class="math inline">\(P(A) = ( 10 + 80 + 100 + 10)/800 = 200/800 = 0.25\)</span></li>
<li><span class="math inline">\(P(B) = 100/800 = 0.125\)</span></li>
<li><span class="math inline">\(P( A \text{ and } B ) = 10/800 = 0.0125\)</span></li>
<li>First, <span class="math inline">\(P( &lt; \$100K ) = 350/800 = 0.4375\)</span>. Secondly, <span class="math display">\[
P( A | &lt; \$100K ) = P( &lt; \$100K | A ) P(A)/ P( &lt; \$100K) = (90/200)\times(200/800)/0.4375 = 0.2571
\]</span></li>
</ol>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.11 (Probability and Combinations.)</strong></span> In 2006, the St.&nbsp;Louis Cardinals and the Detroit Tigers played for the World Series. The two teams play seven games, and the first team to win four games wins the world series.</p>
<p>The Cardinals were leading the series 3 – 1. Given that each game is independent of another and that the probability of the Cardinals winning any single game is 0.55, what’s the probability that they would go on to win the World Series?</p>
<p>In 2012, the St.&nbsp;Louis Cardinals found themselves in a similar situation against the San Francisco Giants in the National League Championships. Now suppose that the probability of the Cardinals winning any single game is 0.45.</p>
<p>How does the probability that they get to the World Series differ from before?</p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.12 (Probability and Lotteries)</strong></span> The Powerball lottery is open to participants across several states. When entering the powerball lottery, a participant selects five numbers from 1-59 and then selects a powerball number from the digits 1-35. In addition, there’s a $1 million payoff for anybody selecting the first five numbers correctly.</p>
<ol type="a">
<li>Show that the odds of winning the Powerball Jackpot are 1 in 175,223,510.</li>
<li>Show that the odds of winning the $1 million are 1 in 5,153,632.</li>
</ol>
<p>On February 18, 2006 the Jackpot reached $365 million. Assuming that you will either win the Jackpot or the $1 million prize, what’s your expected value of winning?</p>
<p>Mega Millions is a similar lottery where you pick 5 balls out of 56 and a powerball from 46. Show that the odds of winning mega millions are higher than the Powerball lottery On March 30, 2012 the Jackpot reached $656 million. Is your expected value higher or lower than that calculated for the Powerball lottery?</p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.13 (Joint Probability)</strong></span> A market research survey finds that in a particular week <span class="math inline">\(28\%\)</span> of all adults watch a financial news television program; <span class="math inline">\(17\%\)</span> read a financial publication and <span class="math inline">\(13\%\)</span> do both.</p>
<ol type="a">
<li>Fill in the blanks in the following joint probability table</li>
</ol>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Watches TV</th>
<th style="text-align: left;">Doesn’t Watch</th>
<th style="text-align: left;">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Reads</td>
<td style="text-align: left;">.13</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">.17</td>
</tr>
<tr class="even">
<td style="text-align: left;">Doesn’t Read</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">.28</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">1.00</td>
</tr>
</tbody>
</table>
<ol start="2" type="a">
<li>What is the probability that someone who watches a financial TV program read a publication oriented towards finance?</li>
<li>What is the probability that someone who reads a finance publication watches a financial TV program.</li>
<li>Why aren’t the answers to the above questions equal?</li>
</ol>
<p><strong>Solution</strong>:</p>
<ol type="a">
<li>All probabilities come from the given probabilities and the fact that the sum of the column/row probabilities must add to 1.</li>
</ol>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Watches TV</th>
<th style="text-align: left;">Doesn’t Watch</th>
<th style="text-align: left;">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Reads</td>
<td style="text-align: left;">.13</td>
<td style="text-align: left;">0.4</td>
<td style="text-align: left;">.17</td>
</tr>
<tr class="even">
<td style="text-align: left;">Doesn’t Read</td>
<td style="text-align: left;">.15</td>
<td style="text-align: left;">.68</td>
<td style="text-align: left;">.83</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">.28</td>
<td style="text-align: left;">.72</td>
<td style="text-align: left;">1.00</td>
</tr>
</tbody>
</table>
<ol start="2" type="a">
<li><p><span class="math display">\[P(reads\mid TV)=P(reads \text{ and } TV)/P(TV)=.13/.28=.4643\]</span></p></li>
<li><p><span class="math display">\[P(TV\mid reads) = P(reads \text{ and } TV)/P(reads)=.13/.17=.7647\]</span></p></li>
<li><p>The reason for the difference is the denominators of the equations are different. This is an example of a base rate issue, it is more likely that someone who reads watches TV because fewer people read. This is not a condition of independence.</p></li>
</ol>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.14 (Conditional Probability.)</strong></span> A local bank is reviewing its credit card policy. In the past 5% of card holders have defaulted. The bank further found that the chance of missing one or more monthly payments is 0.20 for customers who do not default. Of course, the probability of missing one or more payments for those who default is 1.</p>
<ol type="a">
<li>Given that a customer has missed a monthly payment, compute the probability that the customer will default.</li>
<li>The bank would like to recall its card if the probability that a customer will default is greater than 0.20. Should the bank recall its card if the customer misses a monthly payment? Why or why not?</li>
</ol>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.15 (Correlation)</strong></span> The following table shows the descriptive statistics from <span class="math inline">\(1000\)</span> days of returns on IBM and Exxon’s stock prices.</p>
<pre><code>            N   Mean    StDev    SE Mean
IBM      1000   0.0009   0.0157  0.00049 
Exxon    1000   0.0018   0.0224  0.00071</code></pre>
<p>Here is the covariance table</p>
<pre><code>          IBM     Exxon
IBM     0.000247
Exxon   0.000068  0.00050</code></pre>
<ol type="a">
<li>What is the variance of IBM returns?</li>
<li>What is the correlation between IBM and Exxon’s returns?</li>
<li>Consider a portfolio that invests <span class="math inline">\(50\)</span>% in IBM and <span class="math inline">\(50\)</span>% in Exxon. What are the mean and variance of the portfolio? Do you prefer this portfolio to just investing in IBM on its own?</li>
</ol>
<p><strong>Solution</strong>:</p>
<ol type="a">
<li><span class="math display">\[\sigma^2_{IBM}=0.000247\]</span></li>
<li><span class="math display">\[\rho=\frac{Cov(IBM,Exxon)}{\sigma_{IBM}\sigma_{Exxon}}=\frac{0.000068}{\sqrt{0.000247}\sqrt{0.00050}}=0.1935\]</span></li>
<li><span class="math display">\[\mu_p=w_{I}\mu_{I}+w_{E}\mu_{E}=(0.5)(0.0009)+(0.5)(0.0018)=0.00135\]</span> <span class="math display">\[\sigma^2_p=w_{I}^2\sigma_{I}^2+w_E^2\sigma_{E}^2+2w_Iw_E Cov(I,E)\]</span> <span class="math display">\[=(0.5)^2(0.000247)+(0.5)^2(0.00050)+2(0.5)(0.5)(0.000068=0.000221\]</span> Yes, because the portfolio has a higher mean return but with a lower variance.</li>
</ol>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.16 (Normal Distribution)</strong></span> After Facebook’s earnings announcement we have the following distribution of returns. First, the stock beats earnings expectations <span class="math inline">\(75\)</span>% of the time, and the other <span class="math inline">\(25\)</span>% of the time earnings are in line or disappoint. Second, when the stock beats earnings, the probability distribution of percent changes is normal with a mean of <span class="math inline">\(10\)</span>% with a standard deviation of <span class="math inline">\(5\)</span>% and, when the stock misses earnings, a normal with a mean of <span class="math inline">\(-5\)</span>% and a standard deviation of <span class="math inline">\(8\)</span>%, respectively.</p>
<ol type="a">
<li>Ahead of the earnings announcement, what is the probability that Facebook stock will have a return greater than <span class="math inline">\(5\)</span>%?</li>
<li>Do you get the same answer for the probability that it drops at least <span class="math inline">\(5\)</span>%?</li>
<li>Use simulation to provide empirical answers with sample of size N = 10, 000, check and see how close you get to the theoretical answers you’ve found to the questions posed above. Provide histograms of the distributions you simulate.</li>
</ol>
<p><strong>Solution</strong>:</p>
<p>We have the following information: <span class="math display">\[
P(\textrm{Beat Earnings}) = 0.75 ~ \mathrm{ and} ~ P(\textrm{Not Beat Earnings}) = 0.25
\]</span> together with the following probabilities distributions <span class="math display">\[
R_{Beat}\sim N(0.10,0.05^2) ~ \mathrm{ and} ~ R_{Not}\sim N(-0.05,0.08^2)
\]</span> We want to find the probability that Facebook stock will have a return greater than 5%: <span class="math display">\[
\begin{aligned}
P(\textrm{Beat}) &amp; \times P(R_{Beat}&gt;0.05) + P(\textrm{Not}) \times P(R_{Not}&gt;0.05)\\
&amp;=0.75 \times (1-F_{Beat}(0.05)) + 0.25 \times (1-F_{Not}(0.05))
\end{aligned}
\]</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fl">0.75</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">pnorm</span>(<span class="fl">0.05</span>,<span class="fl">0.1</span>,<span class="fl">0.05</span>)) <span class="sc">+</span> <span class="fl">0.25</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">pnorm</span>(<span class="fl">0.05</span>,<span class="sc">-</span><span class="fl">0.05</span>,<span class="fl">0.08</span>)) <span class="co">#0.657</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.66</code></pre>
</div>
</div>
<p>Therefore, the probability that Facebook stock beats a 5% return is 65.7%.</p>
<p>Similarly, for dropping at least 5%, we want: <span class="math display">\[
\begin{aligned}
P(\textrm{Beat})\times P(R_{Beat}&lt;-0.05) + P(\textrm{Not}) \times P(R_{Not}&lt;-0.05)\\
=0.75 \times (F_{Beat}(-0.05)) + 0.25 \times (F_{Not}(-0.05))
\end{aligned}
\]</span> We can compute this is in R by the following commands:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fl">0.75</span><span class="sc">*</span><span class="fu">pnorm</span>(<span class="sc">-</span><span class="fl">0.05</span>,<span class="fl">0.1</span>,<span class="fl">0.05</span>) <span class="sc">+</span> <span class="fl">0.25</span><span class="sc">*</span><span class="fu">pnorm</span>(<span class="sc">-</span><span class="fl">0.05</span>,<span class="sc">-</span><span class="fl">0.05</span>,<span class="fl">0.08</span>) <span class="co">#0.1260124</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.13</code></pre>
</div>
</div>
<p>Therefore, the probability that Facebook stock drops at least 5% is 12.6%.<br>
</p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.17 (Probability)</strong></span> Answer the following statements TRUE or FALSE, providing a succinct explanation of your reasoning.</p>
<ol type="a">
<li>If the odds in favor of <span class="math inline">\(A\)</span> are 3:5 then <span class="math inline">\(\mbox{P}(A) = 0.4\)</span>.</li>
<li>You roll two fair three-sided dice. The probability the two dice show the same number is 1/4.</li>
<li>If events <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are independent and <span class="math inline">\(\mbox{P}(A) &gt; 0\)</span> and <span class="math inline">\(\mbox{P}(B)&gt;0\)</span>, then <span class="math inline">\(\mbox{P}(A \mbox{ and } B) &gt; 0\)</span>.</li>
<li>If <span class="math inline">\(\mbox{P}(A \; \text{ and} \;  B) \geq 0.5\)</span> then <span class="math inline">\(P(A) \leq 0.5\)</span>.</li>
<li>If two random variables have non-zero correlation, then they must be dependent.</li>
<li>If two random variables have zero correlation, then they must be independent.</li>
<li>If two random variables are independent, then the correlation between them must be zero.</li>
<li>If <span class="math inline">\(P(A \text{ and } B) \leq 0.2\)</span>, then <span class="math inline">\(P(A) \leq 0.2\)</span>.</li>
</ol>
<p><strong>Solution</strong>:</p>
<ol type="a">
<li>If the odds in favor of <span class="math inline">\(A\)</span> are 3:5 then <span class="math inline">\(\mbox{P}(A) = 0.4\)</span>. FALSE <span class="math inline">\(P(A) = \frac{3}{3+5} = 0.375\)</span></li>
<li>You roll two fair three-sided dice. The probability the two dice show the same number is 1/4. FALSE <span class="math inline">\(P = \frac{1}{3}\times\frac{1}{3}\times 3 = \frac{1}{3}\)</span>.</li>
<li>If events <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are independent and <span class="math inline">\(\mbox{P}(A) &gt; 0\)</span> and <span class="math inline">\(\mbox{P}(B)&gt;0\)</span>, then <span class="math inline">\(\mbox{P}(A \mbox{ and } B) &gt; 0\)</span>. TRUE <span class="math inline">\(\mbox{P}(A \mbox{ and } B) = \mbox{P}(A) \times \mbox{P}(B)&gt;0\)</span>.</li>
<li>If <span class="math inline">\(\mbox{P}(A \; \text{ and} \;  B) \geq 0.5\)</span> then <span class="math inline">\(P(A) \leq 0.5\)</span>. FALSE Suppose A B are independent and <span class="math inline">\(P(A) = 1\)</span>, <span class="math inline">\(P(B) = 0.5\)</span>. <span class="math inline">\(\mbox{P}(A \; \text{ and} \;  B) \geq 0.5\)</span></li>
<li>If two random variables have non-zero correlation, then they must be dependent. TRUE If two random variables are independent, they always have 0 correlation. Therefore if correlation is not 0, they cannot be independent.</li>
<li>If two random variables have zero correlation, then they must be independent. FALSE Suppose <span class="math inline">\(X\)</span> takes value in <span class="math inline">\(\{-1, 0, 1\}\)</span> with probability <span class="math inline">\(\frac{1}{3}\)</span> for each. <span class="math inline">\(Y = X^2\)</span>, we have</li>
</ol>
<p><span class="math display">\[
X = \begin{cases}
-1 &amp; \text{with prob } 1/3\\
0  &amp; \text{with prob } 1/3\\
1 &amp; \text{with prob } 1/3
\end{cases},
Y = \begin{cases}
1 &amp; \text{with prob } 2/3\\
0  &amp; \text{with prob } 1/3\
\end{cases}
\]</span></p>
<p>It’s easy to find that <span class="math inline">\(\text{Cov}(X, Y) = 0\)</span>. But <span class="math inline">\(Y\)</span> is a function of <span class="math inline">\(X\)</span>, so they are not independent.</p>
<ol type="a">
<li>If two random variables are independent, then the correlation between them must be zero. TRUE Independence implies uncorrelation, thus correlation is 0.</li>
<li>False, We only know <span class="math inline">\(P(A \text{ and } B) \leq P(A)\)</span></li>
</ol>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.18 (Binomial Distribution)</strong></span> The Downhill Manufacturing company produces snowboards. The average life of their product is <span class="math inline">\(10\)</span> years. A snowboard is considered defective if its life is less than <span class="math inline">\(5\)</span> years. The distribution is approximately normal with a standard deviation for the life of a board of <span class="math inline">\(3\)</span> years.</p>
<ol type="a">
<li>What’s the probability of a snowboard being defective?</li>
<li>In a shipment of <span class="math inline">\(120\)</span> snowboards, what is the probability that the number of defective boards is greater than <span class="math inline">\(10\)</span>?</li>
<li>Use simulation to provide empirical answers with sample of size N = 10, 000, check and see how close you get to the theoretical answers you’ve found to the questions posed above. Provide histograms of the distributions you simulate.</li>
</ol>
<p>You can use R and simulation with <code>rbinom</code>, <code>rnorm</code> as an alternative</p>
<p><strong>Solution</strong>:</p>
<p>Here we are given the following information: <span class="math inline">\(L\sim N(10,3^2)\)</span>. We want to find the probability of a snowboard being defective: <span class="math display">\[
P(L&lt;5)=F_L(5).
\]</span> This is simply the cumulative distribution function. We can find the solution by using the following R commands:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="dv">5</span>,<span class="at">mean=</span><span class="dv">10</span>,<span class="at">sd=</span><span class="dv">3</span>) <span class="co">#0.04779035</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.048</code></pre>
</div>
</div>
<p>Thus, the probability a snowboard is considered defective is 4.78%. Out of a shipment of 120 snowboards, the distribution of the number of defective boards is a Binomial Distribution parameterized as follows: <span class="math display">\[
N_{def}\sim Bin(120,0.0478).
\]</span> We want to find the probability: <span class="math display">\[
P(N_{def}&gt;10)
\]</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="dv">10</span>,<span class="dv">120</span>,<span class="fl">0.0478</span>,<span class="at">lower.tail =</span> <span class="cn">FALSE</span>) <span class="co">#0.02914742</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.029</code></pre>
</div>
</div>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.19 (Chinese Stock Market)</strong></span> On August 24th, 2015, Chinese equities ended down <span class="math inline">\(- 8.5\)</span>% (Black Monday). In the last <span class="math inline">\(25\)</span> years, average is <span class="math inline">\(0.09\)</span>% with a volatility of <span class="math inline">\(2.6\)</span>%, and <span class="math inline">\(56\)</span>% time close within one standard deviation. SP500, average is <span class="math inline">\(0.03\)</span>% with a volatility of <span class="math inline">\(1.1\)</span>%. <span class="math inline">\(74\)</span>% time close within one standard deviation</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="fig/stock-monday.png" class="img-fluid figure-img" style="width:30.0%"></p>
<figcaption>Economist article, August 2015.</figcaption>
</figure>
</div>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.20 (Body Weight)</strong></span> Suppose that your model for weight <span class="math inline">\(X\)</span>: Normal distribution with mean <span class="math inline">\(190\)</span> lbs and variance <span class="math inline">\(100\)</span> lbs. The problem is to identify the proportion of people have weights over 200 lbs?</p>
<p><strong>Solution</strong>:</p>
<p>We are given that <span class="math inline">\(\mu = 190\)</span> and <span class="math inline">\(\sigma^2 = 100\)</span> so <span class="math inline">\(\sigma = 10\)</span>. Our probability model is <span class="math inline">\(X \sim N ( 190 , 100 )\)</span>.</p>
<p><span class="math inline">\(X\)</span>, to get <span class="math display">\[Z = \frac{ X - \mu}{ \sigma } = \frac{ X - 190 }{ 10}\]</span></p>
<p>Now we compute the desired probability <span class="math display">\[
\begin{aligned}
p(X&gt;200) &amp; = P \left ( \frac{ X - 190 }{ 10 } &gt; \frac{ 200 - 190 }{10 } \right ) \\
&amp; = P \left ( Z &gt; 1 \right ).
\end{aligned}
\]</span> Now use the cdf function (<span class="math inline">\(F_Z\)</span>) to get <span class="math display">\[P ( Z &gt; 1 ) = 1 - F_Z ( 1 ) = 1 - 0.8413 = 0.1587\]</span></p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.21 (Google Returns)</strong></span> We estimated sample mean and sample variance for daily returns of Google stock <span class="math inline">\(\bar x = 0.025\)</span>, and <span class="math inline">\(s^2 = 1.1\)</span>. If I want to calculate the probability that I lose <span class="math inline">\(3\)</span>% in a day, I need to assume a probabilistic model of the return and then calculate the <span class="math inline">\(p(r &gt;3)\)</span>. Say, we assume that returns are normally distributed <span class="math inline">\(r \sim N( \mu , \sigma^2 )\)</span>. Estimate parameters of the distribution from the observed data and calculate <span class="math inline">\(p(r&lt;-3) = 0.003\)</span></p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.22 (Portfolio Means, Standard Deviations and Correlation)</strong></span> Suppose you have a portfolio that is invested with a weight of 75% in the U.S. and 25% in HK. You take a sample of 10 years, or 120 months of historical means, standard deviations and correlations for U.S. and Hong Kong stock market returns. Given this information compute the mean and standard deviation of the returns on your portfolio.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th style="text-align: left;">N</th>
<th>MEAN S</th>
<th style="text-align: left;">TDEV</th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Hong Kong</td>
<td style="text-align: left;">120</td>
<td>0.0170</td>
<td style="text-align: left;">0.0751</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>US</td>
<td style="text-align: left;">120</td>
<td>0.0115</td>
<td style="text-align: left;">0.0330</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>Correlation = 0.3</p>
<p>Hint: you will find the following formulas useful. Let <span class="math inline">\(R_p\)</span> denote the return on your portfolio which is a weighted combination <span class="math inline">\(R_p = pX + (1 - p)Y\)</span> . Then <span class="math display">\[
E(R_p) = p\mu_X + (1 - p)\mu_Y
\]</span> <span class="math display">\[
Var(R_p) = p^2\sigma_X^2 + (1 - p)^2\sigma_Y^2 + 2p(1-p)\rho \sigma_X \sigma_Y
\]</span> where <span class="math inline">\(\mu_X\)</span>, <span class="math inline">\(\mu_Y\)</span> and <span class="math inline">\(\sigma_X\)</span>, <span class="math inline">\(\sigma_Y\)</span> are the underlying means and standard deviations for <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>.</p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.23 (Binomial)</strong></span> In the game Chuck-a-Luck you pick a number from 1 to 6. You roll three dice. If your number doesn’t appear on any dice, you lose $1. If your number appears exactly once, you win $1. If your number appears on exactly two dice, you win $2. If your number appears on all three dice, you win $3.</p>
<p>Hence every outcome has how much you win or lose on the game, namely <span class="math inline">\(-1, 1, 2\)</span> or <span class="math inline">\(3\)</span>.</p>
<ol type="a">
<li>Fill in the blanks in the pdf and cdf values</li>
</ol>
<table class="caption-top table">
<tbody>
<tr class="odd">
<td style="text-align: left;">X</td>
<td style="text-align: left;">-1</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">P(X)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">F(X)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<p>Explain your reasoning carefully.</p>
<ol start="2" type="a">
<li>Compute the expected value of the game, <span class="math inline">\(E(X)\)</span>.</li>
</ol>
<p><strong>Solution</strong>:</p>
<ol type="a">
<li>PDF: This is a binomial experiment with n=3 and p=1/6. Plugging in for <span class="math inline">\(x=0\)</span>: <span class="math display">\[P(x=0)=(5/6)^3=.5787\]</span> <span class="math display">\[P(x=1)=3 (1/6)^1 \times (5/6)^2=.3472\]</span> <span class="math display">\[P(x=2)=3 (1/6)^2 \times (5/6)^1=.0694\]</span> <span class="math display">\[P(x=3)=(1/6)^3=.0046\]</span></li>
<li>CDF: The values for this are the probabilities that X is less than or equal to a given value: <span class="math display">\[F(x=0)=P(x \leq 0)=.5787\]</span> <span class="math display">\[F(x=1)=P(x \leq 1)=P(x=0)+P(x=1)=.9259\]</span> <span class="math display">\[F(x=2)=.9954\]</span> <span class="math display">\[F(x=3)=1\]</span></li>
</ol>
<p>The expected value is <span class="math display">\[
\sum_x x P_X ( x) = -1 \times 0.5787+1 \times 0.3472+2 \times 0.0694+3 \times 0.0046=-\$.08.
\]</span> You expect to lose 8 cents per game.</p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.24 (Binomial Distribution)</strong></span> A real estate firm in Florida offers a free trip to Florida for potential customers. Experience has shown that of the people who accept the free trip, 5% decide to buy a property. If the firm brings <span class="math inline">\(1000\)</span> people, what is the probability that at least <span class="math inline">\(125\)</span> will decide to buy a property?</p>
<p><strong>Solution</strong>:</p>
<p>In order to find the probability that <em>at least</em> <span class="math inline">\(125\)</span> decide to buy, the binomial distribution would require calculating the probabilities for 125-1000. Instead, we use the normal approximation for the binomial. <span class="math display">\[
\mu = np =50.
\]</span> <span class="math display">\[
\sigma = \sqrt{np(1-p)}=\sqrt{1000\times .05\times .95}=\sqrt{47.5}=6.89
\]</span></p>
<p>Calculating the Z-score for 125: <span class="math inline">\(Z=\frac{125-50}{6.89}=10.9.\)</span> and <span class="math inline">\(P(Z \geq 10.9)=0\)</span>.</p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.25 (Expectation and Strategy)</strong></span> An oil company wants to drill in a new location. A preliminary geological study suggests that there is a <span class="math inline">\(20\)</span>% chance of finding a small amount of oil, a <span class="math inline">\(50\)</span>% chance of a moderate amount and a <span class="math inline">\(30\)</span>% chance of a large amount of oil. The company has a choice of either a standard drill that simply burrows deep into the earth or a more sophisticated drill that is capable of horizontal drilling and can therefore extract more but is far more expensive. The following table provides the payoff table in millions of dollars under different states of the world and drilling conditions</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Oil</th>
<th style="text-align: center;">small</th>
<th style="text-align: center;">moderate</th>
<th style="text-align: center;">large</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Standard Drilling</td>
<td style="text-align: center;">20</td>
<td style="text-align: center;">30</td>
<td style="text-align: center;">40</td>
</tr>
<tr class="even">
<td style="text-align: center;">Horizontal Drilling</td>
<td style="text-align: center;">-20</td>
<td style="text-align: center;">40</td>
<td style="text-align: center;">80</td>
</tr>
</tbody>
</table>
<p>Find the following</p>
<ol type="a">
<li>The mean and variance of the payoffs for the two different strategies</li>
<li>The strategy that maximizes their expected payoff</li>
<li>Briefly discuss how the variance of the payoffs would affect your decision if you were risk averse</li>
<li>How much are you willing to pay for a geological evaluation that would tell you with certainty the quantity of oil at the site prior to drilling?</li>
</ol>
<p><strong>Solution</strong>:</p>
<ol type="a">
<li>Using the plug-in rule, we get <span class="math display">\[
\begin{aligned}
E(Standard) &amp; = &amp; 31\\
E(Horizontal) &amp; = &amp; 40\\
Var(Standard) &amp; = &amp; E(X^{2})-\left[E(X)\right]^{2}\\
&amp; = &amp; 1010-961\\
&amp; = &amp; 49\\
Var(Horizontal) &amp; = &amp; E(X^{2})-\left[E(X)\right]^{2}\\
&amp; = &amp; 2800-1600\\
&amp; = &amp; 1200
\end{aligned}
\]</span></li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>S <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>P <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.2</span>,<span class="fl">0.5</span>,<span class="fl">0.3</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>E_standard <span class="ot">=</span> <span class="fu">sum</span>(S<span class="sc">*</span>P)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>H <span class="ot">=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>,<span class="dv">40</span>,<span class="dv">80</span>)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>E_horizontal <span class="ot">=</span> <span class="fu">sum</span>(H<span class="sc">*</span>P)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>E_standard</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 31</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>E_horizontal</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 40</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(S<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>P) <span class="sc">-</span> E_standard<span class="sc">^</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 49</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(H<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>P) <span class="sc">-</span> E_horizontal<span class="sc">^</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 1200</code></pre>
</div>
</div>
<ol start="2" type="a">
<li>Given our analysis, horizontal drilling maximizes the expected payoff.</li>
<li>The strategy with higher expected payoff has a substantially higher variance. A risk averse person will settle for a strategy with lower expected payoff and lower variance, i.e.&nbsp;standard drilling, while a risk seeking person will choose horizontal drilling.</li>
<li>If the geological evaluation tells us with certainty the type of oil, then we will be able to chose the strategy which maximizes our payoff under different types of oil. Thus, the amount one should be willing to pay is the expected payoff under this revised schedule of payoff minus the maximum payoff under the current schedule. Given this <span class="math display">\[
WTP=0.2\times20+0.5\times40+0.3\times80-40=48-40=8
\]</span></li>
</ol>
<p>Therefore, once should be willing to pay <span class="math inline">\(\$8\)</span> million for this information.</p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.26 (Google Survey)</strong></span> Visitors to your website are asked to answer a single survey <a href="http://www.google.com">Google website</a> question before they get access to the content on the page. Among all of the users, there are two categories</p>
<ol type="a">
<li>Random Clicker (RC)</li>
<li>Truthful Clicker (TC)</li>
</ol>
<p>There are two possible answers to the survey: yes and no.</p>
<p>Random clickers would click either one with equal probability. You are also giving the information that the expected fraction of random clickers is <span class="math inline">\(0.3\)</span>.</p>
<p>After a trial period, you get the following survey results. <span class="math inline">\(65\)</span>% said Yes and <span class="math inline">\(35\)</span>% said No.</p>
<p>How many people people who are truthful clickers answered yes?</p>
<p><strong>Solution</strong>:</p>
<p>Given the information that the expected fraction of random clickers is 0.3, <span class="math display">\[P(RC) = 0.3 \mbox{ and } P(TC) = 0.7\]</span> Conditioning on a random clickers, he would click either one with equal probability. <span class="math display">\[
P(Yes \mid RC) = P(No \mid RC) = 0.5
\]</span> By the survey results, we know the proportion response of “Yes" and”No". <span class="math display">\[
P(Yes) = 0.65 \mbox{ and } P(No) = 0.35
\]</span> Therefore, the probability that a truthful clicker answer “Yes" is, <span class="math display">\[
\begin{aligned}         
P(Yes \mid TC) &amp;=&amp; \frac{P(Yes)-P(Yes \mid RC)*P(RC)}{P(TC)} \\         
&amp;=&amp; \frac{0.65 - 0.5*0.3}{0.7} = 0.71     
\end{aligned}
\]</span> Notice that, we use law of total probability in the first equation.</p>
</div>
<section id="computing" class="level3">
<h3 class="anchored" data-anchor-id="computing">Computing</h3>
<div id="exr-port" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.27 (Portfolio Means, Standard Deviations and Correlation)</strong></span> You want to build a portfolio of exchange traded funds (ETFs) for your retirement strategy. You’re thinking of whether to invest in growth or value stocks, or maybe a combination of both. Vanguard has two ETFs, one for growth (VUG) and one for value (VTV).</p>
<ol type="a">
<li>Plot the historical price series for VUG vs VTV.</li>
<li>Calculate the means and standard deviations of both ETFs.</li>
<li>Calculate their covariance.</li>
<li>Suppose you decide on a portfolio that is a 50 / 50 split. Calculate the new mean and variance of your portfolio.</li>
<li>Which portfolio best suits you?</li>
<li>What’s the probability that growth (VUG) will beat value (VTV) in the future?</li>
</ol>
<p>You will find the following formulas useful. Let <span class="math inline">\(P\)</span> denote the return on your portfolio which is a weighted combination <span class="math inline">\(P = aX + bY\)</span>. Then <span class="math display">\[
E(P) = aE(X) + bE(Y )
\]</span> <span class="math display">\[
Var(P ) = a^2Var(X) + b^2Var(Y ) + 2abCov(X, Y ),
\]</span> where <span class="math inline">\(Cov(X, Y )\)</span> is the covariance for <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>.</p>
<p><em>Hint:</em> You can use the following code to get the data</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quantmod)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">getSymbols</span>(<span class="fu">c</span>(<span class="st">"VUG"</span>,<span class="st">"VTV"</span>), <span class="at">from =</span> <span class="st">"2015-01-01"</span>, <span class="at">to =</span> <span class="st">"2024-01-01"</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>VUG <span class="ot">=</span> VUG<span class="sc">$</span>VUG.Adjusted</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>VTV <span class="ot">=</span> VTV<span class="sc">$</span>VTV.Adjusted</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Solution</strong>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quantmod)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">getSymbols</span>(<span class="fu">c</span>(<span class="st">"VUG"</span>,<span class="st">"VTV"</span>), <span class="at">from =</span> <span class="st">"2015-01-01"</span>, <span class="at">to =</span> <span class="st">"2024-01-01"</span>);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] "VUG" "VTV"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>VUG <span class="ot">=</span> VUG<span class="sc">$</span>VUG.Adjusted</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>VTV <span class="ot">=</span> VTV<span class="sc">$</span>VTV.Adjusted</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(VUG, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">main =</span> <span class="st">"VUG"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ex_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(VTV, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">main =</span> <span class="st">"VTV"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ex_files/figure-html/unnamed-chunk-17-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>VUG <span class="ot">=</span> <span class="fu">as.numeric</span>(VUG)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>VTV <span class="ot">=</span> <span class="fu">as.numeric</span>(VTV)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="fu">length</span>(VUG)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>VUG <span class="ot">=</span> VUG[<span class="dv">2</span><span class="sc">:</span>n]<span class="sc">/</span>VUG[<span class="dv">1</span><span class="sc">:</span>(n<span class="dv">-1</span>)]<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>VTV <span class="ot">=</span> VTV[<span class="dv">2</span><span class="sc">:</span>n]<span class="sc">/</span>VTV[<span class="dv">1</span><span class="sc">:</span>(n<span class="dv">-1</span>)]<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(VUG)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.00061</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(VTV)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.00042</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(VUG)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.013</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(VTV)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.011</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(VUG, VTV)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.00012</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># portfolio mean and variance</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>portfolio_mean_1 <span class="ot">=</span> <span class="fl">0.5</span> <span class="sc">*</span> <span class="fu">mean</span>(VUG) <span class="sc">+</span> <span class="fl">0.5</span> <span class="sc">*</span> <span class="fu">mean</span>(VTV)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>portfolio_var_1 <span class="ot">=</span> <span class="fl">0.5</span><span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">var</span>(VUG) <span class="sc">+</span> <span class="fl">0.5</span><span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">var</span>(VTV) <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fl">0.5</span> <span class="sc">*</span> <span class="fl">0.5</span> <span class="sc">*</span> <span class="fu">cov</span>(VUG, VTV)</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>portfolio_sd_1 <span class="ot">=</span> <span class="fu">sqrt</span>(portfolio_var_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You may say VUG or VTV best suits you, as long as you give an explanation such as you are risk aversion or not. Now we consider mean and variance of VUG - VTV,</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>mean_1 <span class="ot">=</span> <span class="fu">mean</span>(VUG) <span class="sc">-</span> <span class="fu">mean</span>(VTV)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>var_1 <span class="ot">=</span> <span class="fu">var</span>(VUG) <span class="sc">+</span> <span class="fu">var</span>(VTV) <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> (<span class="sc">-</span><span class="dv">1</span>) <span class="sc">*</span> <span class="fu">cov</span>(VUG, VTV)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>sd_1 <span class="ot">=</span> <span class="fu">sqrt</span>(var_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Therefore the probability that VUG - VTV <span class="math inline">\(&lt;0\)</span> is</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="dv">0</span>, mean_1, <span class="at">sd =</span> sd_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.49</code></pre>
</div>
</div>
<p>However, we care about the probability that VUG beats VTV, that is $P(VUG &gt; VTV) = P(VUG - VTV &gt; 0)</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="dv">0</span>, mean_1, <span class="at">sd =</span> sd_1, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.51</code></pre>
</div>
</div>
</div>
<div id="exr-descriptive" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.28 (Descriptive Statistics in R)</strong></span> Use the <code>superbowl1.txt</code> and <code>derby2016.csv</code> datasets. The Superbowl contains data on the outcome of all previous Superbowls. The outcome is defined as the difference in scores of the favorite minus the underdog. The spread is the bookmakers’ prediction of the outcome before the game begins. The Derby data consists of all of the results on the Kentucky Derby which is run on the first Saturday in May every year at Churchill Downs racetrack. Answer the following questions</p>
<p>For the Superbowl data.</p>
<ol type="a">
<li>Plot the spread and outcome variables. Calculate means, standard deviations, covariances, correlations.</li>
<li>What is the mean and the standard deviation of the winning margin (outcome)?</li>
<li>Use a <code>boxplot</code> to compare the favorites’ score versus the underdog.</li>
<li>Does this data look normally distributed?</li>
</ol>
<p>For the Derby data.</p>
<ol type="a">
<li>Plot a histogram of the winning speeds and times of the horses. Why is there a long right-hand tail to the distribution of times?</li>
<li>Can you identify the outlying horse with the best winning time?</li>
</ol>
<p><strong>Solution</strong>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import superbowl data</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>superbowl<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"../data/superbowl1.txt"</span>,<span class="at">header=</span>T)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="co"># look at data</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(superbowl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Favorite</th>
<th style="text-align: left;">Underdog</th>
<th style="text-align: right;">Spread</th>
<th style="text-align: right;">Outcome</th>
<th style="text-align: right;">Upset</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">GreenBay</td>
<td style="text-align: left;">KansasCity</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">GreenBay</td>
<td style="text-align: left;">Oakland</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Baltimore</td>
<td style="text-align: left;">NYJets</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">-9</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Minnesota</td>
<td style="text-align: left;">KansasCity</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">-16</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Dallas</td>
<td style="text-align: left;">Baltimore</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-3</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Dallas</td>
<td style="text-align: left;">Miami</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(superbowl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##    Favorite           Underdog             Spread         Outcome      
##  Length:48          Length:48          Min.   : 1.00   Min.   :-35.00  
##  Class :character   Class :character   1st Qu.: 3.00   1st Qu.: -3.00  
##  Mode  :character   Mode  :character   Median : 6.25   Median :  7.00  
##                                        Mean   : 7.15   Mean   :  6.24  
##                                        3rd Qu.:10.12   3rd Qu.: 17.00  
##                                        Max.   :19.00   Max.   : 45.00  
##      Upset      
##  Min.   :0.000  
##  1st Qu.:0.000  
##  Median :0.000  
##  Mean   :0.333  
##  3rd Qu.:1.000  
##  Max.   :1.000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># attach so R recognizes  each variable</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(superbowl)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="do">######################</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="co"># part 1</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a><span class="do">######################</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a><span class="co"># plot Spread vs Outcome</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Spread,Outcome,<span class="at">main=</span><span class="st">"Spread v.s. Outcome"</span>)</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a><span class="co"># add a 45 degree line to compare</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">1</span>,<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ex_files/figure-html/superbowl-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Covariance, Correlation, alpha, beta</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> Spread</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> Outcome</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 7.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 6.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 4.6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 17</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(x,y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 24</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(x,y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="fu">cor</span>(x,y)<span class="sc">*</span><span class="fu">sd</span>(y)<span class="sc">/</span><span class="fu">sd</span>(x)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fu">mean</span>(y)<span class="sc">-</span>beta<span class="sc">*</span><span class="fu">mean</span>(x)</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>beta</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 1.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>alpha</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] -1.8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Regression check</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x)</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## (Intercept)           x 
##        -1.8         1.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="do">####################</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="co"># part 2</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="do">####################</span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare boxplot </span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(Spread,Outcome,<span class="at">horizontal=</span>T,<span class="at">names=</span><span class="fu">c</span>(<span class="st">"spread"</span>,<span class="st">"outcome"</span>),</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">col=</span><span class="fu">c</span>(<span class="st">"red"</span>,<span class="st">"yellow"</span>),<span class="at">main=</span><span class="st">"Superbowl"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ex_files/figure-html/superbowl-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="do">#####################</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="co"># part 3</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="do">#####################</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="co"># see the distribution of outcome and spread through histograms</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(Outcome,<span class="at">freq=</span><span class="cn">FALSE</span>)</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a><span class="co"># add a normal distribution line to compare</span></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="dv">50</span>,<span class="dv">50</span>,<span class="fl">0.01</span>),<span class="fu">dnorm</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="dv">50</span>,<span class="dv">50</span>,<span class="fl">0.01</span>),<span class="fu">mean</span>(Outcome),<span class="fu">sd</span>(Outcome)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ex_files/figure-html/superbowl-3.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(Spread,<span class="at">freq=</span><span class="cn">FALSE</span>)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">30</span>,<span class="fl">0.01</span>),<span class="fu">dnorm</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">30</span>,<span class="fl">0.01</span>),<span class="fu">mean</span>(Spread),<span class="fu">sd</span>(Spread)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ex_files/figure-html/superbowl-4.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="do">######################</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Kentucky Derby</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="do">######################</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>mydata2 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"../data/Kentucky_Derby_2014.csv"</span>,<span class="at">header=</span>T)</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a><span class="co"># attach the dataset </span></span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(mydata2)</span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mydata2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 6%">
<col style="width: 11%">
<col style="width: 16%">
<col style="width: 15%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 12%">
<col style="width: 11%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">year</th>
<th style="text-align: right;">year_num</th>
<th style="text-align: left;">date</th>
<th style="text-align: left;">winner</th>
<th style="text-align: right;">mins</th>
<th style="text-align: right;">secs</th>
<th style="text-align: right;">timeinsec</th>
<th style="text-align: right;">distance</th>
<th style="text-align: right;">speedmph</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1875</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">May 17, 1875</td>
<td style="text-align: left;">Aristides</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">158</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">34</td>
</tr>
<tr class="even">
<td style="text-align: right;">1876</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">May 15, 1876</td>
<td style="text-align: left;">Vagrant</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">158</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">34</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1877</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">May 22, 1877</td>
<td style="text-align: left;">Baden-Baden</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">158</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">34</td>
</tr>
<tr class="even">
<td style="text-align: right;">1878</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">May 21, 1878</td>
<td style="text-align: left;">Day Star</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">37</td>
<td style="text-align: right;">157</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">34</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1879</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">May 20, 1879</td>
<td style="text-align: left;">Lord Murphy</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">37</td>
<td style="text-align: right;">157</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">34</td>
</tr>
<tr class="even">
<td style="text-align: right;">1880</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">May 18, 1880</td>
<td style="text-align: left;">Fonso</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">158</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">34</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mydata2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##       year         year_num         date              winner         
##  Min.   :1875   Min.   :  1.0   Length:140         Length:140        
##  1st Qu.:1910   1st Qu.: 35.8   Class :character   Class :character  
##  Median :1944   Median : 70.5   Mode  :character   Mode  :character  
##  Mean   :1944   Mean   : 70.5                                        
##  3rd Qu.:1979   3rd Qu.:105.2                                        
##  Max.   :2014   Max.   :140.0                                        
##       mins           secs         timeinsec      distance       speedmph   
##  Min.   :1.00   Min.   : 0.00   Min.   :119   Min.   :1.25   Min.   :31.3  
##  1st Qu.:2.00   1st Qu.: 2.20   1st Qu.:122   1st Qu.:1.25   1st Qu.:35.0  
##  Median :2.00   Median : 4.13   Median :124   Median :1.25   Median :36.3  
##  Mean   :1.99   Mean   :10.42   Mean   :130   Mean   :1.29   Mean   :35.9  
##  3rd Qu.:2.00   3rd Qu.: 9.00   3rd Qu.:129   3rd Qu.:1.25   3rd Qu.:36.8  
##  Max.   :2.00   Max.   :59.97   Max.   :172   Max.   :1.50   Max.   :37.7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="do">##################</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="co"># part 1</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="do">##################</span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot a histogram of speedmph</span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(speedmph,<span class="at">col=</span><span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ex_files/figure-html/superbowl-5.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># finer bins </span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(speedmph,<span class="at">breaks=</span><span class="dv">10</span>,<span class="at">col=</span><span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ex_files/figure-html/superbowl-6.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(timeinsec,<span class="at">breaks=</span><span class="dv">10</span>,<span class="at">col=</span><span class="st">"purple"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ex_files/figure-html/superbowl-7.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="do">####################</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="co"># part 2</span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a><span class="do">###################</span></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a><span class="co"># to find the left tail observation</span></span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>k1 <span class="ot">&lt;-</span> <span class="fu">which</span>(speedmph <span class="sc">==</span> <span class="fu">min</span>(speedmph))</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>mydata2[k1,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 3%">
<col style="width: 6%">
<col style="width: 11%">
<col style="width: 17%">
<col style="width: 10%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 13%">
<col style="width: 11%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">year</th>
<th style="text-align: right;">year_num</th>
<th style="text-align: left;">date</th>
<th style="text-align: left;">winner</th>
<th style="text-align: right;">mins</th>
<th style="text-align: right;">secs</th>
<th style="text-align: right;">timeinsec</th>
<th style="text-align: right;">distance</th>
<th style="text-align: right;">speedmph</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">17</td>
<td style="text-align: right;">1891</td>
<td style="text-align: right;">17</td>
<td style="text-align: left;">May 13, 1891</td>
<td style="text-align: left;">Kingman</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">52</td>
<td style="text-align: right;">172</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">31</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># to find the best horse</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>k2 <span class="ot">&lt;-</span> <span class="fu">which</span>(speedmph <span class="sc">==</span> <span class="fu">max</span>(speedmph))</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>mydata2[k2,] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 3%">
<col style="width: 6%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 15%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 13%">
<col style="width: 11%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">year</th>
<th style="text-align: right;">year_num</th>
<th style="text-align: left;">date</th>
<th style="text-align: left;">winner</th>
<th style="text-align: right;">mins</th>
<th style="text-align: right;">secs</th>
<th style="text-align: right;">timeinsec</th>
<th style="text-align: right;">distance</th>
<th style="text-align: right;">speedmph</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">99</td>
<td style="text-align: right;">1973</td>
<td style="text-align: right;">99</td>
<td style="text-align: left;">5-May-73</td>
<td style="text-align: left;">Secretariat</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">59</td>
<td style="text-align: right;">119</td>
<td style="text-align: right;">1.2</td>
<td style="text-align: right;">38</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div id="exr-brk" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.29 (Berkshire Hathaway: Yahoo Finance Data)</strong></span> Download daily return data in Warren Buffett’s firm Berkshire Hathaway (ticker symbol: <code>BRK-A</code>) from 1990 to the present. Analyze this data in the following way:</p>
<ol type="a">
<li>Plot the Historical Price Performance of the stock.</li>
<li>Calculate the Daily returns. Plot a histogram of the returns. Comment on the distribution that you obtain.</li>
<li>Use the summary command to provide statistical data summaries.</li>
<li>Interpret your findings.</li>
</ol>
<p><strong>Solution</strong>:</p>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quantmod)</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="fu">getSymbols</span>(<span class="st">"BRK-A"</span>, <span class="at">from =</span> <span class="st">"1990-01-01"</span>, <span class="at">to =</span> <span class="st">"2024-01-01"</span>)</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>BRKA <span class="ot">=</span> <span class="fu">get</span>(<span class="st">'BRK-A'</span>)</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>BRKA <span class="ot">=</span> BRKA[,<span class="dv">4</span>]</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(BRKA)</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(BRKA,<span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">20</span>,<span class="at">main=</span><span class="st">"BRKA Share Price"</span>,<span class="at">ylab=</span><span class="st">"Price"</span>,<span class="at">xlab=</span><span class="st">"Time"</span>,<span class="at">bty=</span><span class="st">'n'</span>)</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the simple return</span></span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">length</span>(BRKA) </span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">as.vector</span>(BRKA)</span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a>ret <span class="ot">&lt;-</span> y[<span class="sc">-</span><span class="dv">1</span>]<span class="sc">/</span>y[<span class="sc">-</span>N]<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a><span class="co"># create summaries of ret for BRK-A</span></span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ret)</span>
<span id="cb94-14"><a href="#cb94-14" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(ret)</span>
<span id="cb94-15"><a href="#cb94-15" aria-hidden="true" tabindex="-1"></a><span class="co"># histogram of returns</span></span>
<span id="cb94-16"><a href="#cb94-16" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(ret,<span class="at">breaks=</span><span class="dv">50</span>,<span class="at">main=</span><span class="st">"BRK-A daily returns"</span>)</span>
<span id="cb94-17"><a href="#cb94-17" aria-hidden="true" tabindex="-1"></a><span class="co"># plots to show serial correlation in 1st and 2nd moments</span></span>
<span id="cb94-18"><a href="#cb94-18" aria-hidden="true" tabindex="-1"></a><span class="co"># to save the plot,click "Export" ans "save as image"</span></span>
<span id="cb94-19"><a href="#cb94-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-20"><a href="#cb94-20" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(ret,<span class="at">lag.max=</span><span class="dv">10</span>,<span class="at">main=</span><span class="st">"serial correlation in 1st moment"</span>)</span>
<span id="cb94-21"><a href="#cb94-21" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(ret<span class="sc">^</span><span class="dv">2</span>,<span class="at">lag.max=</span><span class="dv">10</span>,<span class="at">main=</span><span class="st">"serial correlation in 2nd moment"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel" data-layout-align="center" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<pre><code>## [1] "BRK-A"</code></pre>
</div>
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<pre><code>##            BRK-A.Close
## 1990-01-02        8625
## 1990-01-03        8625
## 1990-01-04        8675
## 1990-01-05        8625
## 1990-01-08        8625
## 1990-01-09        8555</code></pre>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ex_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<pre><code>##      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
## -0.120879 -0.005857  0.000000  0.000583  0.006473  0.161290</code></pre>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<pre><code>## [1] 0.014</code></pre>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ex_files/figure-html/unnamed-chunk-21-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ex_files/figure-html/unnamed-chunk-21-3.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ex_files/figure-html/unnamed-chunk-21-4.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.30 (Confidence Intervals)</strong></span> A sample of weights of 40 rainbow trout revealed that the sample mean is 402.7 grams and the sample standard deviation is 8.8 grams.</p>
<ol type="a">
<li>What is the estimated mean weight of the population?</li>
<li>What is the 99% confidence interval for the mean?</li>
</ol>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.31 (Confidence Intervals)</strong></span> A research firm conducted a survey to determine the mean amount steady smokers spend on cigarettes during a week.</p>
<p>A sample of 49 steady smokers revealed that <span class="math inline">\(\bar{X} = 20\)</span> and <span class="math inline">\(s = 5\)</span> dollars.</p>
<ol type="a">
<li>What is the point estimate? Explain what it indicates.</li>
<li>Using a 95% confidence interval, determine the confidence interval for <span class="math inline">\(\mu\)</span>. Explain what it indicates.</li>
</ol>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.32 (Back cast US Presidential Elections)</strong></span> Use data from presidential polls to predict the winner of the elections. We will be using data from <a href="http://www.electoral-vote.com/" class="uri">http://www.electoral-vote.com/</a>. The goal is to use simulations to predict the winning percentage for each of the candidates. Use <code>election.Rmd</code> script as the starter.</p>
<p>Report prediction as a 50% confidence interval for each of the candidates.</p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.33 (Russian Parliament Election Fraud (5 pts))</strong></span> On September 28, 2016 United Russia party won a super majority of seats, which will allow them to change the Constitution without any votes of other parties. Throughout the day there were reports of voting fraud including video purporting to show officials stuffing ballot boxes. Additionally, results in many regions demonstrate that United Russia on many poll stations got anomalously closed results, for example, 62.2% in more than hundred poll stations in Saratov Region.</p>
<p>Using assumption that United Russia’s range in Saratov was [57.5%, 67.5%] and results for each poll station are rounded to one decimal point (when measure in percent), calculate probability that in 100 poll stations out of 1800 in Saratov Region the majority party got exactly 62.2%.</p>
<p>Do you think it can happen by a chance?</p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.34 (A/B Testing)</strong></span> Use dataset from <code>ab_browser_test.csv</code>. Here is the definition of the columns:</p>
<ul>
<li><code>userID</code>: unique user ID</li>
<li><code>browser</code>: browser which was used by userID</li>
<li><code>slot</code>: status of the user (exp = saw modified page, control = saw unmodified page)</li>
<li><code>n_clicks</code>: number of total clicks user did during as a result of <code>n_queries</code></li>
<li><code>n_queries</code>: number of queries made by <code>userID</code>, who used browser <code>browser</code></li>
<li><code>n_nonclk_queries</code>: number of queries that did not result in any clicks</li>
</ul>
<p>Note, that not everyone uses a single browser, so there might be multiple rows with the same <code>userID</code>. In this data set combination of <code>userID</code> and <code>browser</code> is the unique row identifier.</p>
<ol type="a">
<li>Count how many users in each group. How much larger (in percent) exp group when compared to control group</li>
<li>Using bootstrap, construct 95% confidence interval for mean and median of number of clicks in group exp and group control. Are the mean and median significantly different?</li>
<li>Using bootstrap, check if mean of each group has a normal distribution. Generate <span class="math inline">\(B = 1000\)</span> bootstrap samples, calculate mean of each and plot <code>qqplot</code>.</li>
<li>Use z-ratio for the means, to perform sis testing, with <span class="math inline">\(H_0\)</span>: there is no difference in average number of clicks between 2 groups</li>
<li>Mann-Whitney (<a href="http://www.statmethods.net/stats/nonparametric.html" class="uri">http://www.statmethods.net/stats/nonparametric.html</a>) is another test for comparing means, that does not require normality assumption. Use this test to check hypothesis that means are equal.</li>
<li>For each browser type and each of the 2 groups (control and exp) count the percent of queries that did not result in any clicks. You can do it be dividing sum of <code>n_nonclk_queries</code> by sum of <code>n_queries</code>. Comment your on your results.</li>
</ol>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.35 (Chicago Crime Data Analysis)</strong></span> On January 24, 2017 Donald Tramp tweeted about "horrible" murder rate in Chicago.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="fig/trump_chi_tweet.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption>Trump Tweets</figcaption>
</figure>
</div>
<p>Our goal is to analyze the data and check how statistically significant such a statement. I downloaded Chicago’s crime data from the data portal: <a href="data.cityofchicago.org">data.cityofchicago.org</a>. This data contains reported incidents of crime (with the exception of murders where data exists for each victim) that occurred in the City of Chicago from 2001 to present, minus the most recent seven days. Data is extracted from the Chicago Police Department’s CLEAR (Citizen Law Enforcement Analysis and Reporting) system. In order to protect the privacy of crime victims, addresses are shown at the block level only and specific locations are not identified. This data set has 6.3 million records. Each crime incident is categorized using one of the 35 primary crime types: NARCOTICS, THEFT, CRIMINAL TRESPASS, etc.. I frittered incidents of type HOMICIDE into a separate data set stored in <code>chi_homicide.rds</code>. Use <code>chi_crime.R</code> as a staring script for this problem.</p>
<ol type="a">
<li>Create a heat map for the homicide incidents. In which areas of the city you think houses are very affordable and in which they are not?</li>
<li>Create a map by plotting a dot for each of the homicide incidents. You will see similar picture as you saw with the heat plot. Look at the Hyde Park area in the south side Chicago. There is an "island" with no homicide incidents! Can you explain why? Hint: You might want open Google maps in your browser and zoom-in into this area.<br>
</li>
<li>Though president’s tweet is consistent with the data (<a href="goo.gl/VTPzFw">goo.gl/VTPzFw</a>), observing 52 homicides in January is not that unusual. Calculate the total number of homicides for each January. Use bootstrap to estimate 95% confidence interval for the mean <span class="math inline">\(\mu\)</span> over January homicides. Is <span class="math inline">\(52\)</span> within the interval? Calculate confidence interval using <span class="math inline">\(t\)</span>-ratio. Do you think results from <span class="math inline">\(t\)</span>-ratio based calculations are reliable?<br>
</li>
<li>The history of 2001-present data is rather short. Chicago tribune provided total number of homicides for Chicago for each month of the 1957-2014 period. Use this data set and calculate the confidence interval for <span class="math inline">\(\mu\)</span> using bootstrap and <span class="math inline">\(t\)</span>-ratio. Further answer the following questions: (i) Assuming monthly homicide rate follows Normal distribution, what is the probability that we observe 52 homicides or more? (ii) Do you think Normality assumption is valid? (iii) Assuming monthly homicide rate follows Poisson distribution, what is the probability that we observe 52 homicides or more?<br>
</li>
<li>There is a hypothesis that crime rates are related to temperatures (<a href="goo.gl/nPpHwv">goo.gl/nPpHwv</a>). Check this hypothesis using simple regression. Use linear model to regress homicide rate to the average maximum temperature. Does this relation appear significant? Perform residual diagnostics and find outliers and leverage points.<br>
</li>
<li>There is another hypothesis that rise in murder is related to the pullback in proactive policing that started in November of 2015 as a result of Laquan McDonald video release (<a href="https://goo.gl/7cm1CC" class="uri">https://goo.gl/7cm1CC</a>, <a href="https://goo.gl/WcH2uB" class="uri">https://goo.gl/WcH2uB</a>). I calculated total number of homicides for each day and split data into two parts: before and after video release. Using <span class="math inline">\(t\)</span>-ratio, check the hypothesis <span class="math inline">\(H_0\)</span>: the homicide rate did not change after video release.</li>
</ol>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.36 (Gibbs Sampler)</strong></span> Suppose we model data using the following model <span class="math display">\[
\begin{aligned}
y_i \sim &amp;N(\mu,\tau^{-1})\\
\mu \sim &amp; N(0,1)\\
\tau \sim &amp; Gamma(2,1).
\end{aligned}
\]</span></p>
<p>The goal is to implement a Gibbs sample for the posterior <span class="math inline">\(\mu,\tau | y\)</span>, where <span class="math inline">\(y = (y_1,\ldots,y_n)\)</span> is the observed data. Gibbs sampler algorithms iterates between two steps</p>
<ol type="a">
<li>Sample <span class="math inline">\(\mu_i\)</span> from <span class="math inline">\(\mu \mid \tau_{i-1}, y\)</span></li>
<li>Sample <span class="math inline">\(\tau_i\)</span> from <span class="math inline">\(\tau_i \mid \mu_i, y\)</span></li>
</ol>
<p>Show that those full conditional distributions are given by <span class="math display">\[
\begin{aligned}
\mu \mid \tau, y \sim &amp; N\left(\dfrac{\tau n\bar y}{1+n\tau},\dfrac{1}{1+n\tau}\right)\\
\tau \mid \mu,y \sim &amp; \mathrm{Gamma}\left(2+\dfrac{n}{2}, 1+\dfrac{1}{2}\sum_{i=1}^{n}(y_i-\mu)^2\right)
\end{aligned}
\]</span></p>
<p>Use formulas for full conditional distributions and implement the Gibbs sampler. The data <span class="math inline">\(y\)</span> is in the file <code>MCMCexampleData.txt</code>.</p>
<p>Plot samples from the joint distribution over <span class="math inline">\((\mu,\tau)\)</span> on a scatter plot. Plot histograms for marginal <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\tau\)</span> (marginal distributions).</p>
<p><strong>Solution</strong>: First we write the joint distribution of <span class="math inline">\((y,\tau,\mu)\)</span> as <span class="math display">\[\begin{align*}
p(y,\tau,\mu) &amp;= p(y|\tau,\mu) p(\mu) p(\tau)\\
&amp;=\left(\prod_{i=1}^{n} \frac{\sqrt{\tau}}{\sqrt{2\pi}} e^{-\frac{\tau}{2}(y_i-\mu)^2} \right) \frac{1}{\sqrt{2\pi}} e^{-\frac{1}{2}\mu^2} \frac{1}{\Gamma(2)} \tau e^{-\tau}
\end{align*}\]</span> Therefore, <span class="math display">\[\begin{align*}
p(\mu|\tau,y) &amp;= \frac{p(y,\tau,\mu)}{p(\tau,y)}\\
&amp;\propto \left(\prod_{i=1}^{n} e^{-\frac{\tau}{2}(y_i-\mu)^2} \right) e^{-\frac{1}{2}\mu^2}\\
&amp;\propto  e^{-\frac{\tau n+1}{2}\mu^2 + \tau n\bar{y}\mu}\\
&amp;\sim N\left(\frac{\tau n \bar{y}}{1+\tau n}, \frac{1}{1+\tau n}\right)\\
p(\tau|\mu, y) &amp;= \frac{p(y,\tau,\mu)}{p(\mu,y)}\\
&amp;\propto \left(\prod_{i=1}^{n} \sqrt{\tau}e^{-\frac{\tau}{2}(y_i-\mu)^2} \right) \tau e^{-\tau}\\
&amp;= \tau^{1+n/2} e^{-(1+\sum_{i=1}^{n}(y_i-\mu)^2/2)\tau}\\
&amp;\sim \mathrm{Gamma}\left(2+\frac{n}{2}, 1+\frac{1}{2}\sum_{i=1}^{n}(y_i-\mu)^2\right)
\end{align*}\]</span> <!-- TODO: Add code --></p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.37 (AAPL vs GOOG)</strong></span> Download AAPL and GOOG return data from 2018 to 2024. Plot box-plot and histogram. Calculate summary statistics using <code>summary</code> function. Describe clearly what you learn from the summary and the plots.</p>
<p><strong>Solution</strong>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quantmod)</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="fu">getSymbols</span>(<span class="fu">c</span>(<span class="st">"AAPL"</span>,<span class="st">"GOOG"</span>), <span class="at">from =</span> <span class="st">"2018-01-01"</span>, <span class="at">to =</span> <span class="st">"2024-01-01"</span>)</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>AAPL <span class="ot">=</span> <span class="fu">dailyReturn</span>(AAPL<span class="sc">$</span>AAPL.Adjusted)</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>GOOG <span class="ot">=</span> <span class="fu">dailyReturn</span>(GOOG<span class="sc">$</span>GOOG.Adjusted)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(AAPL, <span class="at">col=</span><span class="st">"red"</span>); <span class="fu">boxplot</span>(GOOG, <span class="at">col=</span><span class="st">"green"</span>)</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(AAPL, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">breaks=</span><span class="dv">50</span>); <span class="fu">hist</span>(GOOG, <span class="at">col=</span><span class="st">"green"</span>, <span class="at">breaks=</span><span class="dv">50</span>)</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(AAPL); <span class="fu">summary</span>(GOOG)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel" data-layout-align="center" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ex_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ex_files/figure-html/unnamed-chunk-23-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ex_files/figure-html/unnamed-chunk-23-3.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ex_files/figure-html/unnamed-chunk-23-4.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<pre><code>##      Index            daily.returns     
##  Min.   :2018-01-02   Min.   :-0.12865  
##  1st Qu.:2019-07-03   1st Qu.:-0.00824  
##  Median :2020-12-30   Median : 0.00118  
##  Mean   :2020-12-30   Mean   : 0.00123  
##  3rd Qu.:2022-06-30   3rd Qu.: 0.01188  
##  Max.   :2023-12-29   Max.   : 0.11981</code></pre>
</div>
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<pre><code>##      Index            daily.returns      
##  Min.   :2018-01-02   Min.   :-0.111008  
##  1st Qu.:2019-07-03   1st Qu.:-0.008736  
##  Median :2020-12-30   Median : 0.001068  
##  Mean   :2020-12-30   Mean   : 0.000839  
##  3rd Qu.:2022-06-30   3rd Qu.: 0.010999  
##  Max.   :2023-12-29   Max.   : 0.104485</code></pre>
</div>
</div>
</div>
<p>From the box plots, we can see many extreme observations out of 1.5 IQR (inter-quarter-range) of the lower and upper quartiles, which are confirmed by the high kurtosis values. We can also see their heavy tails in the histograms. GOOG is positive skew (mean much higher than median) and AAPL is not “significantly” skew (mean close to median).</p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.38 (Berkshire Realty)</strong></span> Berkshire Realty is interested in determining how long a property stays on the housing market. For a sample of <span class="math inline">\(800\)</span> homes they find the following probability table for length of stay on the market before being sold as a function of the asking price</p>
<table class="caption-top table">
<tbody>
<tr class="odd">
<td style="text-align: left;">Days until Sold</td>
<td style="text-align: center;">Under 20</td>
<td style="text-align: center;">20-40</td>
<td style="text-align: center;">over 40</td>
</tr>
<tr class="even">
<td style="text-align: left;">Under $250K</td>
<td style="text-align: center;">50</td>
<td style="text-align: center;">40</td>
<td style="text-align: center;">10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">$250-500K</td>
<td style="text-align: center;">20</td>
<td style="text-align: center;">150</td>
<td style="text-align: center;">80</td>
</tr>
<tr class="even">
<td style="text-align: left;">$500-1M</td>
<td style="text-align: center;">20</td>
<td style="text-align: center;">280</td>
<td style="text-align: center;">100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Over $1 M</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">30</td>
<td style="text-align: center;">10</td>
</tr>
</tbody>
</table>
<ol type="a">
<li>What is the probability of a randomly selected house that is listed over <span class="math inline">\(40\)</span> days before being sold?</li>
<li>What is the probability that a randomly selected initial asking price is under <span class="math inline">\(250\)</span>K?</li>
<li>What is the joint probability of both of the above event happening?</li>
<li>Assuming that a contract has just been signed to list a home for under $500K, what is the probability that Berkshire realty will sell the home in under <span class="math inline">\(40\)</span> days?</li>
</ol>
<p><strong>Solution</strong>:</p>
<ol type="a">
<li><span class="math inline">\(P(\mbox{over 40}) = \frac{10+80+100+10}{800} = 25\%\)</span></li>
<li><span class="math inline">\(P(\mbox{under 250K}) = \frac{50+40+10}{800} = 12.5\%\)</span></li>
<li><span class="math inline">\(P(\mbox{over 40 and under 250K}) = \frac{10}{800} = 1.25\%\)</span></li>
<li><span class="math inline">\(P(\mbox{under 40 and under 500K}) = \frac{50+40+20+150}{50+40+20+150+10+80} = 74.29\%\)</span></li>
</ol>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.39 (TrueF/False)</strong></span> &nbsp;</p>
<ol type="a">
<li><p>If <span class="math inline">\(\mathbb{P} \left ( A \; \mathrm{ and} \; B \right ) \leq 0.2\)</span> then <span class="math inline">\(\mathbb{P} (A) \leq 0.2\)</span>.</p></li>
<li><p>If <span class="math inline">\(P( A | B ) = 0.5\)</span> and <span class="math inline">\(P(B ) = 0.5\)</span>, then the events <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are necessarily independent.</p></li>
<li><p>A box has three drawers; one contains two gold coins, one contains two silver coins, and one contains one gold and one silver coin. Assume that one drawer is selected randomly and that a randomly selected coin from that drawer turns out to be gold. Then the probability that the chosen drawer contains two gold coins is <span class="math inline">\(50\)</span>%.</p></li>
<li><p>Suppose that <span class="math inline">\(P(A) = 0.4 , P(B)=0.5\)</span> and <span class="math inline">\(P( A  \text{ or }B ) = 0.7\)</span> then<span class="math inline">\(P( A  \text{ and }B ) = 0.3\)</span>.</p></li>
<li><p>If <span class="math inline">\(P( A  \text{ or }B ) = 0.5\)</span> and <span class="math inline">\(P(A  \text{ and }B ) = 0.5\)</span>, then <span class="math inline">\(P(A) = P( B)\)</span>.</p></li>
<li><p>The following data on age and martial status of <span class="math inline">\(140\)</span> customers of a Bondi beach night club were taken</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">Age</th>
<th style="text-align: left;">Single</th>
<th style="text-align: left;">Not Single</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Under 30</td>
<td style="text-align: left;">77</td>
<td style="text-align: left;">14</td>
</tr>
<tr class="even">
<td style="text-align: left;">Over 30</td>
<td style="text-align: left;">28</td>
<td style="text-align: left;">21</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<p>Given this data, age and martial status are independent.</p></li>
<li><p>If <span class="math inline">\(P( A  \text{ and }B ) = 0.5\)</span> and <span class="math inline">\(P(A) = 0.1\)</span>, then <span class="math inline">\(P(B|A) = 0.1\)</span>.</p></li>
<li><p>In a group of students, <span class="math inline">\(45\)</span>% play golf, <span class="math inline">\(55\)</span>% play tennis and <span class="math inline">\(70\)</span>% play at least one of these sports. Then the probability that a student plays golf but not tennis is <span class="math inline">\(15\)</span>%.</p></li>
<li><p>The following probability table related age with martial status</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">Age</th>
<th style="text-align: left;">Single</th>
<th style="text-align: left;">Not Single</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Under 30</td>
<td style="text-align: left;">0.55</td>
<td style="text-align: left;">0.10</td>
</tr>
<tr class="even">
<td style="text-align: left;">Over 30</td>
<td style="text-align: left;">0.20</td>
<td style="text-align: left;">0.15</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<p>Given these probabilities, age and martial status are independent.</p></li>
<li><p>Thirty six different kinds of ice cream can be found at Ben and Jerry’s.There are <span class="math inline">\(58,905\)</span> different combinations of four choices of ice cream.</p></li>
<li><p>Suppose that for a certain Caribbean island the probability of a hurricane is <span class="math inline">\(0.25\)</span>, the probability of a tornado is <span class="math inline">\(0.44\)</span> and the probability of both occurring is <span class="math inline">\(0.22\)</span>. Then the probability of a hurricane or a tornado occurring is <span class="math inline">\(0.05\)</span>.</p></li>
<li><p>If <span class="math inline">\(P ( A  \text{ and }B ) \geq 0.10\)</span> then <span class="math inline">\(P(A) \geq 0.10\)</span>.</p></li>
<li><p>If <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are mutually exclusive events, then <span class="math inline">\(P(A|B) = 0\)</span>.</p></li>
<li><p>True. By definition, if <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are mutually exclusive events then <span class="math inline">\(P( A  \text{ and }B)=0\)</span> and so <span class="math inline">\(P(A|B) = P(A  \text{ and }B)/P(B) = 0\)</span></p></li>
</ol>
<p><strong>Solution</strong>:</p>
<ol type="a">
<li><p>False. We only know <span class="math inline">\(\mathbb{P} \left ( A \; \mathrm{ and} \; B \right ) \leq \mathbb{P}(A)\)</span>.</p></li>
<li><p>False. This is not necessarily true. We need more information about each event to definitively say so.</p></li>
<li><p>False. Knowing that we have a gold coin, there is 2/3 chance of being in the 2 gold coin drawer and a 1/3 chance of being in the 1 gold coin drawer. Therefore, the probability that the chosen drawer contains twofold coins is 2.</p></li>
<li><p>False. <span class="math inline">\(P(A \text{ and }B)=P(A)+P(B)-P(A \text{ or }B)=0.2\)</span></p></li>
<li><p>True. We know that <span class="math inline">\(P( A  \text{ or }B ) = P(A) +P(B) - P(A  \text{ and }B )\)</span> and so<span class="math inline">\(P(A) + P(B) =1\)</span>. Also <span class="math inline">\(P( A) \geq P( A  \text{ and }B ) = 0.5\)</span> and so<span class="math inline">\(P(A)=P(B) = 0.5\)</span></p></li>
<li><p>False. We can compute conditional probabilities as<span class="math inline">\(P ( S | U_{30} ) = 0.8462 , P ( M | U_{30} ) = 0.1638\)</span> and<span class="math inline">\(P ( S | O_{30} ) = 0.5714 , P ( M | O_{30} ) = 0.4286\)</span>. The events aren’t independent as the conditional probabilities are not the .</p></li>
<li><p>False. <span class="math inline">\(P(B|A) = P( A  \text{ and }B ) / P( A)\)</span> would be greater than one</p></li>
<li><p>True. <span class="math inline">\(P(G)=0.45, P(T)=0.55, P(G  \text{ or }T) = 0.70\)</span> implies <span class="math inline">\(P(G  \text{ and }\bar{T}) = 0.15\)</span></p></li>
<li><p>False. <span class="math inline">\(P ( X &gt; 30  \text{ and }Y = \mathrm{ married} ) = 0.15 \neq -.35 \times 0.25
=  P ( X &gt; 30 )P( Y = \mathrm{ married} )\)</span></p></li>
<li><p>True. Combinations are given by <span class="math inline">\(36!/(36-6)!6! =58,905\)</span></p></li>
<li><p>If two events <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are independent then both <span class="math inline">\(P(A|B) =P(A)\)</span> and<span class="math inline">\(P(B|A)=P(A)\)</span>.</p></li>
<li><p>False. <span class="math inline">\(P(B|A)=P(A)\)</span>. Note that the statement is true if (and only if)<span class="math inline">\(P(A)=P(B)\)</span></p></li>
<li><p>False. <span class="math inline">\(P(H \text{ or }T)=P(H)+P(T)-P(H \text{ and }T)=0.25+0.44-0.22=0.47\)</span></p></li>
<li><p>True. <span class="math inline">\(A  \text{ and }B\)</span> is a subset of <span class="math inline">\(A\)</span> and so<span class="math inline">\(P(A) \geq P(A  \text{ and }B) = 0.10\)</span></p></li>
</ol>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.40 (Marginal and Joint)</strong></span> Let <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> be independent with a joint distribution given by <span class="math display">\[f_{X,Y}(x,y) = \frac{1}{2 \pi} \sqrt{ \frac{1}{xy} }        \exp \left( - \frac{x}{2} - \frac{y}{2} \right)     \text{ where }  x, y &gt; 0 .\]</span> Identify the following distributions</p>
<ol type="a">
<li>The marginal distribution of <span class="math inline">\(X\)</span></li>
<li>Compute the joint distribution of <span class="math inline">\(U = X\)</span> and <span class="math inline">\(V = X+Y\)</span></li>
<li>Compute the marginal distribution of <span class="math inline">\(V\)</span>.</li>
</ol>
<p><strong>Solution</strong>:</p>
<ol type="a">
<li><span class="math display">\[\begin{aligned}         \frac{1}{2\pi} \int_0^\infty \frac{1}{\sqrt{x y}} e^{\frac{1}{2}-(x+y)} dx &amp;=         \frac{1}{\sqrt{2 \pi}} \frac{1}{\sqrt{y}} e^{\frac{-y}{2}}         \end{aligned}\]</span></li>
<li>We perform the substitutions <span class="math inline">\(y \to v-x\)</span> and <span class="math inline">\(x \to u\)</span> and obtain the parameter vector <span class="math inline">\(\begin{pmatrix}u \\ v-u\end{pmatrix}\)</span>, which has the following Jacobian: <span class="math display">\[\begin{aligned}         \left|\begin{pmatrix}         1 &amp; 0 \\         -1 &amp; 1          \end{pmatrix}\right| = 1         \end{aligned}\]</span> Thus, the transformed distribution is <span class="math display">\[\begin{aligned}         f_{U,V}(u,v) &amp;= \frac{1}{2 \pi} \frac{1}{\sqrt{u(v-u)}} e^{-v/2}         \end{aligned}\]</span></li>
<li><span class="math display">\[\begin{aligned}         \frac{1}{2 \pi} \int_0^v \frac{1}{\sqrt{u(v-u)}} e^{-v/2} du &amp;=          \frac{1}{2} e^{-v/2}         \end{aligned}\]</span></li>
</ol>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.41 (Conditional)</strong></span> &nbsp;</p>
<ol type="a">
<li>Let <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> be independent standard <span class="math inline">\(N(0,1)\)</span> random variables. Then <span class="math inline">\(X^2 + Y^2\)</span> is an exponential distribution.</li>
<li>Let <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> be independent Poisson random variables with rates <span class="math inline">\(\lambda\)</span> and <span class="math inline">\(\mu\)</span>, respectively. Show that the conditional distribution of <span class="math inline">\(X | (X+Y)\)</span> is Binomial with <span class="math inline">\(n = X+Y\)</span> and <span class="math inline">\(p = \lambda / ( \lambda + \mu)\)</span>.</li>
</ol>
<p><strong>Solution</strong>:</p>
<ol type="a">
<li>True. The random variable <span class="math inline">\((X^2+Y^2)\)</span> has a <span class="math inline">\(\chi^2_2\)</span> distribution, and this is an exponential distribution with <span class="math inline">\(\lambda=1/2\)</span>.</li>
<li><span class="math display">\[P(X=l | X+Y =n) = \frac{P(X=l , X+Y=n)}{P(X+Y=n)} = \frac{P(X=l, Y= n-l)}{P(X+Y=n)}\]</span> <span class="math display">\[=\frac{P(X=l)P(Y=n-l)}{P(X+Y=n)}=\frac{(e^{-\lambda}\lambda^l/l!)(e^{-\mu}\mu^{n-l}/(n-l)!)}{e^{-\lambda-\mu}(\lambda+\mu)^n/n!}=\frac{n!}{l!(n-l)!}\frac{\lambda^l\mu^{n-l}}{(\lambda+\mu)^n}\]</span> <span class="math display">\[=p^l (1-p)^{n-l}\frac{n!}{l!(n-l)!}\]</span></li>
</ol>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.42 (Joint and marginal)</strong></span> Let <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> be independent exponential random variables with means <span class="math inline">\(\lambda\)</span> and <span class="math inline">\(\mu\)</span>, respectively.</p>
<ol type="a">
<li>Find the joint distribution of <span class="math inline">\(U = X+Y\)</span> and <span class="math inline">\(V = X / ( X+Y)\)</span>.</li>
<li>Find the marginal distributions for <span class="math inline">\(U\)</span> and <span class="math inline">\(V\)</span>.</li>
</ol>
<p><strong>Solution</strong>:</p>
<ol type="a">
<li>The joint distribution of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> is given by <span class="math display">\[f_{X,Y} ( x , y ) = \frac{1}{\lambda \mu} \exp \left ( - \frac{x}{\lambda}  - \frac{y}{\mu} \right )\]</span> The transformation <span class="math inline">\(u =x+y\)</span> and <span class="math inline">\(v= x / ( x+y)\)</span> has inverse given by <span class="math inline">\(x = uv\)</span>, <span class="math inline">\(y = u ( 1 - v)\)</span>. Hence, the Jacobian is <span class="math inline">\(u\)</span>. The joint distribution of <span class="math inline">\((U,V)\)</span> is then <span class="math display">\[f_{U,V} ( u,v) =  \frac{u}{\lambda \mu} \exp \left ( - \frac{uv}{\lambda} - \frac{u(1-v)}{\mu} \right )\]</span></li>
<li>The marginal distribution of <span class="math inline">\(U\)</span> is given by<br>
<span class="math display">\[
\begin{aligned}
f_U(u)&amp; = \int_0^1 f_{U,V} ( u,v) dv\\
&amp;= \frac{1}{\lambda - \mu} \left ( \exp \left ( - \frac{ u}{ \lambda } \right )      -  \exp \left ( - \frac{ u}{ \mu } \right ) \right )
\end{aligned}
\]</span></li>
</ol>
<p>The marginal distribution of <span class="math inline">\(V\)</span> is given by <span class="math display">\[
f_V ( v) = \int_{0}^{\infty} f_{U,V} ( u,v) du
\]</span> Hence, <span class="math display">\[
f_V(v) = \frac{ \lambda \mu }{ ( \mu v + \lambda ( 1-v) )^2 }
\]</span></p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.43 (Toll road)</strong></span> You are designing a toll road that carries trucks and cars. Each week you see an average of 19,000 vehicles pass by. The current toll for cars is 50 cents and you wish to set the toll for trucks so that the revenue reaches $11,500 per week. You observe the following data: three of every four trucks on the road are followed by a car, while only one of every five cars is followed by a truck.</p>
<ol type="a">
<li>What is the equilibrium distribution of trucks and cars on the road?</li>
<li>What should you charge trucks so as to reach your goal of $11,500 in revenues per week?</li>
</ol>
<p><strong>Solution</strong>:</p>
<p>The transition matrix for the number of trucks and cars is given by <span class="math display">\[P = \left (  \begin{array}{cc}  \frac{1}{4} &amp; \frac{3}{4} \\  \frac{1}{5} &amp; \frac{4}{5}   \end{array}    \right )\]</span> The equilibrium distribution <span class="math inline">\(\pi = ( \pi_1 , \pi_2 )\)</span> is given by <span class="math inline">\(\pi P = \pi\)</span>. This has solution given by <span class="math display">\[\frac{1}{4} \pi_1 + \frac{1}{5} \pi_2 = \pi_1 \; \; \mathrm{ and} \; \; \frac{3}{4} \pi_1 + \frac{4}{5} \pi_2 = \pi_2\]</span> with <span class="math inline">\(\pi_1 = \frac{4}{19}\)</span> and <span class="math inline">\(\pi_2 = \frac{15}{19}\)</span>.</p>
<p>With cars at a toll of 50 cents we see that we need to charge trucks $1.00 to generate revenues of $11,500 per week.</p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.44</strong></span> Let <span class="math inline">\(X, Y\)</span> have a bivariate normal density with density given by <span class="math display">\[f_{X,Y} ( x, y) = \frac{1}{ 2 \pi \sqrt{ ( 1 - \rho^2 )} } \exp \left ( - \frac{1}{2}  \left ( x^2 - 2 \rho x y + y^2 \right ) \right )\]</span> Consider the transformation <span class="math inline">\(W=X\)</span> and <span class="math inline">\(Z = \frac{ Y - \rho X}{ \sqrt{ 1 - \rho^2 } }\)</span>. Show that <span class="math inline">\(W , Z\)</span> are independent and identify their distributions.</p>
<p><strong>Solution</strong>:</p>
<p>The Jacobian of this linear transformation is given by <span class="math inline">\(J = \sqrt{ 1 - \rho^2 }\)</span>. Knowing that <span class="math inline">\(X = g(W,Z) = W\)</span>, and <span class="math inline">\(Y = h(W,Z) = \sqrt{1-\rho^2} Z + \rho W\)</span>, and Jacobian <span class="math inline">\(J\)</span>, we can apply the transformation formula: <span class="math display">\[
\begin{aligned}     
f_{W,Z} (w,z) &amp;=&amp; f_{X,Y} (g(w,z),h(w,z)) |J|\\
&amp;=&amp; f_{X,Y} (w, \sqrt{1-\rho^2} Z + \rho W)\sqrt{1-\rho^2}\\
&amp;=&amp; \frac{1}{2\pi} \exp \left ( -\frac{1}{2} \left ( w^2-2\rho w \left ( \sqrt{1-\rho^2} z + \rho w \right ) + \left ( \sqrt{1-\rho^2} z + \rho w \right )^2 \right ) \right )\\
&amp;=&amp; \frac{1}{2\pi} \exp\left ( -\frac{1-\rho^2}{2}(w^2+z^2) \right )\\
&amp;\propto&amp; \exp \left ( -\frac{(1-\rho^2)w^2}{2} \right ) \exp\left ( -\frac{(1-\rho^2)z^2}{2} \right )\\
&amp;\propto&amp; f_W(w) f_Z(z)
\end{aligned}
\]</span> Because we can write the joint distribution of <span class="math inline">\((W,Z)\)</span> as the product of two marginal distributions, <span class="math inline">\(W\)</span> and <span class="math inline">\(Z\)</span> are independent. <span class="math inline">\(W\)</span>, <span class="math inline">\(Z\)</span> both follow normal distribution with mean <span class="math inline">\(0\)</span>, and variance <span class="math inline">\((1-\rho^2)^{-1}\)</span>.</p>
</div>
</section>
</section>
<section id="bayes-rule" class="level2" data-number="27.2">
<h2 data-number="27.2" class="anchored" data-anchor-id="bayes-rule"><span class="header-section-number">27.2</span> Bayes Rule</h2>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.45 (Manchester)</strong></span> While watching a game of Champions League football in a cafe, you observe someone who is clearly supporting Manchester United in the game. What is the probability that they were actually born within 20 miles of Manchester? Assume that you have the following base rate probabilities</p>
<ol type="a">
<li>The probability that a randomly selected person in a typical local bar environment is born within 20 miles of Manchester is 1/20</li>
<li>The chance that a person born within 20 miles of Manchester actually supports United is 7/10</li>
<li>The probability that a person not born within 20 miles of Manchester supports United with probability 1/10</li>
</ol>
<p><strong>Solution</strong>:</p>
<p>Define<br>
</p>
<ul>
<li>B - event that the person is born within 20 miles of Manchester<br>
</li>
<li>U - event that the person supports United.<br>
</li>
</ul>
<p>We want <span class="math inline">\(P(B|U)\)</span>. By Bayes’ Theorem, <span class="math display">\[
P(B|U) = \frac{P(U|B)P(B)}{P(U|B)P(B) + P(U|NB)P(NB)} = 0.269
\]</span></p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.46 (Lung Cancer)</strong></span> According to the Center for Disease Control (CDC), we know that “compared to nonsmokers, men who smoke are about <span class="math inline">\(23\)</span> times more likely to develop lung cancer and women who smoke are about <span class="math inline">\(13\)</span> times more likely” You are also given the information that <span class="math inline">\(17.9\)</span>% of women in 2016 smoke.</p>
<p>If you learn that a woman has been diagnosed with lung cancer, and you know nothing else, what’s the probability she is a smoker?</p>
<p><strong>Solution</strong>:</p>
<p>If we draw the decision tree we get</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="fig/lungcancer.png" class="img-fluid figure-img" style="width:35.0%"></p>
<figcaption>Lung Cancer Tree</figcaption>
</figure>
</div>
<p>If <span class="math inline">\(y\)</span> is the fraction of women who smoke, and <span class="math inline">\(x\)</span> is the fraction of nonsmokers who get lung cancer, the number of smokers who get cancer is proportional to 13xy, and the number of nonsmokers who get lung cancer is proportional to x(1-y).</p>
<p>Of all women who get lung cancer, the fraction who smoke is <span class="math inline">\(13xy / (13xy + x(1-y))\)</span>.</p>
<p>The x’s cancel, so it turns out that we don’t actually need to know the absolute risk of lung cancer, just the relative risk. But we do need to know y, the fraction of women who smoke. According to the CDC, y was 17.9% in 2009. So we just have to compute <span class="math display">\[
13y / (13y + 1-y) \approx 74\%
\]</span> This is higher than most people guess.</p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.47 (Tesla Chip)</strong></span> Tesla purchases a particular chip called the <em>HW 5.0 auto chip</em> from three suppliers Matsushita Electric, Philips Electronics, and Hitachi. From historical experience we know that 30% of the chips are purchased from Matsushita; 20% from Philips and the remaining 50% from Hitachi. The manufacturer has extensive histories on the reliability of the chips. We know that 3% of the Matsushita chips are defective; 5% of the Philips and 4% of the Hitachi chips are defective.</p>
<p>A chip is later found to be defective; what is the probability it was manufactured by each of the manufacturers?</p>
<p><strong>Solution</strong>:</p>
<p>Let <span class="math inline">\(A_1\)</span> denotes the event that the chip is purchased from Matsushita. Similarly <span class="math inline">\(A_2\)</span> and <span class="math inline">\(A_3\)</span>. Let <span class="math inline">\(D\)</span> be the event that the chip is defective and <span class="math inline">\(\bar{D}\)</span> is not. We know <span class="math display">\[
P( D | A_1 ) = 0.03 \; \; P( D | A_2 ) = 0.05 \; \; P( D | A_3 ) = 0.04 \; \;
\]</span> and <span class="math display">\[
P( A_1 ) = 0.30 \; \; P( A_2 ) = 0.20 \; \; P( A_3 ) = 0.50
\]</span></p>
<p>The probability that it was manufactured by Philips given that its defective is given by Bayes rule which gives <span class="math display">\[
P( A_2 | D ) = \frac{ P( D | A_2  ) P( A_2 ) }{P( D | A_1  )P( A_1 ) +P( D | A_2  ) P( A_2 ) + P( D | A_3  ) P( A_3 ) }
\]</span> That is <span class="math display">\[
P( A_2 | D ) = \frac{ 0.20 \times 0.05 }{  0.30 \times 0.03 +0.20 \times 0.05 + 0.50 \times 0.04 } = \frac{10}{39}
\]</span> Similarly, <span class="math inline">\(P( A_1 | D ) = 9 / 39\)</span> and <span class="math inline">\(P( A_3 | D  ) = 20/39\)</span></p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.48 (Light Aircraft)</strong></span> Seventy percent of the light aircraft that disappear while in flight in a certain country are subsequently discovered. Of the aircraft that are discovered, 60% have an emergency locator, whereas 90% of the aircraft not discovered do not have such a locator. Suppose that a light aircraft has disappeared. If it has an emergency locator, what is the probability that it will be discovered?</p>
<p><strong>Solution</strong>:</p>
<p>Let D = {The disappearing aircraft is discovered.} and E = {The aircraft has an emergency locator}. Given: <span class="math display">\[
P(D) = 0.70 \quad P(D^c) = 1- P(D) = 0.30 \quad P(E|D) = 0.60
\]</span> <span class="math display">\[
P(E^c|D^c) = 0.90 \quad P(E|D^c) = 1 - P(E^c|D^c) = 0.10
\]</span> Then, <span class="math display">\[
\begin{aligned}
P(D|E) &amp;=&amp; \frac{P(D  \text{ and }E)}{P(E)}\\
&amp;=&amp; \frac{P(D) \times P(E|D)}{P(D) \times P(E|D) + P(D^c) \times P(E|D^c)}\\
&amp;=&amp; \frac{0.70 \times 0.60}{(0.70\times0.60) + (0.30 \times 0.10)} = 0.93
\end{aligned}
\]</span></p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.49 (Floyd Landis)</strong></span> Floyd Landis was disqualified after winning the 2006 Tour de France. This was due to a urine sample that the French national anti-doping laboratory flagged after Landis had won stage <span class="math inline">\(17\)</span> because it showed a high ratio of testosterone to epitestosterone. Because he was among the leaders he provided <span class="math inline">\(8\)</span> pairs of urine samples – so there were <span class="math inline">\(8\)</span> opportunities for a true positive and <span class="math inline">\(8\)</span> opportunities for a false positive.</p>
<ol type="a">
<li>Assume that the test has a specificity of <span class="math inline">\(95\)</span>%. What’s the probability of all <span class="math inline">\(8\)</span> samples being labeled “negative”?</li>
<li>Now assume the specificity is <span class="math inline">\(99\)</span>%. What’s the false positive rate for the test</li>
<li>Based on this data, explain how you would assess the probability of guilt of Landis in a court hearing.</li>
</ol>
<p><strong>Solution</strong>:</p>
<ol type="a">
<li>We’re given that <span class="math inline">\(0.95= \frac{ \text{number of true negatives}}{\text{number of true negatives + false positives}}.\)</span>&nbsp; &nbsp; <span class="math inline">\(P( \text{8 negatives} | \text{not guilty})= P(\text{8 true negatives})=0.95^8\)</span>.</li>
<li>False Positive rate = <span class="math inline">\(\frac {\text{False positives}}{\text{False positives + True negatives}}=\frac{1}{100}=0.01.\)</span></li>
<li><span class="math inline">\(P(8 negatives| \text{not guilty})=P(\text{8 true negatives})=0.95^8\)</span> (or <span class="math inline">\(0.99^8\)</span> if we follow the part 2).&nbsp; <span class="math inline">\(P(\text{at least 1 positive}|\text{not guilty})=1-P(\text{8 negatives}|\text{not guilty})=1-0.95^8\approx 0.34\)</span>. Hence, if the specificity is 0.95, the chance of a false positive is 0.34, which is pretty large.</li>
</ol>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.50 (BRCA1)</strong></span> Approximately <span class="math inline">\(1\)</span>% of woman aged <span class="math inline">\(40-50\)</span> have breast cancer. A woman with breast cancer has a <span class="math inline">\(90\)</span>% chance of a positive mammogram test and a <span class="math inline">\(10\)</span>% chance of a false positive result. Given that someone has a positive test, what’s the posterior probability that they have breast cancer?</p>
<p>If you have the BRCA1 gene mutation, you have a <span class="math inline">\(90\)</span>% chance of developing breast cancer. The prevalence of mutations at BRCA1 has been estimated to be 0.04%-0.20% in the general population. The genetic test for a mutation of this gene has a <span class="math inline">\(99.9\)</span>% chance of finding the mutation. The false positive rate is unknown, but you are willing to assume its still <span class="math inline">\(10\)</span>%.</p>
<p>Given that someone tests positive for the BRCA1 mutation, what’s the posterior probability that they have breast cancer?</p>
<p><strong>Solution</strong>: We know <span class="math inline">\(P(C) = 0.01\)</span> and <span class="math inline">\(P(T\mid C) = 0.9\)</span>, <span class="math inline">\(P(T\mid \bar C) = 0.1\)</span>, <span class="math display">\[
P(C\mid T) = \frac{P(T\mid C)P(C)}{P(T\mid C)P(C) + P(T\mid \bar C)P(\bar C)} = \frac{0.9 \times 0.01}{0.9 \times 0.01 + 0.1 \times 0.99} = 0.083
\]</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fl">0.9</span><span class="sc">*</span><span class="fl">0.01</span><span class="sc">/</span>(<span class="fl">0.9</span><span class="sc">*</span><span class="fl">0.01</span> <span class="sc">+</span> <span class="fl">0.1</span><span class="sc">*</span><span class="fl">0.99</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.083</code></pre>
</div>
</div>
<p>For part 2, we know <span class="math inline">\(P(C\mid B) = 0.9\)</span>, <span class="math inline">\(P(B) \in [0.04,0.2]\)</span>, <span class="math inline">\(P(BT\mid B) = 0.999\)</span>, <span class="math inline">\(P(BT\mid \bar B) = 0.1\)</span>, then</p>
<p><span class="math display">\[
P(C\mid BT) = \frac{P(BT, C)}{P(BT)}
\]</span> We will do the calculation for the low-end of the BRCA1 mutation <span class="math inline">\(P(B) = 0.0004\)</span> The total probability of a positive test is given by <span class="math display">\[
P(BT) = P(BT\mid B)P(B) + P(BT\mid \bar B)P(\bar B) =  0.999*0.0004 + 0.1*0.9996 = 0.1003596
\]</span></p>
<p>We can calculate joint over <span class="math inline">\(BT\)</span> and <span class="math inline">\(C\)</span> by marginalizing <span class="math inline">\(B\)</span> from the joint distribution of <span class="math inline">\(B\)</span> and <span class="math inline">\(C\)</span> and <span class="math inline">\(BT\)</span>. <span class="math display">\[
P(BT,C,B) = P(BT\mid B,C)P(B,C) = P(BT\mid B)P(C\mid B)P(B)
\]</span> Here we used the fact that <span class="math inline">\(BT\)</span> is conditionally independent of <span class="math inline">\(C\)</span> given <span class="math inline">\(B\)</span>. Now we can marginalize over <span class="math inline">\(B\)</span> to get <span class="math display">\[
P(BT,C) = P(BT,C,\bar B) + P(BT,C,B) = P(BT\mid \bar B)P(\bar B)P(C\mid \bar B) + P(BT\mid B)P(B)P(C\mid B) = 0.1*0.9996*P(C\mid \bar B) + 0.999*0.0004*0.9
\]</span> We can find <span class="math inline">\(P(C\mid \bar B)\)</span> from the total probability <span class="math display">\[
P(C) = P(C\mid B)P(B) + P(C\mid \bar B)P(\bar B) = 0.9*0.0004 + P(C\mid \bar B)*0.9996
\]</span> <span class="math display">\[
P(C\mid \bar B) = (0.01 - 0.9*0.0004)/0.9996 = 0.009643858
\]</span> <span class="math display">\[
P(BT,C)  = 0.1*0.9996*0.009643858 + 0.999*0.0004*0.9 = 0.00132364
\]</span></p>
<p><span class="math display">\[
P(C\mid BT) = \frac{P(BT, C)}{P(BT)} = 0.00132364/0.1003596 = 0.01318897
\]</span> A small probability of 1.32%.</p>
<p>For the high-end of the BRCA1 mutation <span class="math inline">\(P(B) = 0.002\)</span>, we get <span class="math display">\[
P(C\mid BT) = 0.02637794
\]</span> Slightly large probability of 2.64%.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>PB <span class="ot">=</span> <span class="fu">seq</span>(<span class="fl">0.0004</span>,<span class="fl">0.002</span>, <span class="at">by =</span> <span class="fl">0.0001</span>)</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>PCBT <span class="ot">=</span> <span class="fl">0.1</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>PB)<span class="sc">*</span>(<span class="fl">0.01</span> <span class="sc">-</span> <span class="fl">0.9</span><span class="sc">*</span>PB)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>PB) <span class="sc">+</span> <span class="fl">0.999</span><span class="sc">*</span>PB<span class="sc">*</span><span class="fl">0.9</span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(PB,PCBT, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">xlab =</span> <span class="st">"P(B)"</span>, <span class="at">ylab =</span> <span class="st">"P(C|BT)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ex_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.51 (Another Cancer Test)</strong></span> Bayes is particularly useful when predicting outcomes that depend strongly on prior knowledge.</p>
<p>Suppose that a woman is her forties takes a mammogram test and receives the bad news of a positive outcome. Since not every positive outcome is real, you assess the following probabilities. The base rate for a woman is her forties to have breast cancer is <span class="math inline">\(1.4\)</span>%. The probability of a positive test given breast cancer is <span class="math inline">\(75\)</span>% and the probability of a false positive is <span class="math inline">\(10\)</span>%.</p>
<p>Given the positive test, what’s the probability that she has breast cancer?</p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.52 (Bayes Rule: Hit and Run Taxi)</strong></span> A certain town has two taxi companies: Blue Birds, whose cabs are blue, and Uber, whose cabs are black. Blue Birds has 15 taxis in its fleet, and Uber has 75. Late one night, there is a hit-and-run accident involving a taxi.</p>
<p>The town’s taxis were all on the streets at the time of the accident. A witness saw the accident and claims that a blue taxi was involved. The witness undergoes a vision test under conditions similar to those on the night in question. Presented repeatedly with a blue taxi and a black taxi, in random order, they successfully identify the colour of the taxi 4 times out of 5.</p>
<p>Which company is more likely to have been involved in the accident?</p>
<p><strong>Solution</strong>:</p>
<p>We need to know <span class="math inline">\(P(Blue \mid \mbox{identified Blue})\)</span> and <span class="math inline">\(P(Black \mid \mbox{identified Blue})\)</span>.</p>
<p>First of all, write down some probability statements given in the problem. <span class="math inline">\(P(Blue) = 16.7\% \mbox{ and } P(Black) = 83.3\%\)</span> <span class="math display">\[
P(\mbox{identified Blue} \mid Blue) = 80\% \mbox{ and } P(\mbox{identified Black} \mid Blue) = 20\%
\]</span> <span class="math display">\[
P(\mbox{identified Black} \mid Black) = 80\% \mbox{ and } P(\mbox{identified Blue} \mid Black) = 20\%
\]</span> Therefore, by Bayes Rule, <span class="math display">\[
\begin{aligned}
P(Blue \mid \mbox{identified Blue}) =&amp; \frac{P(\mbox{identified Blue} \mid Blue)*P(Blue) }{P(\mbox{identified Black})} \\
=&amp; \frac{P(\mbox{identified Blue} \mid Blue)*P(Blue) }{P(\mbox{identified Blue} \mid Blue)*P(Blue) + P(\mbox{identified Black} \mid Black)*P(Black) }  \\
=&amp; 44.5\%
\end{aligned}
\]</span> <span class="math display">\[
P(Black \mid \mbox{identified Blue}) = 1- P(Blue \mid \mbox{identified Blue}) = 55.5\%
\]</span></p>
<p>Therefore, even though the witness said it was a Blue car, the probability that it was a Black car is higher.</p>
</div>
<div id="exr-gold" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.53 (Gold and Silver Coins)</strong></span> A chest has two drawers. It is known that one drawer has <span class="math inline">\(3\)</span> gold coins and no silver coins. The other drawer is known to contain <span class="math inline">\(1\)</span> gold coin and <span class="math inline">\(2\)</span> silver coins.</p>
<p>You don’t know which drawer is which. You randomly select a drawer and without looking inside you pull out a coin. It is gold. Show that the probability that the remaining two coins in the drawer are gold is <span class="math inline">\(75\)</span>%.</p>
<p><strong>Solution</strong>:</p>
<p>Suppose drawer A contains 3G and drawer B contains 1G2S. We know the probability <span class="math inline">\(P(G \mid A) = 1\)</span> and <span class="math inline">\(P(G \mid B) = 1/3\)</span>. Also, it must be either of two drawers, so P(A) = P(B) = 1/2. What we are are looking for is <span class="math inline">\(P(A \mid G)\)</span>: the probability that it is drawer A. By Bayes’ rule, <span class="math display">\[
\begin{aligned}
P(A \mid G) &amp;=&amp; \frac{P(G \mid A)\times P(A)}{P(G)} \\
&amp;=&amp; \frac{P(G \mid A)\times P(A)}{P(G \mid A)\times P(A) + P(G \mid B)\times P(B)} \mbox{ (Law of total probability)} \\
&amp;=&amp; \frac{1\times \frac{1}{2}}{1*\frac{1}{2}+\frac{1}{3}\times\frac{1}{2}} = \frac{3}{4}
\end{aligned}
\]</span> The probability that it is drawer A is 75%.</p>
</div>
<div id="exr-Monty" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.54 (The Monty Hall Problem.)</strong></span> This problem is named after the host of the long-running TV show, <em>Let’s Make a Deal</em>. A contestant is given a choice of 3 doors. There is a prize (a car, say) behind one of the doors and something worthless behind the other two doors (say two goats).</p>
<p>After the contestant chooses a door Monty opens one of the other two doors, revealing a goat. The contestant has the choice of switching doors. Is it advantageous to switch doors or not?</p>
<p><strong>Solution</strong>:</p>
<p>Suppose you plan to switch:</p>
<p>You can either pick a winner, a loser, or the other loser when you make your first choice. Each of these options has a probability of <span class="math inline">\(1/3\)</span> and are marked by a “1” below. In each case, Monty will reveal a loser (X). In the first case, he has a choice, but whichever he reveals, you will switch to the other and lose. But in the other two cases, there is only one loser for him to reveal. He must reveal this one, leaving only the winner. So, if you initially pick a loser, you will win by switching. That is, there is a <span class="math inline">\(2/3\)</span> chance of winning if you use the switch strategy.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th style="text-align: center;">W</th>
<th style="text-align: center;">L</th>
<th style="text-align: center;">L</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1/3</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">X</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td>1/3</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">X</td>
</tr>
<tr class="odd">
<td>1/3</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">X</td>
<td style="text-align: center;">1</td>
</tr>
</tbody>
</table>
<p>Not convinced? Try thinking about it this way: Imagine the question with 1000 doors, and Monty will reveal 998 wrong doors after you pick one, so you are left with your choice, and one of the remaining 999 doors. Now do you want to stay or switch?</p>
<p>Again, suppose you are going to switch. Define the events</p>
<ul>
<li>W = the one you switch to is a winner</li>
<li>FW = your first choice is a winner</li>
<li>FL = your first choice is a loser</li>
</ul>
<p>Since you must pick either a winner or loser with your first choice, and cannot pick both, FW and FL are mutually exclusive and collectively exhaustive. By the rule of total probability: <span class="math display">\[
P(W) = P(W \text{ and }FW) + P(W \text{ and }FL) = P(W|FW)P(FW) + P(W|FL)P(FL)
\]</span> <span class="math display">\[
P(W) = 0 \times \frac{1}{3} + 1 \times \frac{2}{3} = \frac{2}{3}
\]</span> Why is <span class="math inline">\(P(W\mid FW)=0\)</span>? Because if we choose correctly, and we do switch, we must be on a loser.</p>
<p>Why is <span class="math inline">\(P(W|FL)=1\)</span>? If we first picked a loser, and then switched, we will now have a winner. These both come from above.</p>
<p>There’s a longer explanation: Suppose you choose door A and Monty opens B.</p>
<p>Consider the events</p>
<ul>
<li>A=prize is behind A</li>
<li>B=prize is behind B</li>
<li>C=prize is behind C</li>
<li>MA=Monty opens A</li>
<li>MB=Monty opens B</li>
<li>MC=Monty Opens C</li>
</ul>
<p>Before we choose, each door was equally likely: <span class="math inline">\(P(A)=P(B)=P(C)=1/3\)</span>.</p>
<p>In this case, we know Monty opened B. To decide whether to switch, we want to know if <span class="math inline">\(P(A |MB)\)</span> and <span class="math inline">\(P(C|MB)\)</span> are the same. If they are, then there is no gain in switching: <span class="math display">\[
P(A|MB) = \frac{P(A \text{ and }MB)}{P(MB)} = \frac{P(MB|A)P(A)}{P(MB)}
\]</span> We need these components: <span class="math inline">\(P(A)=1/3,~P(MB|A)=1/2\)</span>. This is because you picked A, and Monty can open either B or C. He cannot open A. He can open B or C because the condition in this conditional probability is that the prize is actually behind A. <span class="math display">\[
\begin{aligned}
P(MB) &amp; = P(MB \text{ and }A) + P(MB \text{ and }B) + P(MB \text{ and }C)\\
&amp;= P(MB|A)P(A) + P(MB|B)P(B) + P(MB|C)P(C)\\
&amp; = \frac{1}{2}\times\frac{1}{3} + 0\times \frac{1}{3} + 1\times \frac{1}{3} = \frac{1}{6} + \frac{1}{3} = \frac{1}{2}
\end{aligned}
\]</span> I already showed that <span class="math inline">\(Pr(MB\)</span>|A)=1/2$. We have that <span class="math inline">\(Pr(MB|B)=0\)</span> because Monty cannot reveal B if this is where the prize is. If the prize is behind C, he must open B, since you have picked A.</p>
<p>Putting it all together: <span class="math inline">\(P(A|MB) = \frac{P(MB|A)P(A)}{P(MB)} = \frac{\frac{1}{2}\times \frac{1}{3}}{\frac{1}{2}} = \frac{1}{3}\)</span></p>
<p>Similarly for C: <span class="math inline">\(P(C|MB) = \frac{P(MB|C)P(C)}{P(MB)} = \frac{1\times \frac{1}{3}}{\frac{1}{2}} = \frac{2}{3}\)</span></p>
<p>So we are always better off switching$!</p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.55 (Medical Testing for HIV)</strong></span> A controversial issue in recent years has been the the possible implementation of random drug and/or disease testing (e.g.&nbsp;testing medical workers for HIV virus, which causes AIDS). In the case of HIV testing, the standard test is the Wellcome Elisa test.</p>
<p>The test’s effectiveness is summarized by the following two attributes:</p>
<ul>
<li>The <em>sensitivity</em> is about 0.993. That is, if someone has HIV, there is a probability of 0.993 that they will test positive.</li>
<li>The <em>specificity</em> is about 0.9999. This means that if someone doesn’t have HIV, there is probability of 0.9999 that they will test negative.</li>
</ul>
<p>In the general population, incidence of HIV is reasonably rare. It is estimated that the chance that a randomly chosen person has HIV is <span class="math inline">\(0.000025\)</span>.</p>
<p>To investigate the possibility of implementing a random HIV-testing policy with the Elisa test, calculate the following:</p>
<ol type="a">
<li>The probability that someone will test positive and have HIV.</li>
<li>The probability that someone will test positive and not have HIV.</li>
<li>The probability that someone will test positive.</li>
<li>Suppose someone tests positive. What is the probability that they have HIV?</li>
</ol>
<p>In light of the last calculation, do you envision any problems in implementing a random testing policy?</p>
<p><strong>Solution</strong>:</p>
<p>First, introduce some notation: let <span class="math inline">\(H\)</span> = “Has HIV” and <span class="math inline">\(T\)</span> = “Tests Positive”. We are given the following sensitivities and specificities <span class="math display">\[
P(T|H) = 0.993 \; \; \text{ and} \; \; P(\bar{T}|\bar{H}) = 0.9999
\]</span> The base rate is <span class="math inline">\(P(H) = 0.000025\)</span>.</p>
<ol type="a">
<li><span class="math inline">\(P(T \text{ and }H) = P(T|H)P(H) = 0.993*0.000025 = 0.000024825\)</span></li>
<li><span class="math display">\[\begin{aligned}
P(T|\bar{H})P(\bar{H}) &amp; = (1-P(\bar{T}|\bar{H}))(1-P(H))\\
&amp; = 0.0001 \times 0.999975 = 0.0000999975
\end{aligned}\]</span></li>
<li><span class="math inline">\(P(T) = P(T \text{ and }H) + P(T \text{ and }\bar{H}) = 0.000024825 + 0.00009975 = 0.0001248225\)</span></li>
<li><span class="math inline">\(P(H|T) = \frac{P(H \text{ and }T)}{P(T)} = \frac{0.000024825}{0.0001248225} = 0.1988\)</span></li>
</ol>
<p>This says that if you test positive, you have a 20% chance of having the disease. In other words, 80% of people who test positive will not have the disease. The large number of false positives means that implementing such a policy will be pretty unpopular among the people who have to be tested. Testing high risk people only might be a better idea, as this will increase the <span class="math inline">\(P(H)\)</span> in the population.</p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.56 (The Three Prisoners)</strong></span> An unknown two will be shot, the other freed. Prisoner A asks the warder for the name of one other than himself who will be shot, explaining that as there must be at least one, the warder won’t really be giving anything away. The warder agrees, and says that B will be shot. This cheers A up a little: his judgmental probability for being shot is now 1/2 instead of 2/3.</p>
<p>Show (via Bayes theorem) that</p>
<ol type="a">
<li>A is mistaken - assuming that he thinks the warder is as likely to say "C" as "B" when he can honestly say either; but that</li>
<li>A would be right, on the hypothesis that the warder will say "B" whenever he honestly can.</li>
</ol>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.57 (The Two Children)</strong></span> You meet Max walking with a boy whom he proudly introduces as his son.</p>
<ol type="a">
<li>What is your probability that his other child is also a boy, if you regard him as equally likely to have taken either child for a walk?</li>
<li>What would the answer be if you regarded him as sure to walk with the boy rather than the girl, if he has one of each?</li>
<li>What would the answer be if you regarded him as sure to walk with the girl rather than the boy, if he has one of each?</li>
</ol>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.58 (Medical Exam)</strong></span> As a result of medical examination, one of the tests revealed a serious illness in a person. This test has a high precision of 99% (the probability of a positive response in the presence of the disease is 99%, the probability of a negative response in the absence of the disease is also 99%). However, the detected disease is quite rare and occurs only in one person per 10,000. Calculate the probability that the person being examined does have an identified disease.</p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.59 (The Jury)</strong></span> Assume that the probability is 0.95 that a jury selected to try a criminal case will arrive at the correct verdict whether innocent or guilty. Further, suppose that the 80% of people brought to trial are in fact guilty.</p>
<ol type="a">
<li>Given that the jury finds a defendant innocent what’s the probability that they are in fact innocent?</li>
<li>Given that the jury finds a defendant guilty what’s the probability that they are in fact guilty?</li>
<li>Do these probabilities sum to one?</li>
</ol>
<p><strong>Solution</strong>:</p>
<p>Let <span class="math inline">\(I\)</span> denote the event of innocence and let <span class="math inline">\(VI\)</span> denote the event that the jury proclaims an innocent verdict.</p>
<ol type="a">
<li>We want <span class="math inline">\(P(I|VI)\)</span> which is given by Bayes’ rule <span class="math display">\[
P(I|VI)=\frac{P(VI|I)P(I)}{P(VI)}
\]</span> where, by the law of total probability <span class="math inline">\(P(VI)=P(VI|I)P(I)+P(VI|\bar{I})P(\bar{I})\)</span> Hence <span class="math inline">\(P(VI) =0.95\cdot 0.2+0.05\cdot 0.8=0.23\)</span> Hence <span class="math inline">\(P(I|VI)=\frac{0.95\cdot 0.2}{0.23}=0.83\)</span></li>
<li>Similarly <span class="math display">\[
P(G|VG)=\frac{P(VG|G)P(G)}{P(VG)}=\frac{P(VG|G)P(G)}{1-P(VI)}=\frac{%
0.95\cdot 0.8}{1-0.23}=0.99
\]</span></li>
<li>No.&nbsp;<span class="math inline">\(P(I|VI)+P(G|{VG})\neq 1\)</span> because they are conditioned on different events.</li>
</ol>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.60 (Oil company)</strong></span> An oil company has purchased an option on land in Alaska. Preliminary geologic studies have assigned the following probabilities of finding oil <span class="math display">\[
P ( \text{ high \; quality \; oil} ) = 0.50 \; \;
P ( \text{ medium \; quality \; oil} ) = 0.20 \; \;
P ( \text{ no \; oil} ) = 0.30 \; \;
\]</span> After 200 feet of drilling on the first well, a soil test is taken. The probabilities of finding the particular type of soil identified by the test are as follows: <span class="math display">\[
P ( \text{ soil} \; | \; \text{ high \; quality \; oil} ) = 0.20 \; \;
P ( \text{ soil} \; | \; \text{ medium \; quality \; oil} ) = 0.80 \; \;
P ( \text{ soil} \; | \; \text{ no \; oil} ) = 0.20 \; \;
\]</span></p>
<ol type="a">
<li>What are the revised probabilities of finding the three different types of oil?</li>
<li>How should the firm interpret the soil test?</li>
</ol>
<p><strong>Solution</strong>:</p>
<ol type="a">
<li>Using Bayes’ Theorem, we get <span class="math display">\[P ( \text{ high \; quality \; oil} \; | \;  \text{ soil}) =
   \frac{ P ( \text{ soil} \; | \; \text{ high \; quality \; oil} ) P ( \text{ high \; quality \; oil} )}
{ P ( \text{ soil} ) }\]</span> Using the law of total probability <span class="math display">\[P ( \text{ soil}) = 0.5 \times 0.2 + 0.2 \times 0.8 + 0.3 \times 0.2 = 0.32\]</span> Hence <span class="math display">\[P ( \text{ high \; quality \; oil} \; | \;  \text{ soil}) =
   \frac{ 0.5 \times 0.2}{ 0.32 } = 0.3125\]</span> Similarly <span class="math display">\[P ( \text{ medium \; quality \; oil} \; | \;  \text{ soil}) =
   \frac{ 0.8 \times 0.2}{ 0.32 } = 0.50\]</span> <span class="math display">\[P ( \text{ no \; oil} \; | \;  \text{ soil}) =
   \frac{ 0.3 \times 0.2}{ 0.32 } = 0.1875\]</span></li>
<li>The firm should interpret the soil test as increasing the probability of medium quality oil, but making both no oil and high quality oil less likely than their initial probabilities.</li>
</ol>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.61</strong></span> A screening test for high blood pressure, corresponding to a diastolic blood pressure of <span class="math inline">\(90\)</span>mm Hg or higher, produced the following probability table</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th style="text-align: center;">Hypertension</th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Test</td>
<td style="text-align: center;">Present</td>
<td>Absent</td>
</tr>
<tr class="even">
<td>+ve</td>
<td style="text-align: center;">0.09</td>
<td>0.03</td>
</tr>
<tr class="odd">
<td>-ve</td>
<td style="text-align: center;">0.03</td>
<td>0.85</td>
</tr>
</tbody>
</table>
<ol type="a">
<li>What’s the probability that a random person has hypertension?</li>
<li>What’s the probability that someone tests positive on the test?</li>
<li>Given a person who tests positive, what is the probability that they have hypertension?</li>
<li>What would happen to your probability of having hypertension given you tested positive if you initially thought you had a <span class="math inline">\(50\)</span>% chance of having hypertension.</li>
</ol>
<p><strong>Solution</strong>:</p>
<ol type="a">
<li><span class="math inline">\(P(H) = 0.09 + 0.03 = 0.12\)</span></li>
<li><span class="math inline">\(P(+)=0.09+0.03 =0.12\)</span></li>
<li><span class="math inline">\(P(H|+)=P(+|H)P(H)/P(+)= 0.09/0.12 = 0.75\)</span></li>
<li>Now you have to re-calculate <span class="math inline">\(P(+) = P( +|H)P(H) + P( + | \bar{H} )P( \bar{H} )
= 0.38\)</span>. Then, by Bayes rule <span class="math display">\[P(H|+)= \frac{P(+|H)P(H)}{P(+)} = \frac{0.09 \times 0.5}{0.38} = 0.99\]</span></li>
</ol>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.62 (Steroids)</strong></span> Suppose that a hypothetical baseball player (call him “Rafael”) tests positive for steroids. The test has the following sensitivity and specificity</p>
<ol type="a">
<li>If a player is on Steroids, there’s a <span class="math inline">\(95\)</span>% chance of a positive result.</li>
<li>If a player is clean, there’s a <span class="math inline">\(10\)</span>% chance of a positive result.</li>
</ol>
<p>A respected baseball authority (call him “Bud”) claims that <span class="math inline">\(1\)</span>% of all baseball players use Steroids. Another player (call him “Jose”) thinks that there’s a <span class="math inline">\(30\)</span>% chance of all baseball players using Steroids.</p>
<ol type="a">
<li>What’s Bud’s probability that Rafael uses Steroids?</li>
<li>What’s Jose’s probability that Rafael uses Steroids?</li>
</ol>
<p>Explain any probability rules that you use.</p>
<p><strong>Solution</strong>:</p>
<p>Let <span class="math inline">\(T\)</span> and <span class="math inline">\(\bar{T}\)</span> be positive and negative test results. Let <span class="math inline">\(S\)</span> and <span class="math inline">\(\bar{S}\)</span> be using and not using Steroids, respectively. We have the following conditional probabilities <span class="math display">\[
P( T | S ) = 0.95 \; \; \text{ and} \; \; P( T | \bar{S} ) = 0.10
\]</span> For our prior distributions we have <span class="math inline">\(P_{ Bud } ( S  ) = 0.01\)</span> and <span class="math inline">\(P_{ Jose } ( S  ) = 0.30\)</span>.</p>
<p>From Bayes rule and we have <span class="math display">\[
P( S | T )  = \frac{ P( T | S ) P( S )}{ P(T )}
\]</span> and by the law of total probability <span class="math display">\[
P(T)  = P( T| S) P(S) + P( T| \bar{S} ) P( \bar{S} )
\]</span> Applying these two probability rules gives <span class="math display">\[
P_{ Bud} ( S | T ) = \frac{ 0.95 \times 0.01 }{  0.95 \times 0.01 + 0.10 \times 0.99 } = 0.0876
\]</span> and <span class="math display">\[
P_{ Jose } ( S | T ) = \frac{ 0.95 \times 0.3 }{  0.95 \times 0.3 + 0.10 \times 0.7 } = 0.8028
\]</span></p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.63</strong></span> A Breathalyzer test is calibrated so that if it is used on a driver whose blood alcohol concentration exceeds the legal limit, it will read positive <span class="math inline">\(99\)</span>% of the time, while if the driver is below the limit it will read negative <span class="math inline">\(90\)</span>% of the time. Suppose that based on prior experience, you have a prior probability that the driver is above the legal limit of <span class="math inline">\(10\)</span>%.</p>
<ol type="a">
<li>If a driver tests positive, what is the posterior probability that they are above the legal limit?</li>
<li>At Christmas <span class="math inline">\(20\)</span>% of the drivers on the road are above the legal limit. If all drivers were tested, what proportion of those testing positive would actually be above the limit</li>
<li>How does your answer to part <span class="math inline">\(1\)</span> change. Explain</li>
</ol>
<p><strong>Solution</strong>:</p>
<p>Let the events be defined as follows:</p>
<ul>
<li>E - Alcohol concentration exceeds legal limit</li>
<li>NE - Alcohol concentration does not exceed legal limit</li>
<li>P - Breathalyser reads positive</li>
<li>N - Breathalyser reads negative</li>
</ul>
<p><span class="math display">\[
\begin{aligned}
P(P|E) &amp; = &amp; 0.99\\
P(N|NE) &amp; = &amp; 0.90\\
P(E) &amp; = &amp; 0.10\end{aligned}
\]</span></p>
<p>Based on above, we have <span class="math inline">\(P(P|NE)=1-P(N|NE)=0.10\)</span> and <span class="math inline">\(P(NE)=1-P(E)=0.90\)</span>. Then,</p>
<p><span class="math display">\[
\begin{aligned}
P(E|P) &amp; = &amp; \frac{P(P|E)P(E)}{P(P)}\\
&amp; = &amp; \frac{P(P|E)P(E)}{P(P|E)P(E)+P(P|NE)P(NE)}\\
&amp; = &amp; \frac{0.99\times0.10}{0.99\times0.10+0.10\times0.90}\\
&amp; = &amp; 52.38\%\end{aligned}
\]</span></p>
<p>Now, we have <span class="math inline">\(P(E)=0.20\)</span>. Thus, <span class="math inline">\(P(NE)=1-P(E)=0.80\)</span>. We now calculate</p>
<p><span class="math display">\[
\begin{aligned}
P(E|P) &amp; = &amp; \frac{P(P|E)P(E)}{P(P)}\\
&amp; = &amp; \frac{P(P|E)P(E)}{P(P|E)P(E)+P(P|NE)P(NE)}\\
&amp; = &amp; \frac{0.99\times0.20}{0.99\times0.20+0.10\times0.80}\\
&amp; = &amp; 71.22\%\end{aligned}
\]</span></p>
<p>Thus, 71.22% of all the drivers who test positive would be above the legal limit.</p>
<p>Compared to Part 1, the posterior probability increases due to the fact that the probability of a driver testing positive and exceeding the legal limit increases as does the probability of testing positive. However, the increase in the probability of testing positive and exceeding the legal limit is greater than the increase in the probability of testing positive which results in an increase in the posterior probability.</p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.64 (Chicago bearcats)</strong></span> The Chicago bearcats baseball team plays <span class="math inline">\(60\)</span>% of its games at night and <span class="math inline">\(40\)</span>% in the daytime. They win <span class="math inline">\(55\)</span>% of their night games and only <span class="math inline">\(35\)</span>% of their day games. You found out the next day that they won their last game</p>
<ol type="a">
<li>What is the probability that the game was played at night</li>
<li>What is the marginal probability that they will win their next game?</li>
</ol>
<p>Explain clearly any rules of probability that you use.</p>
<p><strong>Solution</strong>:</p>
<p>We have the following info:</p>
<ul>
<li><span class="math inline">\(P(Night) = 0.6, \quad P(Day)=0.4\)</span></li>
<li><span class="math inline">\(P(Win|Night) = 0.55, \quad P(Lose|Night)=0.45\)</span></li>
<li><span class="math inline">\(P(Win|Day) = 0.35, \quad P(Lose|Day)=0.65\)</span></li>
</ul>
<ol type="a">
<li><span class="math display">\[P(Night|Win) = \frac{P(Win|Night)P(Night)}{P(Win)}\]</span> <span class="math display">\[=\frac{P(Win|Night)P(Night)}{P(Win|Day)P(Day)+P(Win|Night)P(Night)}\]</span> <span class="math display">\[\frac{0.55*0.6}{0.35*0.4+0.55*0.6}=\frac{0.33}{0.47}=0.7021\]</span></li>
<li><span class="math inline">\(P(Win) = P(Win|Day)P(Day)+P(Win|Night)P(Night)=0.35*0.4+0.55*0.6=0.47\)</span></li>
</ol>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.65 (Spam Filter)</strong></span> Several spam filters use Bayes rule. Suppose that you empirically find the following probability table for classifying emails with the phrase “buy now” in their title as either “spam” or “not spam”.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th style="text-align: center;">Spam</th>
<th style="text-align: center;">Not Spam</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>“buy now”</td>
<td style="text-align: center;">0.02</td>
<td style="text-align: center;">0.08</td>
</tr>
<tr class="even">
<td>not “buy now”</td>
<td style="text-align: center;">0.18</td>
<td style="text-align: center;">0.72</td>
</tr>
</tbody>
</table>
<ol type="a">
<li>What is the probability that you will receive an email with spam?</li>
<li>Suppose that you are given a new email with the phrase “buy now” in its title. What is the probability that this new email is spam?</li>
<li>Explain clearly any rules of probability that you use.</li>
</ol>
<p><strong>Solution</strong>:</p>
<ol type="a">
<li>The probability that you will receive an email with spam is: <span class="math display">\[
\begin{aligned}
Pr(Spam) = .02 + .18 = .2
\end{aligned}
\]</span></li>
<li>The posterior probability is <span class="math display">\[
\begin{aligned}
Pr(Spam|buy \; now) = \frac{Pr(Spam\;and\;buy\;now)}{Pr(buy\;now)} = \frac{.02}{.02+.08} = .2
\end{aligned}
\]</span></li>
<li>The marginal probability is given by the law of total probability: <span class="math inline">\(P( B) = P(B|A)P(A) + P(B|\bar{A})P(\bar{A})\)</span>. We also use the definition of conditional probability (not Bayes’ rule) <span class="math inline">\(Pr(A|B) = \frac{Pr(A\;and\;B)}{Pr(B)}\)</span></li>
</ol>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.66 (Chicago Cubs)</strong></span> The Chicago Cubs are having a great season. So far they’ve won <span class="math inline">\(72\)</span> out of the <span class="math inline">\(100\)</span> games played so far. You also have the expert opinion of Bob the sports analysis. He tells you that he thinks the Cubs will win. Historically his predictions have a <span class="math inline">\(60\)</span>% chance of coming true.</p>
<ol type="a">
<li>Calculate the probability that the Cubs will win given Bob’s prediction</li>
<li>Suppose you now learn that it’s a home game and that the Cubs win <span class="math inline">\(60\)</span>% of their games at Wrigley field. What’s you updated probability that the Cubs will win their game?</li>
</ol>
<p><strong>Solution</strong>:</p>
<ol type="a">
<li>First we have <span class="math display">\[
P ( \text{ Win} | \text{ Bob} ) = \frac{ 0.72 \times 0.6}{ 0.72 \times 0.6 + 0.28 \times 0.4} = 0.79
\]</span></li>
</ol>
<ol start="2" type="A">
<li>Learning the new information, we use the previous posterior as a prior for the next Bayes update <span class="math display">\[
P ( \text{ Win} | \text{ home} , \text{ Bob}  ) = \frac{ 0.79 \times 0.60}{ 0.79 \times 0.60 + 0.21 \times 0.40} = 0.85
\]</span> it’s highly likely that the Cubs will win!</li>
</ol>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.67 (Student-Grade Causality)</strong></span> Consider the following probabilistic model. The student does poorly poorly in a class (<span class="math inline">\(c = 1\)</span>) or well (<span class="math inline">\(c = 0\)</span>) depending on the presence/absence of depression (<span class="math inline">\(d = 1\)</span> or <span class="math inline">\(d = 0\)</span>) and weather he/she partied last night (<span class="math inline">\(v = 1\)</span> or <span class="math inline">\(v = 0\)</span>) . Participation in the party can also lead to the fact that the student has a headache (<span class="math inline">\(h = 1\)</span>). As a result of poor student’s performance, the teacher gets upset (<span class="math inline">\(t = 1\)</span>). The probabilities are given by:</p>
<div class="quarto-layout-panel" data-layout-ncol="3">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;"><span class="math inline">\(p(c=1|d,v)\)</span></th>
<th style="text-align: center;">v</th>
<th style="text-align: center;">d</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">0.999</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center;">0.9</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0.9</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center;">0.01</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
</tbody>
</table>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;"><span class="math inline">\(p(h=1|v)\)</span></th>
<th style="text-align: left;">v</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0.9</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">0.1</td>
<td style="text-align: left;">0</td>
</tr>
</tbody>
</table>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;"><span class="math inline">\(p(t=1|c)\)</span></th>
<th style="text-align: center;">c</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">0.95</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center;">0.05</td>
<td style="text-align: center;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p><span class="math inline">\(p(v=1)=0.2\)</span>, and <span class="math inline">\(p(d=1) = 0.4\)</span>.</p>
<p>Draw the causal relationships in the model. Calculate <span class="math inline">\(p(v=1|h=1)\)</span>, <span class="math inline">\(p(v=1|t=1)\)</span>, <span class="math inline">\(p(v=1|t=1,h=1)\)</span>.</p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.68 (Prisoner)</strong></span> An unknown two will be shot, the other freed. Prisoner A asks the warder for the name of one other than himself who will be shot, explaining that as there must be at least one, the warder won’t really be giving anything away. The warder agrees, and says that B will be shot. This cheers A up a little: his judgmental probability for being shot is now 1/2 instead of 2/3. Show (via Bayes theorem) that</p>
<ol type="a">
<li>A is mistaken - assuming that he thinks the warder is as likely to say "C" as "B" when he can honestly say either; but that</li>
<li>A would be right, on the hypothesis that the warder will say "B" whenever he honestly can.</li>
</ol>
<p><strong>Solution</strong>:</p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.69 (True/False)</strong></span> &nbsp;</p>
<ol type="a">
<li>In a sample of <span class="math inline">\(100,000\)</span> emails you found that <span class="math inline">\(550\)</span> are spam. Your next email contains the word “bigger”. From historical experience, you know that half of all spam email contains the word “bigger” and only <span class="math inline">\(2\)</span>% of non-spam emails contain it. The probability that this new email is spam is approximately <span class="math inline">\(12\)</span>%.</li>
<li>Suppose that there’s a <span class="math inline">\(5\)</span>% chance that it snows tomorrow and a <span class="math inline">\(80\)</span>%chance that the Chicago bears play their football game tomorrow given that it snows. The probability that they play tomorrow is then <span class="math inline">\(80\)</span>%.</li>
<li>Bayes’ rule states that <span class="math inline">\(p(A|B) =p(B|A)\)</span>.</li>
<li>If <span class="math inline">\(P( A  \text{ and }B ) = 0.4\)</span> and <span class="math inline">\(P( B) = 0.8\)</span>, then <span class="math inline">\(P( A|B ) = 0.5\)</span>.</li>
</ol>
<p><strong>Solution</strong>:</p>
<ol type="a">
<li>True. <span class="math display">\[P(bigger \mid spam) = 50\% \mbox{ and } P(bigger \mid non-spam) = 2\%\]</span><span class="math display">\[P(spam) = 0.55\% \mbox{ and } P(non-spam) = 99.45\%\]</span><span class="math display">\[\begin{aligned}P(spam \mid bigger) &amp;=&amp; \frac{P(bigger \mid spam)*P(spam)}{P(bigger \mid spam)*P(spam) + P(bigger \mid non-spam)*P(non-spam) } \\&amp;=&amp; 12.1\%\end{aligned}\]</span></li>
<li>False, 99% <span class="math display">\[P(Play) = P(Play|Snow)P(Snow) + P(Play|NoSnow)P(NoSnow)\]</span><span class="math display">\[= 0.8*0.05+1*0.95=0.99\]</span></li>
<li>False. Recall Bayes’ rule:* <span class="math display">\[p(A|B)=\frac{p(B|A)p(A)}{p(B)}\]</span></li>
<li>True. <span class="math inline">\(P( A|B ) =  P( A  \text{ and }B )/P(B)\)</span> by Bayes rule.</li>
</ol>
</div>
</section>
<section id="utility-and-decisions" class="level2" data-number="27.3">
<h2 data-number="27.3" class="anchored" data-anchor-id="utility-and-decisions"><span class="header-section-number">27.3</span> Utility and Decisions</h2>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.70 (Two Gambles)</strong></span> In an experiment, subjects were given the choice between two gambles:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Experiment 1</th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Gamble <span class="math inline">\({\cal G}_A\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">Gamble <span class="math inline">\({\cal G}_B\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">Win</td>
<td style="text-align: center;">Chance</td>
<td style="text-align: center;">Win</td>
<td style="text-align: center;">Chance</td>
</tr>
<tr class="odd">
<td style="text-align: center;">$2500</td>
<td style="text-align: center;">0.33</td>
<td style="text-align: center;">$2400</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center;">$2400</td>
<td style="text-align: center;">0.66</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">$0</td>
<td style="text-align: center;">0.01</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
<p>Suppose that a person is an expected utility maximizer. Set the utility scale so that u($0) = 0 and u($2500) = 1. person is an expected utility maximizer. Set the utility scale so that u($0) = 0 and u($2500) = 1. Whether a utility maximizing person would choose Option A or Option B depends on the person’s utility for $2400. For what values of u($2400) would a rational person choose Option A? For what values would a rational person choose Option B?</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Experiment 2</th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Gamble <span class="math inline">\({\cal G}_C\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">Gamble <span class="math inline">\({\cal G}_D\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">Win</td>
<td style="text-align: center;">Chance</td>
<td style="text-align: center;">Win</td>
<td style="text-align: center;">Chance</td>
</tr>
<tr class="odd">
<td style="text-align: center;">$2500</td>
<td style="text-align: center;">0.33</td>
<td style="text-align: center;">$2400</td>
<td style="text-align: center;">0.34</td>
</tr>
<tr class="even">
<td style="text-align: center;">$0</td>
<td style="text-align: center;">0.67</td>
<td style="text-align: center;">$0</td>
<td style="text-align: center;">0.66</td>
</tr>
</tbody>
</table>
<p>For what values of u($2400) would a person choose Option C? For what values would a person choose Option D? Explain why no expected utility maximizer would prefer B and C.</p>
<p>This problem is a version of the famous Allais paradox, named after the prominent critic of subjective expected utility theory who first presented it. Kahneman and Tversky found that 82% of subjects preferred B over A, and 83% preferred C over D. Explain why no expected utility maximizer would prefer both B in Gamble 1 and C in Gamble 2. (A utility maximizer might prefer B in Gamble 1. A different utility maximizer might prefer C in Gamble 2. But the same utility maximizer would not prefer both B in Gamble 1 and C in Gamble</p>
<p>Discuss these results. Why do you think many people prefer B in Gamble 1 and C in Gamble 2? Do you think this is reasonable even if it does not conform to expected utility theory?</p>
<p><strong>Solution</strong>:</p>
<p>Define x = u($2400), the utility of $2400.</p>
<p>For A versus B:</p>
<ul>
<li>Expected utility of A is 0.33* (1) + 0.66<em>(x) + 0.1</em>(0)</li>
<li>Expected utility of B is x</li>
</ul>
<p>Setting them equal and solving for x tells us the value of x for which an expected utility maximizer would be indifferent between the two options <span class="math display">\[0.33* (1) + 0.66*(x) + 0.1*(0) = x\]</span> <span class="math display">\[x = 0.33/0.34.\]</span></p>
<p>For C versus D:</p>
<ul>
<li>Expected utility of C is 0.33* (1) + 0.67*(0)</li>
<li>Expected utility of D is 0.34*(x)</li>
</ul>
<p>Setting them equal and solving for x tells us the value of x for which an expected utility maximizer would be indifferent between the two options <span class="math display">\[0.33* (1) = 0.34*(x)\]</span> <span class="math display">\[x = 0.33/0.34\]</span></p>
<p>If x &lt; 33/34, then an expected utility maximizer would choose option C. If x&gt;33/34, option D an expected utility maximizer would choose option D</p>
<p>Why no utility maximizer would prefer B and C?</p>
<p>A utility maximizer would pick B if x&gt;33/34, and would pick C if x&lt;33/34. These regions do not overlap. By definition, an expected utility maximizer has a consistent utility value for a given payout regardless of the probability structure. Therefore, no utility maximizer would prefer B and C. A utility maximizer would be indifferent among all four of these gambles if x = 33/34. But no utility maximizer would strictly prefer B over A, and C over D.</p>
<p>Many people’s choices violate subjective expected utility theory in this problem. In fact, Allais carefully crafted this problem to exploit what Kahneman and Tversky called the “certainty effect.” In the choice of A vs B, many prefer a sure gain to a small chance of no gain. On the other hand, in the choice of C vs D, there is no certainty, and so people are willing to reduce their chances of winning by what feels like a small amount to give themselves a chance to win a larger amount. When given an explanation for why these choices are inconsistent with “economic rationality,” some people say they made an error and revise their choices, but others stand firmly by their choices and reject expected utility theory.</p>
<p>It is also interesting to look at how people respond to a third choice:</p>
<p>Experiment 3:</p>
<p>This is a two-stage problem. In the first stage there is a 66% chance you will win nothing and quit. There is a 34% chance you will go on to the second stage. In the second stage you may choose between the following two options.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">Gamble</th>
<th style="text-align: left;">Payout</th>
<th style="text-align: left;">Probability</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">E</td>
<td style="text-align: left;">$2500</td>
<td style="text-align: left;">33/34</td>
</tr>
<tr class="even">
<td style="text-align: left;">E</td>
<td style="text-align: left;">$0</td>
<td style="text-align: left;">1/34</td>
</tr>
<tr class="odd">
<td style="text-align: left;">F</td>
<td style="text-align: left;">$2400</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">F</td>
<td style="text-align: left;">$0</td>
<td style="text-align: left;">1/34</td>
</tr>
</tbody>
</table>
<p>Experiment 3 is mathematically equivalent to Experiment 2. That is, the probability distributions of the outcomes for E and C are the same, and the probability distributions of the outcomes for F and D are the same. In experiments, the most common pattern of choices on these problems is to prefer B, C, and F. There is an enormous literature on the Allais paradox and related ways in which people systematically violate the principles of expected utility theory. For more information see <a href="http://en.wikipedia.org/wiki/Allais_paradox">Wikipedia on Allais paradox</a>.</p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.71 (Decisions)</strong></span> You are sponsoring a fund raising dinner for your favorite political candidate. There is uncertainty about the number of people who will attend (the random variable <span class="math inline">\(X\)</span>), but based on past dinners, you think that the probability function looks like this:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: right;"><span class="math inline">\(x\)</span></th>
<th style="text-align: left;">100</th>
<th style="text-align: left;">200</th>
<th style="text-align: left;">300</th>
<th style="text-align: left;">400</th>
<th style="text-align: left;">500</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"><span class="math inline">\(P_X(x)\)</span></td>
<td style="text-align: left;">0.1</td>
<td style="text-align: left;">0.2</td>
<td style="text-align: left;">0.3</td>
<td style="text-align: left;">0.2</td>
<td style="text-align: left;">0.2</td>
</tr>
</tbody>
</table>
<ol type="a">
<li>Calculate <span class="math inline">\(E(X)\)</span>, the expected number of people who will attend.</li>
<li>The owner of the venue is going to charge you $1500 for rental and other miscellaneous costs. You know that you will make a profit (after per person costs) of $40 for each person attending. Calculate the expected profit after the rental cost.</li>
<li>The owner of the venue proposes an alternative pricing scheme. Instead of charging $1500, she will charge you either $5 per person or $2100, whichever is smaller. So if 100 people come, you only pay $500. If 500 come, you pay $2100. Calculate the expected profit under this scheme (still assuming $40 per plate profit before you pay the owner).</li>
<li>Let <span class="math inline">\(Y_1\)</span> be your profit under the first scheme and <span class="math inline">\(Y_2\)</span> be your profit under the second. If you do the calculations, it turns out that the standard deviations of these profits are: <span class="math display">\[\sigma_{Y_1} = 4996 \qquad \sigma_{Y_2} = 4488\]</span> Using the expected values calculated above explain which of the two scenarios you prefer.</li>
</ol>
<p><strong>Solution</strong>:</p>
<ol type="a">
<li><p><span class="math inline">\(E(X) = 100(.1) + 200(.2) + 300(.3) + 400(.2) +500(.2) = 320\)</span></p></li>
<li><p><span class="math inline">\(Y=40X-1500\)</span> <span class="math inline">\(E(Y) = E(40X-1500) = 40 E(X) -1500  = 40(320) -1500 = 11300\)</span></p></li>
<li><p>Profit = <span class="math inline">\(40X - \min(2100, 5X)\)</span>. Note that the profit formula is not linear (just like in the newspaper example). Consequently, you need to re-calculate profit for each of the five cases to get the expected value.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;"><span class="math inline">\(x\)</span></th>
<th style="text-align: left;">100</th>
<th style="text-align: left;">200</th>
<th style="text-align: left;">300</th>
<th style="text-align: left;">400</th>
<th style="text-align: left;">500</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(p_X(x)\)</span></td>
<td style="text-align: left;">0.1</td>
<td style="text-align: left;">0.2</td>
<td style="text-align: left;">0.3</td>
<td style="text-align: left;">0.2</td>
<td style="text-align: left;">0.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">costs</td>
<td style="text-align: left;">500</td>
<td style="text-align: left;">1000</td>
<td style="text-align: left;">1500</td>
<td style="text-align: left;">2000</td>
<td style="text-align: left;">2100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">gross</td>
<td style="text-align: left;">4000</td>
<td style="text-align: left;">8000</td>
<td style="text-align: left;">12000</td>
<td style="text-align: left;">16000</td>
<td style="text-align: left;">20000</td>
</tr>
<tr class="even">
<td style="text-align: left;">profit = gross – costs</td>
<td style="text-align: left;">3500</td>
<td style="text-align: left;">7000</td>
<td style="text-align: left;">10500</td>
<td style="text-align: left;">14000</td>
<td style="text-align: left;">17900</td>
</tr>
</tbody>
</table>
<p><span class="math inline">\(E(profit) = 3500(.1) + 7000(.2) + 10500(.3) + 14000(.2) + 17900(.2)
= 11280\)</span></p></li>
<li><p>The profit and standard deviation are larger in (b) than in (c). If you are risk averse, go for (c) (less uncertainty). If you are a gambler, go for (b) (higher average return). Since the difference in <span class="math inline">\(\sigma\)</span> is larger than in the mean.</p></li>
</ol>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.72 (Marjorie Visit)</strong></span> Marjorie is worried about whether it is safe to visit a vulnerable relative during a pandemic. She is considering whether to take an at-home test for the virus before visiting her relative. Assume the test has sensitivity 85% and specificity 92%. That is, the probability that the test will be positive is about 85% if an individual is infected with the virus, and the probability that test will be negative is about 92% if an individual is not infected.</p>
<p>Further, assume the following losses for Marjorie</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">Event</th>
<th style="text-align: left;">Loss</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Visit relative, not infected</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Visit relative, infected</td>
<td style="text-align: left;">100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Do not visit relative, not infected</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Do not visit relative, infected</td>
<td style="text-align: left;">5</td>
</tr>
</tbody>
</table>
<ol type="a">
<li>Assume that about 2 in every 1,000 persons in the population is currently infected. What is the posterior probability that an individual with a positive test has the disease?</li>
<li>Suppose case counts have decreased substantially to about 15 in 100,000. What is the posterior probability that an individual with a positive test has the disease?</li>
<li>Suppose Marjorie is deciding whether to visit her relative and if so whether to test for the disease before visiting. If the prior probability that Marjorie has the disease is 200 in 100,000, find the policy that minimizes expected loss. That is, given each of the possible test results, should Marjorie visit her relative? Find the EVSI. Repeat for a prior probability of 15 in 100,000. Discuss.</li>
<li>For the decision of whether Marjorie should visit her relative, find the range of prior probabilities for which taking the at-home test results in lower expected loss than ignoring or not taking the test (assuming the test is free). Discuss your results.</li>
</ol>
<p><strong>Solution</strong>:</p>
<ol type="a">
<li>For a person in the given population, we have the following probabilities for the test outcome:</li>
</ol>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">Condition</th>
<th style="text-align: left;">Positive</th>
<th style="text-align: left;">Negative</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Disease present</td>
<td style="text-align: left;">0.85</td>
<td style="text-align: left;">0.15</td>
</tr>
<tr class="even">
<td style="text-align: left;">Disease absent</td>
<td style="text-align: left;">0.08</td>
<td style="text-align: left;">0.92</td>
</tr>
</tbody>
</table>
<p>Prior Probability: P(Disease present) = 0.002 and P(Disease absent)=0.998</p>
<p>We can calculate the posterior probability that the individual has the disease as follows:</p>
<p>First, we calculate the probability of a positive test (this will be the denominator of Bayes Rule):</p>
<p>P(Positive) = P(Positive | Present) * P(Present)+P(Positive | Absent) * P(Absent) = <span class="math inline">\(0.85\times 0.002 + 0.08\times 0.998 = 0.08154\)</span></p>
<p>Then, we calculate the posterior probability that the individual is has the disease by applying Bayes rule:</p>
<p>P(Present | Positive) = P(Positive | Present) * P(Present)/P(Positive) = 0.85 * 0.002/0.08154 = 0.0208</p>
<p>The posterior probability that an individual who tests positive has the disease is 0.0208.</p>
<ol start="2" type="a">
<li>The sensitivity and specificity of the test are the same as above:</li>
</ol>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">Condition</th>
<th style="text-align: left;">Positive</th>
<th style="text-align: left;">Negative</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Disease present</td>
<td style="text-align: left;">0.85</td>
<td style="text-align: left;">0.15</td>
</tr>
<tr class="even">
<td style="text-align: left;">Disease absent</td>
<td style="text-align: left;">0.08</td>
<td style="text-align: left;">0.92</td>
</tr>
</tbody>
</table>
<p>But the prior probability is different:</p>
<p>P(Disease present) = 0.00015 and P(Disease absent)=0.99985</p>
<p>Again, we calculate the probability of a positive test (this will be the denominator of Bayes Rule):</p>
<p>P(Positive) = P(Positive | Present) * P(Present)+P(Positive | Absent) * P(Absent) = 0.85 * 0.00015 + 0.08 * 0.99985 = 0.0801155</p>
<p>Then, we calculate the posterior probability that the individual is has the disease by applying Bayes rule:</p>
<p>P(Present | Positive) = P(Positive | Present) * P(Present)/P(Positive) = 0.85 * 0.00015/0.0801155 = 0.00159</p>
<p>The posterior probability that an individual who tests positive has the disease is 0.00159.</p>
<p>In both cases, the posterior probability that the individual has the disease is small, even after taking the at-home test. But it is important to note that the probability has increased by more than a factor of 10, from 2 in 1000 to more than 2% in the first case, and from 15 in 100,000 to more than 15 in 10,000 in the second case. When the prior probability is lower, so is the posterior probability.</p>
<p>Some students who are inexperienced with Bayesian reasoning are surprised at how small the posterior probability is after a positive test. Untrained people often expect the probability to be closer to 85%, the sensitivity of the test. I have found that a good way to explain these results to people who have trouble with it is to ask them to imagine a population of 100,000 people. For part a, we would expect 200 have the disease. Of these, we expect about 85%, or 170 people, to test positive, and 15%, or only 30 people, to test negative. So the test identified most of the ill people. But now let’s consider the 99,800 people who do not have the disease. We expect only 8% of these to test positive, but this is 7984 people testing positive. We expect 92%, or 91,816 people, to test negative. Of those who test positive, 170 have the disease and 7,984 do not. So even though most ill people test positive and most well people test negative, because there are so many more people who do not have the disease, most of the ones testing positive actually do not have the disease.</p>
<p>A helpful way to visualize the role of the prior probability is to plot the posterior probability as a function of the prior probability (this was not required as part of the assignment). For prior probabilities near zero, a positive test increases the probability of the disease, but it remains very low because the positives are dominated by false positives. But once the prior probability reaches 10%, there is a better than even chance that someone testing positive has the disease; at a 20% prior probability, the posterior probability is over 70%.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="fu">seq</span>(<span class="fl">0.0001</span>, <span class="fl">0.2</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>posterior <span class="ot">=</span> <span class="fl">0.85</span><span class="sc">*</span>p<span class="sc">/</span>(<span class="fl">0.85</span><span class="sc">*</span>p <span class="sc">+</span> <span class="fl">0.08</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p))</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(p, posterior, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">xlab =</span> <span class="st">"Prior Probability"</span>, <span class="at">ylab =</span> <span class="st">"Posterior Probability"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ex_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<ol start="3" type="a">
<li>We will consider two different prior probabilities:</li>
</ol>
<p>High prevalence: P(Present) = 0.002 and P( Absent ) = 0.998<br>
Low prevalence: P(Present) = 0.00015 and P( Absent ) = 0.99985</p>
<p>To calculate EVSI, we do the following:</p>
<p>Calculate the expected loss if we do not do the test. To do this, we use the prior probability to calculate the expected loss if we visit and if we don’t. The minimum of these is the expected loss if we do not do the test.</p>
<p>EL[visit] = 100<em>p + 0</em>(1-p)<br>
EL[no visit] = 5<em>p + 1</em>(1-p)</p>
<p>Here, p is either 0.002 (part a) or 0.00015 (part b)</p>
<p>Calculate the expected loss if we do the test as follows:</p>
<ol type="a">
<li>Assume the test is positive. Using the posterior probability of disease, calculate the expected loss of visiting and not visiting. The minimum of these is the expected loss if the test is positive.</li>
<li>Assume the test is negative. Using the posterior probability of disease, calculate the expected loss of visiting and not visiting. The minimum of these is the expected loss if the test is negative.</li>
<li>Use the Law of Total Probability to find the probability of a positive test. (We already found this in Problems 1 and 2 - it’s the denominator of Bayes Rule.) Combine the results from a and b using the probability of disease as follows:<br>
E(L | test) = P(positive)E(L | positive)+P(negative)E(L | negative)</li>
</ol>
<p>Now, the EVSI is how much doing the test reduces our expected loss:</p>
<p>EVSI = E(L | no test) - E(L | test)</p>
<p>We will now apply these steps for the two base rates. The table below shows the results.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 44%">
<col style="width: 27%">
<col style="width: 27%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">High prevalence</th>
<th style="text-align: left;">Low prevalence</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Probability of positive test</td>
<td style="text-align: left;">0.08154</td>
<td style="text-align: left;">0.08012</td>
</tr>
<tr class="even">
<td style="text-align: left;">Posterior probability of disease given positive test</td>
<td style="text-align: left;">0.0208</td>
<td style="text-align: left;">0.00159</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Posterior probability of disease given negative test</td>
<td style="text-align: left;">0.00033</td>
<td style="text-align: left;">0.0000245</td>
</tr>
<tr class="even">
<td style="text-align: left;">Expected loss - no test</td>
<td style="text-align: left;">Visit: 0.2 No visit: 1.008</td>
<td style="text-align: left;">Visit: 0.015 No visit: 1.0006</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Expected loss if positive</td>
<td style="text-align: left;">Visit: 2.0849 No visit: 1.0834</td>
<td style="text-align: left;">Visit: 0.15915 No visit: 1.00637</td>
</tr>
<tr class="even">
<td style="text-align: left;">Expected loss if negative</td>
<td style="text-align: left;">Visit: 0.03266 No visit: 1.00131</td>
<td style="text-align: left;">Visit: 0.00245 No visit: 1.0001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Expected loss with test</td>
<td style="text-align: left;">0.11834</td>
<td style="text-align: left;">0.015</td>
</tr>
<tr class="even">
<td style="text-align: left;">Expected loss - no test</td>
<td style="text-align: left;">Visit: 0.2 No visit: 1.008</td>
<td style="text-align: left;">Visit: 0.015 No visit: 1.0006</td>
</tr>
<tr class="odd">
<td style="text-align: left;">EVSI</td>
<td style="text-align: left;">0.2-0.11834 = 0.08166</td>
<td style="text-align: left;">0.015-0.015 = 0</td>
</tr>
</tbody>
</table>
<p>In the high prevalence case, it is better to test and follow the test result. The EVSI is 0.08166; there is 0.08166 lower loss from testing than from not testing. In the low prevalence case, however, the optimal decision is to visit no matter what the result of the test, because the posterior probability is so low even if the test is positive. Therefore, the expected loss is the same for doing or not doing the test because we ignore the test result and visit anyway. Therefore, the EVSI is zero in the low prevalence case.</p>
<ol start="4" type="a">
<li>Prior Probability: P(Disease present) = p and P( Disease absent ) = 1- p</li>
</ol>
<p>If we do not do the test, we cannot use the test result, so we have two choices: visit or do not visit. The expected loss of visiting is: E(L|V) = 100p + 0(1-p) = 100p<br>
The expected loss of not visiting (lose 5 if ill, 1 if not ill): E(L|N) = 5p + (1-p)</p>
<p>Now consider the strategy of doing the test and visiting if the test is negative. We get the following losses</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">Patient status</th>
<th style="text-align: left;">Test result</th>
<th style="text-align: left;">Action</th>
<th style="text-align: left;">Loss (L)</th>
<th style="text-align: left;">Probability</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">No disease</td>
<td style="text-align: left;">Negative</td>
<td style="text-align: left;">visit</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">(1-p)*0.92</td>
</tr>
<tr class="even">
<td style="text-align: left;">No disease</td>
<td style="text-align: left;">Positive</td>
<td style="text-align: left;">no visit</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">(1-p)*0.08</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Disease</td>
<td style="text-align: left;">Negative</td>
<td style="text-align: left;">visit</td>
<td style="text-align: left;">100</td>
<td style="text-align: left;">p*0.15</td>
</tr>
<tr class="even">
<td style="text-align: left;">Disease</td>
<td style="text-align: left;">Positive</td>
<td style="text-align: left;">no visit</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">p*0.85</td>
</tr>
</tbody>
</table>
<p>The total expected loss of this strategy is:<br>
E(L|T) = 0 + 1<em>0.08</em>(1-p) + 100<em>0.15</em>p + 5*0.85p = 0.08 + 19.17p</p>
<p>Find strategy regions. With a little algebra, we can find where the lines intersect and then find the regions of optimality. These are:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 28%">
<col style="width: 71%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Range</th>
<th style="text-align: left;">Policy</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(0 \le p &lt; 0.00099\)</span></td>
<td style="text-align: left;">Optimal policy is visit regardless of test</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(0.00099 &lt; p &lt; 0.0606\)</span></td>
<td style="text-align: left;">Optimal policy is to do the test and visit if negative</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(0.0606 &lt; p \le 1\)</span></td>
<td style="text-align: left;">Optimal policy is to stay home regardless of test</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<p>The graph below shows the plots of expected loss for the three policies. I show results only for probabilities up to 0.1 in order to have a better view of the results for small probabilities.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="fu">seq</span>(<span class="fl">0.0001</span>, <span class="fl">0.1</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>ELV <span class="ot">=</span> <span class="dv">100</span><span class="sc">*</span>p</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>ELN <span class="ot">=</span> <span class="dv">5</span><span class="sc">*</span>p <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span>p)</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>ELT <span class="ot">=</span> <span class="fl">0.08</span> <span class="sc">+</span> <span class="fl">19.17</span><span class="sc">*</span>p</span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(p, ELV, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">xlab =</span> <span class="st">"Prior Probability"</span>, <span class="at">ylab =</span> <span class="st">"Expected Loss"</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(p, ELN, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(p, ELT, <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Visit"</span>, <span class="st">"No Visit"</span>, <span class="st">"Test and Visit if Negative"</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"green"</span>), <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ex_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>Therefore, in the range of values 0.00099 &lt; p &lt; 0.0606, doing the test has lower expected loss than either just visiting or just staying home. For the high prevalence situation, the prior probability of 0.002 is larger than 0.00099 and lower than 0.0606, so it is optimal to take the test and follow the result. For the low prevalence situation, the prior probability of 0.00015 is below 0.00099, and it is optimal just to visit without considering the test. That is, in very low prevalence situations, there is no point in doing the test, because even if it is positive, the posterior probability would still be low enough that it is optimal to visit. On the other hand, if Marjorie is experiencing symptoms or knows she has been exposed, that would increase the probability of having the disease. Even in a low prevalence situation, if symptoms or exposure increase the prior probability to above 0.00099 but below 0.0606, then she should take the test and follow the result. If symptoms or exposure increase the prior probability to above 0.0606, then she should not bother with the test and just stay home.</p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.73 (True/False Variance)</strong></span> &nbsp;</p>
<ol type="a">
<li>If the sample covariance between two variables is one, then there must be a strong linear relationship between the variables</li>
<li>If the sample covariance between two variables is zero, then the variables are independent.</li>
<li>If <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are independent random variables, then <span class="math inline">\(Var(2X-Y)= 2 Var(X)-Var(Y)\)</span>.</li>
<li>The sample variance is unaffected by outlying observations.</li>
<li>Suppose that a random variable <span class="math inline">\(X\)</span> can take the values <span class="math inline">\(\{0,1,2\}\)</span> all with equal probability. Then the expected and variance of <span class="math inline">\(X\)</span> are both<span class="math inline">\(1\)</span>.</li>
<li>The maximum correlation is <span class="math inline">\(1\)</span> and the minimum is <span class="math inline">\(0\)</span>.</li>
<li>For independent random variables <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>, we have <span class="math inline">\(var(X-Y)=var(X)-var(Y)\)</span>.</li>
<li>If the correlation between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> is zero then the standard deviation of <span class="math inline">\(X+Y\)</span> is the square root of the sum of the standard deviations of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>.</li>
<li>It is always true that the standard deviation is less than the variance</li>
<li>If the correlation between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> is <span class="math inline">\(r = - 0.81\)</span> and if the standard deviations are <span class="math inline">\(s_X = 20\)</span> and <span class="math inline">\(s_Y = 25\)</span>, respectively, then the covariance is <span class="math inline">\(Cov (X, Y) = - 401\)</span>.</li>
<li>If we drop the largest observation from a sample, then the sample mean and variance will both be reduced.</li>
<li>Suppose <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are independent random variables and <span class="math inline">\(Var(X) = 6\)</span> and <span class="math inline">\(Var(Y) = 6\)</span>. Then <span class="math inline">\(Var(X+Y) = Var(2X)\)</span>.</li>
<li>Let investment <span class="math inline">\(X\)</span> have mean return 5% and a standard deviation of 5%and investment <span class="math inline">\(Y\)</span> have a mean return of 10% with a standard deviation of 6%. Suppose that the correlation between returns is zero. Then I can find a portfolio with higher mean and lower variance then <span class="math inline">\(X\)</span>.</li>
</ol>
<p><strong>Solution</strong>:</p>
<ol type="a">
<li>False. <span class="math inline">\(Cov(X,Y) = Corr(X,Y) \sqrt{Var(X)*Var(Y)}\)</span>, so knowing <span class="math inline">\(Cov(X,Y) = 1\)</span> doesn’t inform you about the correlation.</li>
<li>False. This is only a special case for normal distribution.</li>
<li>False. <span class="math inline">\(Var(2X-Y) = 4Var(X) + Var(Y)\)</span></li>
<li>False. We have the following formula for the sample variance: <span class="math display">\[\begin{aligned}\hat{\sigma}^2 = \frac{1}{n-1}\sum_{i=1}^n (x_i-\bar{x})^2\end{aligned}\]</span>If <span class="math inline">\(x_i\)</span> is large relative to <span class="math inline">\(\bar{x}\)</span> then it has an undue influence.</li>
<li>False <span class="math display">\[E[X] = \frac{1}{3}*0+\frac{1}{3}*1+\frac{1}{3}*2=1\]</span><span class="math display">\[Var[X] = \frac{1}{3}(0-1)^2+\frac{1}{3}(1-1)^2+\frac{1}{3}(2-1)^2\]</span><span class="math display">\[=\frac{1}{3}+0+\frac{1}{3}=\frac{2}{3}\]</span></li>
<li>False, the maximum is 1 and the minimum in -1.</li>
<li>False. <span class="math inline">\(Var(X-Y) = Var(X) + Var(Y)\)</span></li>
<li>False. Using the plug in rule, the standard deviation of <span class="math inline">\(X + Y\)</span> is the square root of the sum of the variances of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span></li>
<li>False. <span class="math inline">\(s_X \geq Var(X)\)</span> if the <span class="math inline">\(Var (X ) \leq 1\)</span></li>
<li>False. Using the formula relating covariance and correlation, namely<span class="math inline">\(Cov( X, Y ) = r s_X s_Y\)</span> gives<span class="math inline">\(Cov ( X,Y) = - 0.81 \times 20 \times 25 = - 405.\)</span></li>
<li>False. For example, <span class="math inline">\(100, 101, 102\)</span> has mean <span class="math inline">\(101\)</span> and variance <span class="math inline">\(0.333\)</span>,but <span class="math inline">\(100, 101\)</span> has mean <span class="math inline">\(100.5\)</span> and variance <span class="math inline">\(0.5\)</span></li>
<li>False. First, <span class="math inline">\(Var(X+Y)=Var(X)+Var(Y)\)</span> (as <span class="math inline">\(Cov(X,Y)=0)\)</span> and so <span class="math inline">\(Var(X+Y)=2 Var(X)\)</span>. Secondly <span class="math inline">\(Var(2X) = 4 Var(X)\)</span></li>
<li>True. For example, consider the portfolio <span class="math inline">\(P=  0.5 X + 0.5 Y\)</span>. This has expected return <span class="math inline">\(\mu_P = 0.5\times 5 + 0.5 \times 0.10 = 7.5 \%\)</span>. As the correlation is zero, its variance is given by <span class="math inline">\(\sigma_P^2 =0.5^2 \times 0.0025 + 0.5^2  0.0036 = 0.001525 &lt; Var(X)\)</span></li>
</ol>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.74 (True/False Expectation)</strong></span> &nbsp;</p>
<ol type="a">
<li>LeBron James makes <span class="math inline">\(85\)</span>% of his free throw attempts and <span class="math inline">\(50\)</span>% of his regular shots from the field (field goals). Suppose that each shot is independent of the others. He takes <span class="math inline">\(20\)</span> field goals and <span class="math inline">\(10\)</span> free throws in a typical game. He gets one point for each free throw and two points for each field goal assuming no 3-point shots. The number of points he expects to score in a game is 28.5.</li>
<li>Suppose that you have a one in a hundred chance of hitting the jackpot on a slot machine. If you play the machine <span class="math inline">\(100\)</span> times then you are certain to win.</li>
<li>The expected value of the sample mean is the population mean, that is <span class="math inline">\(E \left ( \bar{X} \right ) = \mu\)</span>.</li>
<li>The expectation of <span class="math inline">\(X\)</span> minus <span class="math inline">\(2Y\)</span> is just the expectation of <span class="math inline">\(X\)</span> minus twice the expectation of <span class="math inline">\(Y\)</span>, that is <span class="math inline">\(E (X-2Y)= E(X) - 2E (Y)\)</span>.</li>
<li>A firm believes it has a 50-50 chance of winning a $80,000 contract if it spends $5,000 on a proposal. If the firm spends twice this amount,it feels its chances of winning improve to 60%. If the firm wants to maximize its expected value then it should spend $10,000 to try and gain the contract.</li>
<li><span class="math inline">\(E(X+Y)=E(X)+E(Y)\)</span> only if the random variables <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are independent.</li>
</ol>
<p><strong>Solution</strong>:</p>
<ol type="a">
<li>True.<span class="math display">\[E(points) = 2E(\# FG made) + 1E(\#FT made) = 2 \times 20 \times 0.5+1 \times 10 \times 0.85 = 28.5\]</span>This holds even if FG and FT are dependent</li>
<li>False. The expected waiting time until you hit the jackpot is 100 times,but since each outcome of the game is independent of all previous outcomes, there is no guarantee about the number of plays until a jackpot it hit</li>
<li>True. The expected value of the sample does equal the true value</li>
<li>True. The plug-in rule states that <span class="math inline">\(E(aX+bY)=aE(X)+bE(Y)\)</span>. Plug in <span class="math inline">\(A=1\)</span>and <span class="math inline">\(B =-2\)</span>. Hence <span class="math inline">\(E(X-2Y)=E(X)+E(-2Y)=E(X)-2E(Y)\)</span></li>
<li>True. <span class="math inline">\(E(spend \$5k) = 0.5\cdot\$80000 - 5000 = 35000\)</span>. <span class="math inline">\(E(spend \$10k) = 0.6\cdot 80000 - 10000 = 38000\)</span></li>
<li>False. By the plug-in rule, this relation holds irrespective of whether X and Y are.</li>
</ol>
</div>
</section>
<section id="bayesian-parameter-learning" class="level2" data-number="27.4">
<h2 data-number="27.4" class="anchored" data-anchor-id="bayesian-parameter-learning"><span class="header-section-number">27.4</span> Bayesian Parameter Learning</h2>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.75 (Beta-Binomial for Allais gambles)</strong></span> We’ve collected data on people’s preferences in the two Allais gambles from. For this problem, we will assume that responses are independent and identically distributed, and the probability is <span class="math inline">\(\theta\)</span> that a person chooses both B in the first gamble and C in the second gamble.</p>
<ol type="a">
<li>Assume that the prior distribution for <span class="math inline">\(\theta\)</span> is Beta(1, 3). Find the prior mean and standard deviation for <span class="math inline">\(\theta\)</span>. Find a 95% symmetric tail area credible interval for the prior probability that a person would choose B and C. Do you think this is a reasonable prior distribution to use for this problem? Why or why not?</li>
<li>In 2009, 19 out of 47 respondents chose B and C. Find the posterior distribution for the probability <span class="math inline">\(\theta\)</span> that a person in this population would choose B and C.</li>
<li>Find the posterior mean and standard deviation. Find a 95% symmetric tail area credible interval for <span class="math inline">\(\theta\)</span>.</li>
<li>Make a triplot of the prior distribution, normalized likelihood, and posterior distribution.</li>
<li>Comment on your results.</li>
</ol>
<p><strong>Solution</strong>:</p>
<p>Part a. It is convenient to use a prior distribution in the Beta family because it is conjugate to the Binomial likelihood function, which simplifies Bayesian updating. A plot of the prior density function is shown below.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dbeta</span>(x,<span class="dv">1</span>,<span class="dv">3</span>),<span class="dv">0</span>,<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ex_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>The prior distribution has mean a/(a+b) = 0.25 and standard deviation <span class="math display">\[
\sqrt{\dfrac{\alpha\beta}{(\alpha+\beta)^2(\alpha+\beta+1)}} = 0.194.
\]</span> An expected value of 0.25 would be reasonable if we believed that people were choosing randomly among the four options A&amp;C, B&amp;C, A&amp;D, and B&amp;D. In fact, a Beta(1,3) distribution is the marginal distribution we would obtain if we placed a uniform distribution on all probability vectors <span class="math inline">\((p_1, p_2, p_3, p_4)\)</span> on the four categories (i.e.&nbsp;a uniform distribution on four non-negative numbers that sum to 1). In other words, this is the prior distribution we might assign if all we knew was that there were four possible responses, and knew nothing about the relative likelihoods of the four responses. However, we actually do know something about the relative probabilities of the categories. According to the research literature, people choose B&amp;C more often than 25% of the time. The center of the prior distribution does not reflect this knowledge. But the prior distribution does show a very high degree of uncertainty about the probability. A 95% symmetric tail area credible interval for the prior distribution of <span class="math inline">\(\Theta\)</span> is [0.008, 0.708]. The virtual count is small in relation to the sample size, so the data will have a large impact on the posterior distribution relative to the prior. Therefore, we won’t go too far wrong using this prior distribution, even though we do have knowledge that suggests the prior mean is likely to be higher than 0.25.</p>
<p>Part b. We will use the Binomial/Beta conjugate pair. The prior distribution is a member of the conjugate Beta(a, b) family, with a=1 and b=3. Therefore, the posterior distribution is a Beta(a<em>, b</em>) distribution, with a<em>=a+x= 1+19 = 20, and b</em>=b+n-x = 3+28 = 31. The posterior distribution is shown below.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dbeta</span>(x,<span class="dv">20</span>,<span class="dv">31</span>),<span class="dv">0</span>,<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ex_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>Part c.&nbsp;The posterior mean is a<em>/(a</em>+b*) = 20/51 = 0.392. The posterior standard deviation is <span class="math display">\[
\sqrt{\dfrac{a^*b^*}{(a^*+b^*)^2(a^*+b^*+1)}} = 0.077.
\]</span> A 95% symmetric tail area credible interval for the posterior distribution of <span class="math inline">\(\Theta\)</span> is [0.248, 0.536].</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qbeta</span>(<span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>),<span class="dv">20</span>,<span class="dv">31</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.26 0.53</code></pre>
</div>
</div>
<p>Part d.&nbsp;The triplot is shown below.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dbeta</span>(x,<span class="dv">1</span>,<span class="dv">3</span>),<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">ylab=</span><span class="st">"Density"</span>,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">6</span>))</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dbeta</span>(x,<span class="dv">20</span>,<span class="dv">31</span>),<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dbeta</span>(x,<span class="dv">19</span>,<span class="dv">47-19</span>),<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">add=</span><span class="cn">TRUE</span>)       <span class="co"># Normalized Likelihood is Beta(x,n-x)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ex_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>The triplot shows the prior, normalized likelihood, and posterior distributions. The normalized likelihood is a Beta(19,47-19) density function. The posterior distribution is focused on slightly smaller values and is slightly narrower than the normalized likelihood. This is because the prior mean is smaller than the sample mean, and the posterior distribution has slightly more information than the prior distribution.</p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.76 (Poisson for Car Counts)</strong></span> Times were recorded at which vehicles passed a fixed point on the M1 motorway in Bedfordshire, England on March 23, 1985.2 The total time was broken into 21 intervals of length 15 seconds. The number of cars passing in each interval was counted. The result was:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>cnt <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This can be summarized in the following table, that shows 3 intervals with zero cars, 5 intervals with 1 car, 7 intervals with 2 cars, 3 intervals with 3 cars and 3 intervals with 4 cars.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(cnt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## cnt
## 0 1 2 3 4 
## 3 5 7 3 3</code></pre>
</div>
</div>
<ol type="a">
<li>Do you think a Poisson distribution provides a good model for the count data? Justify your answer.</li>
<li>Assume that <span class="math inline">\(\Lambda\)</span>, the rate parameter of the Poisson distribution for counts (and the inverse of the mean of the exponential distribution for inter arrival times), has a discrete uniform prior distribution on 20 equally spaced values between <span class="math inline">\((0.2, 0.4,\ldots 3.8, 4.0)\)</span> cars per 15-second interval. Find the posterior distribution of <span class="math inline">\(\Lambda\)</span>.</li>
<li>Find the posterior mean and standard deviation of <span class="math inline">\(\Lambda\)</span>.</li>
<li>Discuss what your results mean in terms of traffic on this motorway.</li>
</ol>
<p><strong>Solution</strong>:</p>
<ol type="a">
<li>A Poisson distribution is a good model to consider for the arrival counts because:
<ul>
<li>The data consist of counts of discrete events.</li>
<li>It seems reasonable that the events would be independent.</li>
<li>It seems reasonable that the rate of occurrence would remain constant over the 4+ minutes that the sample was taken.</li>
</ul></li>
</ol>
<p>These are reasons to consider a Poisson distribution, but we still need to investigate how well a Poisson distribution fits the observations. We will do this by comparing the sample frequencies with Poisson probability mass function. To do this, we need to estimate the mean of the distribution. We calculate the sample mean by summing these observations (40 total cars passing) and dividing by the number of intervals (21), to obtain an estimated arrival rate of about 1.9 cars per 15 second time interval.</p>
<p>Next, we use the Poisson probability mass function <span class="math inline">\(f(x|\Lambda=1.9) = e^{-1.9} (1.9)^x / x!\)</span> to estimate the probability of each number of cars in a single interval, and multiply by 21 to find the expected number of times each value occurs (Note: for the 5 or more entry, we use <span class="math inline">\(1-F(4|\Lambda=1.9)\)</span>, or 1 minus the Poisson cdf at 4. The probability of more than 5 cars in 15 seconds is very small.) The expected counts are:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">cars=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">5</span>,<span class="at">sample=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">0</span>),<span class="at">expected=</span><span class="fu">c</span>(<span class="dv">21</span><span class="sc">*</span><span class="fu">dpois</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>,<span class="fl">1.9</span>),<span class="fu">ppois</span>(<span class="dv">4</span>,<span class="fl">1.9</span>)))</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##   cars sample expected
## 1    0      3     3.14
## 2    1      5     5.97
## 3    2      7     5.67
## 4    3      3     3.59
## 5    4      3     1.71
## 6    5      0     0.96</code></pre>
</div>
</div>
<p>The values in this table seem to show fairly good agreement. We can do a visual inspection by drawing a bar chart, shown below. The bar chart shows good agreement between the empirical and the Poisson probabilities.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="at">height =</span> <span class="fu">t</span>(<span class="fu">as.matrix</span>(d[,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>])),<span class="at">beside=</span><span class="cn">TRUE</span>,<span class="at">legend=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ex_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>We can also perform a Pearson chi-square test (this is not required). The test statistic is calculated as: <span class="math display">\[
\chi^2 =\sum_i (Y_i -E_i)^2/E_i
\]</span> where <span class="math inline">\(Y_i\)</span> is the observed count for i cars passing, and <span class="math inline">\(E_i\)</span> is the expected number of instances of i cars passing in a sample of size 21. The chi-square test should not be applied when counts are very small. A common (and conservative) rule of thumb is to avoid using the chi-square test if any cell has an expected count less than 5. Other less conservative rules have been proposed.4 We will combine the last two categories to increase the expected count to 2.37. To find the expected counts in this last category, we assign it probability 1 minus the cdf at x=3, and multiply by 21. The observed and expected counts are:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(((d<span class="sc">$</span>sample<span class="sc">-</span>d<span class="sc">$</span>expected)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>d<span class="sc">$</span>expected)[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]) <span class="sc">+</span> (<span class="dv">3</span><span class="fl">-2.65</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fl">2.65</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.62</code></pre>
</div>
</div>
<p>Next, we find the degrees of freedom, n - p -1, where n is the number of categories and p is the number of parameters estimated. We have 5 categories, and we estimated the mean of the Poisson distribution, so the degrees of freedom are 5 - 1 - 1, or 3. Therefore, we compare our test statistic 0.616 against the critical value of the chi-square distribution with 3 degrees of freedom. The 95th percentile for the chi- square distribution with 3 degrees of freedom is 7.8.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qchisq</span>(<span class="fl">0.95</span>,<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 7.8</code></pre>
</div>
</div>
<p>Some students have tried a Q-Q plot of the Poisson quantiles against the data quantiles. Because there are only 4 distinct values in the sample, the plot shows most of the dots on top of each other. Comparing empirical and theoretical frequencies to is much more informative for discrete distributions with very few values.</p>
<p>We can also compare the sample mean and sample variance of the observations, recalling that the mean and variance of the Poisson distribution are the same. The sample mean of the observations is 1.90 and the sample variance is 1.59. The standard deviation of the sample mean is approximately equal to the sample standard deviation divided by the square root of the sample size, or <span class="math inline">\(\sqrt{1.59/21} = 0.275\)</span>. Therefore, the CI is</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fl">1.90</span> <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">*</span><span class="fl">0.275</span><span class="sc">*</span><span class="fu">qt</span>(<span class="fl">0.975</span>,<span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 1.3 2.5</code></pre>
</div>
</div>
<p>The observations seem consistent with the hypothesis that the mean and standard deviation are equal.</p>
<p>You did not need to do everything described in this solution. If you gave a thoughtful argument for whether the Poisson distribution was a good model, and if you used the data in a reasonable way to evaluate the fit of the distribution, you would receive credit for this problem.</p>
<ol start="2" type="a">
<li>To find the posterior distribution, we calculate the Poisson likelihood at each of the 20 lambda values, and multiply by the prior probability of 1/20. Then we divide each of these values by their sum. The formula is: <span class="math display">\[
p(\lambda|X) = \frac{f(X|\lambda)g(\lambda)}{\sum_{i=1}^{20} f(X|\lambda_i)g(\lambda_i)}
\]</span> We use the constant prior of <span class="math inline">\(g(\lambda) = 1/20\)</span> factors out of both the numerator and denominator, so it is unnecessary to include it. In fact, when the prior distribution is uniform, the posterior distribution is the same as the normalized likelihood.</li>
</ol>
<p>The posterior pmf is shown in the plot below.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">4</span>,<span class="fl">0.2</span>)</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>likelihood<span class="ot">=</span><span class="cf">function</span>(lambda) <span class="fu">prod</span>(<span class="fu">dpois</span>(cnt,lambda))</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>l <span class="ot">=</span> <span class="fu">sapply</span>(lambda,likelihood)</span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>posterior <span class="ot">=</span> l<span class="sc">/</span><span class="fu">sum</span>(l)</span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(posterior,<span class="at">names.arg=</span>lambda,<span class="at">xlab=</span><span class="st">"lambda"</span>,<span class="at">ylab=</span><span class="st">"posterior probability"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ex_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<ol start="3" type="a">
<li></li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">=</span> <span class="fu">sum</span>(posterior<span class="sc">*</span>lambda)</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">sum</span>(posterior<span class="sc">*</span>(lambda<span class="sc">-</span>m)<span class="sc">^</span><span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.3</code></pre>
</div>
</div>
<ol start="4" type="a">
<li>From this analysis, we see that a Poisson distribution provides a good model for counts of cars passing by this point on the roadway. The rate is approximately 2 cars per 15 seconds. There is uncertainty about this rate. There is a 95% chance the rate is less than or equal to 2.4, and there is about a 98% probability that the rate lies between 1.4 and 2.6 cars per second. If we gathered more data, we would gain more information about the rate, which would narrow the range of uncertainty.</li>
</ol>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.77 (Car Count Part 2)</strong></span> This problem continues analysis of the automobile traffic data. As before, assume that counts of cars per 15-second interval are independent and identically distributed Poisson random variables with unknown mean <span class="math inline">\(\Lambda\)</span>.</p>
<ol type="a">
<li>Assume that <span class="math inline">\(\Lambda\)</span>, the rate parameter of the Poisson distribution for counts, has a continuous gamma prior distribution for <span class="math inline">\(\Lambda\)</span> with shape 1 and scale 10e6. (The gamma distribution with shape 1 tends to a uniform distribution as the scale tends to <span class="math inline">\(\infty\)</span>, so this prior distribution is “almost” uniform.) Find the posterior distribution of <span class="math inline">\(\Lambda\)</span>. State the distribution type and hyperparameters.</li>
<li>Find the posterior mean and standard deviation of <span class="math inline">\(\Lambda\)</span>. Compare your results to Part I. Discuss.</li>
<li>Find a 95% symmetric tail area posterior credible interval for <span class="math inline">\(\Lambda\)</span>. Find a 95% symmetric tail area posterior credible interval for <span class="math inline">\(\theta\)</span>, the mean time between vehicle arrivals.</li>
<li>Find the predictive distribution for the number of cars passing in the next minute. Name the family of distributions and the parameters of the predictive distribution. Find the mean and standard deviation of the predictive distribution. Find the probability that more than 10 cars will pass in the next minute. (Hint: one minute is four 15-second time intervals.)</li>
</ol>
<p><strong>Solution</strong>:</p>
<ol type="a">
<li>We observed 40 cars passing in <span class="math inline">\(n\)</span>=21 15-second intervals.</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(cnt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 40</code></pre>
</div>
</div>
<p>The posterior distribution is a gamma distribution with shape 1 + 40 = 41</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">+</span><span class="fu">sum</span>(cnt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 41</code></pre>
</div>
</div>
<p>and scale</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="fu">length</span>(cnt)</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">/</span>(<span class="fl">1e-6</span> <span class="sc">+</span> n)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.048</code></pre>
</div>
</div>
<p>The posterior distribution is <span class="math display">\[
\Lambda|X \sim \text{Gamma}(41,0.04761905)
\]</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dgamma</span>(x,<span class="at">shape=</span><span class="dv">41</span>,<span class="at">scale=</span><span class="fl">0.04761905</span>),<span class="at">from=</span><span class="dv">0</span>,<span class="at">to=</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ex_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<ol start="2" type="a">
<li>The posterior mean is 41/21=1.952, and the posterior standard deviation is <span class="math inline">\(\sqrt{41}/21 = 0.304\)</span>. Let’s compare</li>
</ol>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th>mean</th>
<th>sd</th>
<th>mode</th>
<th>median</th>
<th>95% CI</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Discretized</td>
<td>1.95</td>
<td>0.305</td>
<td>2</td>
<td>2</td>
<td>[1.4, 2.6]</td>
</tr>
<tr class="even">
<td>Continuous</td>
<td>1.95</td>
<td>0.305</td>
<td>1.9</td>
<td>1.94</td>
<td>[1.40, 2.59]</td>
</tr>
</tbody>
</table>
<p>These values are almost identical. The slight differences in the median and mode are clearly artifacts of discretization. The discretized analysis gives a good approximation to the continuous analysis.</p>
<ol start="3" type="a">
<li>The 95% symmetric tail area posterior credible interval for <span class="math inline">\(\Lambda\)</span> is</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qgamma</span>(<span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>),<span class="at">shape=</span><span class="dv">41</span>,<span class="at">scale=</span><span class="fl">0.04761905</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 1.4 2.6</code></pre>
</div>
</div>
<p>and for <span class="math inline">\(\Theta\)</span> is</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">/</span><span class="fu">qgamma</span>(<span class="fu">c</span>(<span class="fl">0.975</span>,<span class="fl">0.025</span>),<span class="at">shape=</span><span class="dv">41</span>,<span class="at">scale=</span><span class="fl">0.04761905</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.39 0.71</code></pre>
</div>
</div>
<ol start="4" type="a">
<li>The Poisson / Gamma predictive distribution is a negative binomial distribution. For this problem, we predict the number of cars in the next four time periods (1 minute is four 15-second blocks). The predictive distribution is negative binomial with the parameters:</li>
</ol>
<ul>
<li>size a= 41</li>
<li>prob p = 1/(1+4b) = 1/(1+4/21) = 0.84</li>
</ul>
<p>The mean is <span class="math inline">\(nab = 4\cdot 41\cdot 0.84 = 7.81\)</span> and standard deviation of the predictive distribution is <span class="math display">\[
\sqrt{na \dfrac{1-p}{p^2}} = \sqrt{4\cdot 41 \cdot \dfrac{1-0.84}{0.84^2}} = 2.83
\]</span> The probabilities, as computed by the R <code>dnbinom</code> function, are shown in the table. Results from the Poisson probability mass function with mean <span class="math inline">\(4ab = 7.81\)</span> are shown for comparison.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">=</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">20</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="fu">dnbinom</span>(k,<span class="at">size=</span><span class="dv">41</span>,<span class="at">prob=</span><span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="dv">4</span><span class="sc">/</span><span class="dv">21</span>))</span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> p<span class="sc">/</span><span class="fu">sum</span>(p)</span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="fu">round</span>(p,<span class="dv">3</span>)</span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="fu">c</span>(p,<span class="dv">1</span><span class="sc">-</span><span class="fu">sum</span>(p))</span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a>poisson <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">dpois</span>(k,<span class="fl">7.81</span>),<span class="dv">3</span>)</span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a>poisson <span class="ot">=</span> <span class="fu">c</span>(poisson,<span class="dv">1</span><span class="sc">-</span><span class="fu">sum</span>(poisson))</span>
<span id="cb141-8"><a href="#cb141-8" aria-hidden="true" tabindex="-1"></a>d <span class="ot">=</span> <span class="fu">cbind</span>(k,p,poisson)</span>
<span id="cb141-9"><a href="#cb141-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##        k      p poisson
##  [1,]  0  0.001   0.000
##  [2,]  1  0.005   0.003
##  [3,]  2  0.017   0.012
##  [4,]  3  0.040   0.032
##  [5,]  4  0.070   0.063
##  [6,]  5  0.101   0.098
##  [7,]  6  0.124   0.128
##  [8,]  7  0.133   0.143
##  [9,]  8  0.127   0.139
## [10,]  9  0.111   0.121
## [11,] 10  0.089   0.094
## [12,] 11  0.066   0.067
## [13,] 12  0.046   0.044
## [14,] 13  0.030   0.026
## [15,] 14  0.018   0.015
## [16,] 15  0.011   0.008
## [17,] 16  0.006   0.004
## [18,] 17  0.003   0.002
## [19,] 18  0.002   0.001
## [20,] 19  0.001   0.000
## [21,] 20  0.000   0.000
## [22,]  0 -0.001   0.000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">t</span>(d[,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]),<span class="at">beside=</span><span class="cn">TRUE</span>,<span class="at">names.arg=</span>d[,<span class="dv">1</span>],<span class="at">xlab=</span><span class="st">"k"</span>,<span class="at">ylab=</span><span class="st">"probability"</span>)</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>,<span class="fu">c</span>(<span class="st">"negative binomial"</span>,<span class="st">"poisson"</span>),<span class="at">fill=</span><span class="fu">c</span>(<span class="st">"black"</span>,<span class="st">"white"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ex_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>The difference between the Bayesian predictive distribution and the Poisson distribution using a point estimate of the rate is even more pronounced if we predict for the next 21 time periods (5 1/4 minutes). This was not required, but is interesting to examine. Again, the distribution is negative binomial with: size <span class="math inline">\(a = 41\)</span>, and probability <span class="math inline">\(p = 1/(1 + 21b) = 0.5\)</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">=</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">65</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="fu">dnbinom</span>(k,<span class="at">size=</span><span class="dv">41</span>,<span class="at">prob=</span><span class="fl">0.5</span>)</span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> p<span class="sc">/</span><span class="fu">sum</span>(p)</span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="fu">c</span>(p,<span class="dv">1</span><span class="sc">-</span><span class="fu">sum</span>(p))</span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>poisson <span class="ot">=</span> <span class="fu">dpois</span>(k,<span class="dv">21</span><span class="sc">*</span><span class="dv">41</span><span class="sc">/</span><span class="dv">21</span>)</span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a>poisson <span class="ot">=</span> <span class="fu">c</span>(poisson,<span class="dv">1</span><span class="sc">-</span><span class="fu">sum</span>(poisson))</span>
<span id="cb144-7"><a href="#cb144-7" aria-hidden="true" tabindex="-1"></a>d <span class="ot">=</span> <span class="fu">cbind</span>(k,p,poisson)</span>
<span id="cb144-8"><a href="#cb144-8" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">t</span>(d[,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]),<span class="at">beside=</span><span class="cn">TRUE</span>,<span class="at">names.arg=</span>d[,<span class="dv">1</span>],<span class="at">xlab=</span><span class="st">"k"</span>,<span class="at">ylab=</span><span class="st">"probability"</span>)</span>
<span id="cb144-9"><a href="#cb144-9" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>,<span class="fu">c</span>(<span class="st">"negative binomial"</span>,<span class="st">"poisson"</span>),<span class="at">fill=</span><span class="fu">c</span>(<span class="st">"black"</span>,<span class="st">"white"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ex_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>To summarize, the predictive distribution is negative binomial with size <span class="math inline">\(a = 41\)</span>, and probability <span class="math inline">\(p = 1/(1 + nb)\)</span> where <span class="math inline">\(n\)</span> is the number of periods into the future we are predicting. The uncertainty in <span class="math inline">\(\Lambda\)</span> makes the predictive distribution more spread out than the Poisson distribution with the same mean. When n=1, the Poisson and negative binomial probabilities are very similar. The differences become more pronounced as we try to predict further into the future.</p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.78 (Lung disease)</strong></span> Chronic obstructive pulmonary disease (COPD) is a common lung disease characterized by difficulty in breathing. A substantial proportion of COPD patients admitted to emergency medical facilities are released as outpatients. A randomized, double-blind, placebo-controlled study examined the incidence of relapse in COPD patients released as outpatients as a function of whether the patients received treatment with corticosteroids. A total of 147 patients were enrolled in the study and were randomly assigned to treatment or placebo group on discharge from an emergency facility. Seven patients were lost from the study prior to follow-up. For the remaining 140 patients, the table below summarizes the primary outcome of the study, relapse within 30 days of discharge.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Relapse</th>
<th style="text-align: left;">No Relapse</th>
<th style="text-align: left;">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Treatment</td>
<td style="text-align: left;">19</td>
<td style="text-align: left;">51</td>
<td style="text-align: left;">70</td>
</tr>
<tr class="even">
<td style="text-align: left;">Placebo</td>
<td style="text-align: left;">30</td>
<td style="text-align: left;">40</td>
<td style="text-align: left;">70</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Total</td>
<td style="text-align: left;">49</td>
<td style="text-align: left;">91</td>
<td style="text-align: left;">140</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<ol type="a">
<li>Let <span class="math inline">\(Y_1\)</span> and <span class="math inline">\(Y_2\)</span> be the number of patients who relapse in the treatment and placebo groups, respectively. Assume <span class="math inline">\(Y_1\)</span> and <span class="math inline">\(Y_2\)</span> are independent Binomial(70,<span class="math inline">\(\theta_i\)</span> ) distributions, for <span class="math inline">\(i=1,2\)</span>. Assume <span class="math inline">\(\theta_1\)</span> and <span class="math inline">\(\theta_2\)</span> have independent Beta prior distributions with shape parameters 1/2 and 1/2 (this is the Jeffreys prior distribution). Find the joint posterior distribution for <span class="math inline">\(\theta_1\)</span> and <span class="math inline">\(\theta_2\)</span>. Name the distribution type and its hyperparameters.</li>
<li>Generate 5000 random pairs <span class="math inline">\((\theta_1, \theta_2)\)</span>, <span class="math inline">\(k=1,\ldots,5000\)</span> from the joint posterior distribution. Use this random sample to estimate the posterior probability that the rate of relapse is lower for treatment than for placebo. Discuss your results.</li>
</ol>
<p><strong>Solution</strong>:</p>
<ol type="a">
<li>The prior distribution for each condition is <span class="math inline">\(Beta(1/2,1/2)\)</span>. Therefore, the posterior distributions for <span class="math inline">\(\theta_1\)</span> and <span class="math inline">\(\theta_2\)</span> are Beta distributions with parameters and quantiles as shown below.</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Study results</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>k.trt<span class="ot">=</span><span class="dv">19</span>    <span class="co"># Number of relapses in treatment group</span></span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>n.trt<span class="ot">=</span><span class="dv">70</span>    <span class="co"># Number of patients in treatment group</span></span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>k.ctl<span class="ot">=</span><span class="dv">30</span>    <span class="co"># Number of relapses in control group</span></span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a>n.ctl<span class="ot">=</span><span class="dv">70</span>    <span class="co"># Number of patients in control group</span></span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Prior hyperparameters</span></span>
<span id="cb145-8"><a href="#cb145-8" aria-hidden="true" tabindex="-1"></a>alpha<span class="fl">.0</span> <span class="ot">=</span><span class="fl">0.5</span></span>
<span id="cb145-9"><a href="#cb145-9" aria-hidden="true" tabindex="-1"></a>beta<span class="fl">.0</span><span class="ot">=</span><span class="fl">0.5</span></span>
<span id="cb145-10"><a href="#cb145-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-11"><a href="#cb145-11" aria-hidden="true" tabindex="-1"></a><span class="co"># The joint posterior distribution is the product of two independent beta</span></span>
<span id="cb145-12"><a href="#cb145-12" aria-hidden="true" tabindex="-1"></a><span class="co"># distributions with posterior hyperparameters as shown below</span></span>
<span id="cb145-13"><a href="#cb145-13" aria-hidden="true" tabindex="-1"></a>alpha.trt<span class="ot">=</span>alpha<span class="fl">.0</span> <span class="sc">+</span> k.trt</span>
<span id="cb145-14"><a href="#cb145-14" aria-hidden="true" tabindex="-1"></a>beta.trt<span class="ot">=</span>beta<span class="fl">.0</span> <span class="sc">+</span> n.trt<span class="sc">-</span>k.trt</span>
<span id="cb145-15"><a href="#cb145-15" aria-hidden="true" tabindex="-1"></a>alpha.ctl<span class="ot">=</span>alpha<span class="fl">.0</span> <span class="sc">+</span> k.ctl</span>
<span id="cb145-16"><a href="#cb145-16" aria-hidden="true" tabindex="-1"></a>beta.ctl<span class="ot">=</span>beta<span class="fl">.0</span> <span class="sc">+</span> n.ctl<span class="sc">-</span>k.ctl</span>
<span id="cb145-17"><a href="#cb145-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-18"><a href="#cb145-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Posterior credible intervals</span></span>
<span id="cb145-19"><a href="#cb145-19" aria-hidden="true" tabindex="-1"></a>trt.intrv<span class="ot">=</span><span class="fu">qbeta</span>(<span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>),alpha.trt,beta.trt)</span>
<span id="cb145-20"><a href="#cb145-20" aria-hidden="true" tabindex="-1"></a>ctl.intrv<span class="ot">=</span><span class="fu">qbeta</span>(<span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>),alpha.ctl,beta.ctl)</span>
<span id="cb145-21"><a href="#cb145-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-22"><a href="#cb145-22" aria-hidden="true" tabindex="-1"></a>d <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">treatment=</span><span class="fu">c</span>(alpha.trt,beta.trt,trt.intrv), <span class="at">control=</span><span class="fu">c</span>(alpha.ctl,beta.ctl,ctl.intrv), <span class="at">row.names=</span><span class="fu">c</span>(<span class="st">"alpha"</span>,<span class="st">"beta"</span>,<span class="st">"2.5%"</span>,<span class="st">"97.5%"</span>))</span>
<span id="cb145-23"><a href="#cb145-23" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">t</span>(d))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">alpha</th>
<th style="text-align: right;">beta</th>
<th style="text-align: right;">2.5%</th>
<th style="text-align: right;">97.5%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">treatment</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">52</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">0.38</td>
</tr>
<tr class="even">
<td style="text-align: left;">control</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">0.32</td>
<td style="text-align: right;">0.55</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>It is important to remember that the joint density or mass function is a function of all the random variables. Because <span class="math inline">\(\theta_1\)</span> and <span class="math inline">\(\theta_2\)</span> are independent and the <span class="math inline">\(Y_i\)</span> are independent conditional on the <span class="math inline">\(\theta_i\)</span>, the two posterior distributions are independent. We can see this by writing out the joint distribution of the parameters and observations: <span class="math display">\[
Bin(x_1|\theta_1,70)Bin(x_2|\theta_2,70)Be(\theta_1|1,1)Be(\theta_2|1,1) = {70 \choose 19}\theta_1^{19}(1-\theta_1)^{51}{70 \choose 30}\theta_2^{30}(1-\theta_2)^{40}
\]</span> This is proportional to the product of two Beta density functions, the first with parameters (19.5,51.5), and the second with parameters (30.5,40.5).</p>
<p>Conditional on the observations, <span class="math inline">\(\theta_1\)</span> and <span class="math inline">\(\theta_2\)</span> are independent Beta random variables. The marginal distribution of <span class="math inline">\(\theta_1\)</span> is Beta(19.5, 51.5) and the marginal distribution of <span class="math inline">\(\theta_1\)</span> is Beta(30.5, 40.5).</p>
<p>The joint density function is the product of the individual density functions (remember that if <span class="math inline">\(n\)</span> is an integer, <span class="math inline">\(n! = \Gamma(n+1))\)</span> and <span class="math inline">\(B(\alpha, \beta) = \Gamma(\alpha)\Gamma(\beta)/\Gamma(\alpha+\beta)\)</span> <span class="math display">\[
Be(\theta_1|20,52)Be(\theta_2\mid 31,41) = \dfrac{\Gamma(20+52)}{\Gamma(20)\Gamma(52)}\theta_1^{19}(1-\theta_1)^{51}\dfrac{\Gamma(31+41)}{\Gamma(31)\Gamma(41)}\theta_2^{30}(1-\theta_2)^{40}
\]</span> A plot of the two posterior density functions is shown below. The 95% credible intervals are shown on the plot as vertical lines</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dbeta</span>(x,<span class="fl">19.5</span>,<span class="fl">51.5</span>),<span class="dv">0</span>,<span class="fl">0.6</span>,<span class="at">ylab=</span><span class="st">"Density"</span>,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">8</span>))</span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dbeta</span>(x,<span class="fl">30.5</span>,<span class="fl">40.5</span>),<span class="dv">0</span>,<span class="fl">0.6</span>,<span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>trt.intrv,<span class="at">lty=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="fl">0.5</span>)</span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>ctl.intrv,<span class="at">lty=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ex_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>To visualize the joint density function of <span class="math inline">\(\theta_1\)</span> and <span class="math inline">\(\theta_2\)</span>, we can do a surface or contour plot (you were not required to do this). The joint density function is a function of two variables, <span class="math inline">\(\theta_1\)</span> and <span class="math inline">\(\theta_2\)</span>. To visualize the joint density function, we need either a surface plot or a contour plot (you were not required to do this). A surface plot is shown below.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>gs<span class="ot">&lt;-</span><span class="dv">200</span>        <span class="co"># grid size</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>theta.t<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="fl">0.25</span>,<span class="fl">0.6</span>,<span class="at">length=</span>gs)   <span class="co"># treatment mean</span></span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>theta.c<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.45</span> ,<span class="at">length=</span>gs)  <span class="co"># control mean</span></span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a>dens<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,gs,gs)             <span class="co"># density function</span></span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>gs) {</span>
<span id="cb147-7"><a href="#cb147-7" aria-hidden="true" tabindex="-1"></a>  dens[i,]<span class="ot">=</span><span class="fu">dbeta</span>(theta.t[i],alpha.trt,beta.trt) <span class="sc">*</span> <span class="fu">dbeta</span>(theta.c,alpha.ctl,beta.ctl)</span>
<span id="cb147-8"><a href="#cb147-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb147-9"><a href="#cb147-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-10"><a href="#cb147-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Perspective plot</span></span>
<span id="cb147-11"><a href="#cb147-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-12"><a href="#cb147-12" aria-hidden="true" tabindex="-1"></a><span class="fu">persp</span>(theta.t,theta.c,dens,<span class="at">theta=</span><span class="dv">30</span>,<span class="at">phi=</span><span class="dv">5</span>,<span class="at">xlab=</span><span class="st">"Treatment Relapse Prob"</span>,</span>
<span id="cb147-13"><a href="#cb147-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylab=</span><span class="st">"Control Relapse Prob"</span>,<span class="at">zlab=</span><span class="st">"Probability Density"</span>,</span>
<span id="cb147-14"><a href="#cb147-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlim=</span>theta.t[<span class="fu">c</span>(<span class="dv">1</span>,gs)] ,<span class="at">ylim=</span>theta.c[<span class="fu">c</span>(<span class="dv">1</span>,gs)],</span>
<span id="cb147-15"><a href="#cb147-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">main=</span><span class="st">"3D Plot of Joint Density for Treatment and Control Relapse Probs"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ex_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>The posterior mean relapse probability for the treatment group is 19.5/71x100% = 27.5%. A 95% symmetric tail area credible interval is [17.8%, 38.3%]. The posterior mean relapse probability for the control group is 30.5/71x100% = 43.0%. A 95% symmetric tail area credible interval is [31.7%, 54.5%].</p>
<p>About 1/4 of the treatment patients relapsed, whereas almost half the control patients relapsed. Most of the posterior density function for the treatment group lies below most of the posterior density function for the control group, but the 95% credible intervals for the two parameters overlap somewhat (you were not required to compute credible intervals). While this analysis suggests that treatment lowers the relapse probability, it does not provide a statistical basis for concluding that it does.</p>
<ol start="2" type="a">
<li>The joint posterior distribution is Beta(19.5,51.5)Beta(30.5, 40.5). That is, <span class="math inline">\(\theta_1\)</span> and <span class="math inline">\(\theta_2\)</span> are independent Beta random variables with shape parameters as given in the table above. To sample from this joint distribution, we can draw 5000 random samples from each of these Beta distributions</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">92</span>) <span class="co"># Kuzy</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>nsample<span class="ot">=</span><span class="dv">5000</span></span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a>contr <span class="ot">=</span> <span class="fu">rbeta</span>(nsample,<span class="fl">19.5</span>,<span class="fl">51.5</span>)</span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a>treat <span class="ot">=</span> <span class="fu">rbeta</span>(nsample,<span class="fl">30.5</span>,<span class="fl">40.5</span>)</span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a>diff<span class="ot">=</span>treat<span class="sc">-</span>contr     <span class="co"># Estimate of difference in relapse probs</span></span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true" tabindex="-1"></a>efficacious <span class="ot">=</span> diff<span class="sc">&gt;</span><span class="dv">0</span>  <span class="co"># If treat &gt; control</span></span>
<span id="cb148-8"><a href="#cb148-8" aria-hidden="true" tabindex="-1"></a>prob.efficacious<span class="ot">=</span><span class="fu">sum</span>(efficacious)<span class="sc">/</span>nsample</span>
<span id="cb148-9"><a href="#cb148-9" aria-hidden="true" tabindex="-1"></a>sd.probefficacious <span class="ot">=</span> <span class="fu">sd</span>(efficacious)<span class="sc">/</span><span class="fu">sqrt</span>(nsample)</span>
<span id="cb148-10"><a href="#cb148-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-11"><a href="#cb148-11" aria-hidden="true" tabindex="-1"></a><span class="co">#Posterior quantiles, mean and standard deviation of the difference in </span></span>
<span id="cb148-12"><a href="#cb148-12" aria-hidden="true" tabindex="-1"></a><span class="co">#relapse rates between treatment and control</span></span>
<span id="cb148-13"><a href="#cb148-13" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(diff,<span class="fu">c</span>(<span class="fl">0.05</span>,<span class="fl">0.5</span>,<span class="fl">0.95</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##    5%   50%   95% 
## 0.021 0.156 0.287</code></pre>
</div>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(diff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.15</code></pre>
</div>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(diff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.08</code></pre>
</div>
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Density Function for Difference in Treatment and Control Relapse Probabilities</span></span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(diff),<span class="at">main=</span><span class="st">"Kernel Density Estimator"</span>,<span class="at">xlab=</span><span class="st">"Difference in Treatment and Control Probabilities"</span>,<span class="at">ylab=</span><span class="st">"Posterior Probability Density"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ex_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>The analysis above provides evidence that there is a lower relapse probability in the treatment than in the control group. We estimate a 97.2% probability that the treatment has a lower relapse probability. The mean of the posterior distribution of the difference in relapse probabilities is approximately 0.155, and an approximate 90% credible interval for the difference in relapse rates is [0.021, 0.287].</p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.79 (Normal-Normal)</strong></span> Concentrations of the pollutants aldrin and hexachlorobenzene (HCB) in nanograms per liter were measured in ten surface water samples, ten mid-depth water samples, and ten bottom samples from the Wolf River in Tennessee. The samples were taken downstream from an abandoned dump site previously used by the pesticide industry. The full data set can be found at http://www.biostat.umn.edu/~lynn/iid/wolf.river.dat. For this problem, we consider only HCB measurements taken at the bottom and the surface. The question of interest is whether the distribution of HCB concentration depends on the depth at which the measurement was taken. The data for this problem are given below.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">Surface</th>
<th style="text-align: left;">Bottom</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">3.74</td>
<td style="text-align: left;">5.44</td>
</tr>
<tr class="even">
<td style="text-align: left;">4.61</td>
<td style="text-align: left;">6.88</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4.00</td>
<td style="text-align: left;">5.37</td>
</tr>
<tr class="even">
<td style="text-align: left;">4.67</td>
<td style="text-align: left;">5.44</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4.87</td>
<td style="text-align: left;">5.03</td>
</tr>
<tr class="even">
<td style="text-align: left;">5.12</td>
<td style="text-align: left;">6.48</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4.52</td>
<td style="text-align: left;">3.89</td>
</tr>
<tr class="even">
<td style="text-align: left;">5.29</td>
<td style="text-align: left;">5.85</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5.74</td>
<td style="text-align: left;">6.85</td>
</tr>
<tr class="even">
<td style="text-align: left;">5.48</td>
<td style="text-align: left;">7.16</td>
</tr>
</tbody>
</table>
<p>Assume the observations are independent normal random variables with unknown depth-specific means <span class="math inline">\(\theta_s\)</span> and <span class="math inline">\(\theta_b\)</span> and precisions <span class="math inline">\(\rho_s  = 1/\sigma^2_s\)</span> and <span class="math inline">\(\rho_b = 1/\sigma_s^2\)</span>. Assume independent improper reference priors for the surface and bottom parameters: <span class="math display">\[
g(\theta_s,\theta_b ,\rho_s,\rho_b ) = g(\theta_s,\rho_s)g(\theta_b ,\rho_b) \propto \rho_s^{-1}\rho_b^{-1}.
\]</span></p>
<ol type="a">
<li>This prior can be treated as the product of two normal-gamma priors with <span class="math inline">\(\mu_s = \mu_b = 0\)</span>, <span class="math inline">\(\sigma_s \rightarrow 0\)</span> and <span class="math inline">\(\sigma_b \rightarrow 0\)</span>, <span class="math inline">\(a_s = a_b = -1/2\)</span>, and <span class="math inline">\(b_s = b_b \rightarrow 0\)</span>. (These are not valid normal-gamma distributions, but you can use the usual Bayesian conjugate updating rule to find the posterior distribution.) Find the joint posterior distribution for the parameters <span class="math inline">\((\theta_s,\theta_b,\rho_s,\rho_b)\)</span>. Find 90% posterior credible intervals for <span class="math inline">\((\theta_s,\theta_b,\rho_s,\rho_b)\)</span>. Comment on your results.</li>
<li>Use direct Monte Carlo to sample 10,000 observations from the joint posterior distribution of <span class="math inline">\((\theta_s,\theta_b,\rho_s,\rho_b)\)</span>. Use your Monte Carlo samples to estimate 90% posterior credible intervals for all four parameters. Compare with the result of part a.</li>
<li>Use your direct Monte Carlo sample to estimate the probability that the mean bottom concentration <span class="math inline">\(\theta_b\)</span> is higher than the mean surface concentration <span class="math inline">\(\theta_s\)</span> and to estimate the probability that the standard deviation <span class="math inline">\(\sigma\)</span> of the bottom concentrations is higher than the standard deviation <span class="math inline">\(\sigma_b\)</span> of the surface concentrations.</li>
<li>Comment on your analysis. What are your conclusions about the distributions of surface and bottom concentrations? Is the assumption of normality reasonable? Are the means different for surface and bottom? The standard deviations?</li>
<li>Find the predictive distribution for the sample mean of a future sample of size 10 from the surface and a future sample of size 10 from the bottom. Find 95% credible intervals on the sample mean of each future sample. Repeat for future samples of size 40. Compare your results and discuss.</li>
<li>Use direct Monte Carlo to estimate the predictive distribution for the difference in the two sample means for 10 future surface and bottom samples. Plot a kernel density estimator for the density function for the difference in means. Find a 95% credible interval for the difference in the two sample means. Repeat for future samples of 40 surface and 40 bottom observations. Comment on your results.</li>
<li>Repeat part e, but use a model in which the standard deviation is known and equal to the sample standard deviation, and the depth-specific means <span class="math inline">\(\theta_s\)</span> and <span class="math inline">\(\theta_b\)</span> have a uniform prior distribution. Compare the 95% credible intervals for the future sample means for the known and unknown standard deviation models. Discuss.</li>
<li>Assume that experts have provided the following prior information based on previous studies.</li>
</ol>
<ul>
<li>The unknown means <span class="math inline">\(\theta_s\)</span> and <span class="math inline">\(\theta_b\)</span> are independent and normally distributed with mean <span class="math inline">\(\mu\)</span> and standard deviation <span class="math inline">\(\tau\)</span>. The unknown precisions <span class="math inline">\(\rho_s\)</span> and <span class="math inline">\(\rho_b\)</span> are independent of <span class="math inline">\(\theta_s\)</span> and <span class="math inline">\(\theta_b\)</span> and have gamma distributions with shape <span class="math inline">\(a\)</span> and scale <span class="math inline">\(b\)</span>.</li>
<li>Experts specified a 95% prior credible interval of [3, 9] for <span class="math inline">\(\theta_s\)</span> and <span class="math inline">\(\theta_b\)</span>. A good fit to this credible interval is obtained by setting the prior mean to <span class="math inline">\(\mu =6\)</span> and the prior standard deviation to <span class="math inline">\(\tau=1.5\)</span>.</li>
<li>A 95% prior credible interval of [0.75, 2.0] is given for the unknown standard deviations <span class="math inline">\(\Sigma_s\)</span> and <span class="math inline">\(\Sigma_b\)</span>. This translates to a credible interval of [0.25, 1.8] for <span class="math inline">\(\rho_s = \Sigma_s^{-1}\)</span> and <span class="math inline">\(\rho_b = \Sigma_b^{-2}\)</span>. A good fit to this credible interval is obtained by setting the prior shape to $a = 4.5. and the prior scale to <span class="math inline">\(b\)</span> = 0.19. Find the following conditional distributions: <span class="math inline">\(p(\theta_s \mid D,\theta_b,\rho_s,\rho_b)\)</span>, <span class="math inline">\(p(\theta_b \mid D,\theta_s,\rho_s,\rho_b)\)</span>, <span class="math inline">\(p(\rho_s \mid D,\theta_s,\theta_b,rho_b)\)</span>, <span class="math inline">\(p(\rho_b \mid D, \theta_s,\theta_b,\rho_s)\)</span></li>
</ul>
<ol type="i">
<li>Using the distributions you found, draw 10,000 Gibbs samples of <span class="math inline">\((\theta_s,\theta_b,\rho_s,\rho_b)\)</span>. Estimate 90% credible intervals for <span class="math inline">\((\theta_s,\theta_b,\rho_s^{-1/2},\rho_b^{-1/2})\)</span> and <span class="math inline">\(\theta_b-\theta_s\)</span>.</li>
</ol>
<ol start="10" type="a">
<li>Do a traceplot of <span class="math inline">\(\theta_b-\theta_s\)</span>. Find the autocorrelation function of <span class="math inline">\(\theta_b-\theta_s\)</span> and the effective sample size for your Monte Carlo sample for <span class="math inline">\(\theta_b-\theta_s\)</span>.</li>
<li>Comment on your results. Compare with parts a,b, and c.</li>
</ol>
<p><strong>Solution</strong>:</p>
<ol type="a">
<li>The joint posterior distribution for the parameters <span class="math inline">\((\theta_s,\theta_b,\rho_s,\rho_b)\)</span> is the product of an improper prior density for the surface parameters times an improper prior density for the bottom parameters. The joint posterior density is proportional to the joint prior density times the surface and bottom likelihood functions: <span class="math display">\[
g(\theta_s,\theta_b ,\rho_s,\rho_b \mid x_s,x_b) \propto g(\theta_s,\rho_s)g(\theta_b ,\rho_b) g(x_s \mid \theta_s,\rho_s)g(x_b \mid \theta_b,\rho_b)
\]</span></li>
</ol>
<p>The first two factors are proportional to the posterior density of the surface parameters; the second two factors are proportional to the posterior density of the bottom parameters. Therefore, the surface and bottom parameters are independent given the data with joint posterior density: <span class="math display">\[
g(\theta_s,\theta_b ,\rho_s,\rho_b \mid x_s,x_b) \propto g(\theta_s,\rho_s \mid x_s)g(\theta_b ,\rho_b \mid x_b)
\]</span> We will calculate the posterior distributions for the surface and bottom parameters in turn.</p>
<p>The prior density for the surface parameters is <span class="math inline">\(g(\theta_s,\rho_s) \propto \rho_s^{-1}\)</span></p>
<p>This is the limit of the density function for a normal-gamma conjugate prior distribution. We use the Normal-Normal-Gamma update rules. The prior is given by <span class="math display">\[
g(\theta,\rho \mid \nu,\mu,a,b) = \sqrt{\frac{\nu\rho}{2\pi}} \exp\left(-\frac{\nu\rho}{2}(\theta-\mu)^2\right) \frac{b^a}{\Gamma(a)}\rho^{a-1}e^{-b\rho}
\]</span></p>
<p>For prior parameters <span class="math inline">\(\mu_0 =0 ,\, \nu=0,\, \alpha=-0.5 ,\, \beta=0\)</span>, the posterior values are <span class="math display">\[
\frac{\nu\mu_0+n\bar{x}}{\nu+n} ,\, \nu+n,\, \alpha+\frac{n}{2},
\beta + \tfrac{1}{2} \sum_{i=1}^n (x_i - \bar{x})^2 + \frac{n\nu}{\nu+n}\frac{(\bar{x}-\mu_0)^2}{2}
\]</span> Pluggin-in our values <span class="math inline">\(n=10\)</span> and <span class="math inline">\(\bar{x}=4.8\)</span>, we get the posterior values for the Surface <span class="math display">\[
\mu^* = \frac{0+10*4.8}{0+10} = 4.8 ,\, \nu^* = 0+10=10,\, \alpha^* = -0.5+\frac{10}{2} = 4.5, \, \beta^* = 0 + \tfrac{1}{2} \sum_{i=1}^{10} (x_i - 4.8)^2 = 1.794
\]</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>s <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">3.74</span>,<span class="fl">4.61</span>,<span class="fl">4.00</span>,<span class="fl">4.67</span>,<span class="fl">4.87</span>,<span class="fl">5.12</span>,<span class="fl">4.52</span>,<span class="fl">5.29</span>,<span class="fl">5.74</span>,<span class="fl">5.48</span>)</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">5.44</span>,<span class="fl">6.88</span>,<span class="fl">5.37</span>,<span class="fl">5.44</span>,<span class="fl">5.03</span>,<span class="fl">6.48</span>,<span class="fl">3.89</span>,<span class="fl">5.85</span>,<span class="fl">6.85</span>,<span class="fl">7.16</span>)</span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">mean</span>(s))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 4.8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">mean</span>(b))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 5.8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fl">0.5</span><span class="sc">*</span><span class="fu">sum</span>((s <span class="sc">-</span> <span class="fu">mean</span>(s))<span class="sc">^</span><span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 1.8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fl">0.5</span><span class="sc">*</span><span class="fu">sum</span>((b <span class="sc">-</span> <span class="fu">mean</span>(b))<span class="sc">^</span><span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 4.6</code></pre>
</div>
</div>
<p>Similar calculations for the bottom parameters give us the posterior values <span class="math display">\[
\mu^*=\frac{0+10*5.84}{0+10} = 5.84,~ \nu^* = 0+10=10,\, \alpha^* = -0.5+\frac{10}{2} = 4.5, \, \beta^* = 0 + \tfrac{1}{2} \sum_{i=1}^{10} (x_i - 5.84)^2 = 4.627
\]</span></p>
<p>To summarise, we have:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;"><span class="math inline">\(\mu^*\)</span></th>
<th style="text-align: left;"><span class="math inline">\(\nu^*\)</span></th>
<th style="text-align: left;"><span class="math inline">\(\alpha^*\)</span></th>
<th style="text-align: left;"><span class="math inline">\(\beta^*\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">surface</td>
<td style="text-align: left;">4.8</td>
<td style="text-align: left;">10</td>
<td style="text-align: left;">4.5</td>
<td style="text-align: left;">1.794</td>
</tr>
<tr class="even">
<td style="text-align: left;">bottom</td>
<td style="text-align: left;">5.84</td>
<td style="text-align: left;">10</td>
<td style="text-align: left;">4.5</td>
<td style="text-align: left;">4.627</td>
</tr>
</tbody>
</table>
<p>The marginal distribution for <span class="math inline">\(\theta_s\)</span> is nonstandard <span class="math inline">\(t\)</span> with center 4.80, spread <span class="math inline">\(1/\sqrt{\nu^*\alpha^*/\beta^*} = 0.20\)</span>, and degrees of freedom 9. The marginal distribution for <span class="math inline">\(\theta_s\)</span> is nonstandard <span class="math inline">\(t\)</span> with center 5.84, spread <span class="math inline">\(1/\sqrt{\nu^*\alpha^*/\beta^*} = 0.32\)</span>, and degrees of freedom 9. Using the quantiles of the t distribution</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qgamma</span>(<span class="fu">c</span>(<span class="fl">0.05</span>,<span class="fl">0.95</span>),<span class="fl">4.5</span>,<span class="fl">1.794</span>) <span class="co"># marginal posterior for \rho_s</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.93 4.72</code></pre>
</div>
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qgamma</span>(<span class="fu">c</span>(<span class="fl">0.05</span>,<span class="fl">0.95</span>),<span class="fl">4.5</span>,<span class="fl">4.627</span>) <span class="co"># marginal posterior for \rho_b</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.36 1.83</code></pre>
</div>
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fl">4.8</span> <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">*</span><span class="fl">1.833</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">10</span><span class="sc">*</span><span class="fl">4.5</span><span class="sc">/</span><span class="fl">1.794</span>)) <span class="co"># marginal posterior for \theta_s</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 4.4 5.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="fl">5.84</span> <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">*</span><span class="fl">1.833</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">10</span><span class="sc">*</span><span class="fl">4.5</span><span class="sc">/</span><span class="fl">4.627</span>)) <span class="co"># marginal posterior for \theta_b</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 5.3 6.4</code></pre>
</div>
</div>
<ol start="2" type="a">
<li></li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">92</span>) <span class="co"># Kuzy</span></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Direct Monte Carlo</span></span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a>numsim<span class="ot">=</span><span class="dv">5000</span></span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a>rhos<span class="ot">=</span><span class="fu">rgamma</span>(numsim,<span class="fl">4.5</span>,<span class="fl">1.794</span>)</span>
<span id="cb171-5"><a href="#cb171-5" aria-hidden="true" tabindex="-1"></a>rhob<span class="ot">=</span><span class="fu">rgamma</span>(numsim,<span class="fl">4.5</span>,<span class="fl">4.627</span>)</span>
<span id="cb171-6"><a href="#cb171-6" aria-hidden="true" tabindex="-1"></a>thetas<span class="ot">=</span><span class="fu">rnorm</span>(numsim,<span class="fl">4.8</span>,<span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">10</span><span class="sc">*</span>rhos))</span>
<span id="cb171-7"><a href="#cb171-7" aria-hidden="true" tabindex="-1"></a>thetab<span class="ot">=</span><span class="fu">rnorm</span>(numsim,<span class="fl">5.84</span>,<span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">10</span><span class="sc">*</span>rhob))</span>
<span id="cb171-8"><a href="#cb171-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-9"><a href="#cb171-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-10"><a href="#cb171-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Monte Carlo quantiles</span></span>
<span id="cb171-11"><a href="#cb171-11" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(rhos,<span class="fu">c</span>(<span class="fl">0.05</span>,<span class="fl">0.95</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##   5%  95% 
## 0.92 4.70</code></pre>
</div>
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(rhob,<span class="fu">c</span>(<span class="fl">0.05</span>,<span class="fl">0.95</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##   5%  95% 
## 0.36 1.84</code></pre>
</div>
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(thetas,<span class="fu">c</span>(<span class="fl">0.05</span>,<span class="fl">0.95</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##  5% 95% 
## 4.4 5.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(thetab,<span class="fu">c</span>(<span class="fl">0.05</span>,<span class="fl">0.95</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##  5% 95% 
## 5.3 6.4</code></pre>
</div>
</div>
<ol start="3" type="a">
<li></li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate probability that bottom concentration is larger</span></span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(thetab<span class="sc">&gt;</span>thetas)<span class="sc">/</span>numsim        <span class="co"># Estimated prob bottom mean is larger</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.99</code></pre>
</div>
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(thetab<span class="sc">&gt;</span>thetas)<span class="sc">/</span><span class="fu">sqrt</span>(numsim)   <span class="co"># Standard error of estimate</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.0014</code></pre>
</div>
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(thetab<span class="sc">-</span>thetas, <span class="fu">c</span>(<span class="fl">0.05</span>,<span class="fl">0.95</span>))  <span class="co"># 90% credible interval</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##   5%  95% 
## 0.36 1.73</code></pre>
</div>
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate probability that bottom  precision is smaller</span></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(rhob<span class="sc">&gt;</span>rhos)<span class="sc">/</span>numsim        <span class="co"># Estimated prob bottom precision is larger</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.088</code></pre>
</div>
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(rhob<span class="sc">&gt;</span>rhos)<span class="sc">/</span><span class="fu">sqrt</span>(numsim)   <span class="co"># Standard error of estimate</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.004</code></pre>
</div>
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(rhob<span class="sc">-</span>rhos, <span class="fu">c</span>(<span class="fl">0.05</span>,<span class="fl">0.95</span>))  <span class="co"># 90% credible interval</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##    5%   95% 
## -3.84  0.28</code></pre>
</div>
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate probability that bottom standard deviation is larger</span></span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>sigmab<span class="ot">=</span><span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(rhob)         <span class="co"># bottom standard deviation</span></span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a>sigmas<span class="ot">=</span><span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(rhos)         <span class="co"># surfact standard deviation</span></span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(sigmab<span class="sc">&gt;</span>sigmas)<span class="sc">/</span>numsim    <span class="co"># Estimated prob bottom std dev is larger</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.91</code></pre>
</div>
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(sigmab<span class="sc">&gt;</span>sigmas)<span class="sc">/</span><span class="fu">sqrt</span>(numsim)   <span class="co"># Standard error of estimate</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.004</code></pre>
</div>
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(sigmab<span class="sc">-</span>sigmas, <span class="fu">c</span>(<span class="fl">0.05</span>,<span class="fl">0.95</span>))  <span class="co"># 90% credible interval</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##   5%  95% 
## -0.1  1.0</code></pre>
</div>
</div>
<ol start="4" type="a">
<li>The results provide strong evidence that the mean HCB concentration in the bottom samples is larger than the mean HCB concentration in the surface samples. There is also evidence that the surface concentrations may have less variation around the mean than the bottom observations, but because of the small sample size, more evidence is needed to make a definitive assessment of whether the standard deviations are different. The p-value is 0.93 for the surface observations and 0.53 for the bottom observations, which does not reject the hypothesis of normality. Therefore, it seems reasonable to proceed with the assumption that the observations are normally distributed.</li>
</ol>
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(s,<span class="at">main=</span><span class="st">"Normal Q-Q Plot for Surface Data"</span>); <span class="fu">qqline</span>(s)</span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(b,<span class="at">main=</span><span class="st">"Normal Q-Q Plot for Bottom Data"</span>); <span class="fu">qqline</span>(b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel" data-layout-align="center" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ex_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ex_files/figure-html/unnamed-chunk-57-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
<ol start="5" type="a">
<li>The posterior-predictive for the sample mean for Normal-Gamma of size <span class="math inline">\(m\)</span> is <span class="math inline">\(t\)</span> distribution with mean <span class="math inline">\(\mu^*\)</span> and spread <span class="math display">\[
\dfrac{1}{\sqrt{\dfrac{\nu^*m}{\nu^*+m}\alpha^*/\beta^*}}
\]</span> and degrees of freedom <span class="math inline">\(m-1\)</span>. For <span class="math inline">\(m=10\)</span> and the posterior parameters of the surface data, we have spread <span class="math display">\[
\dfrac{1}{\sqrt{\dfrac{10*10}{10+10}*4.5/1.794}} = 0.28
\]</span></li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a>ss10 <span class="ot">=</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">100</span><span class="sc">/</span><span class="dv">20</span><span class="sc">*</span><span class="fl">4.5</span><span class="sc">/</span><span class="fl">1.794</span>)</span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">"Spread for surface data with m=10: %.2f"</span>,ss10)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] "Spread for surface data with m=10: 0.28"</code></pre>
</div>
</div>
<p>for <span class="math inline">\(m=40\)</span>, we have spread</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a>ss40 <span class="ot">=</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">400</span><span class="sc">/</span><span class="dv">50</span><span class="sc">*</span><span class="fl">4.5</span><span class="sc">/</span><span class="fl">1.794</span>)</span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">"Spread for surface data with m=40: %.2f"</span>,ss40)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] "Spread for surface data with m=40: 0.22"</code></pre>
</div>
</div>
<p>For the bottom data, we have spread</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a>sb10 <span class="ot">=</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">100</span><span class="sc">/</span><span class="dv">20</span><span class="sc">*</span><span class="fl">4.5</span><span class="sc">/</span><span class="fl">4.627</span>)</span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">"Spread for bottom data with m=10: %.2f"</span>,sb10)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] "Spread for bottom data with m=10: 0.45"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a>sb40 <span class="ot">=</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">400</span><span class="sc">/</span><span class="dv">50</span><span class="sc">*</span><span class="fl">4.5</span><span class="sc">/</span><span class="fl">4.627</span>)</span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">"Spread for bottom data with m=40: %.2f"</span>,sb40)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] "Spread for bottom data with m=40: 0.36"</code></pre>
</div>
</div>
<p>Now we can calculate 95% credible intervals for the sample mean of each future sample</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="fl">4.8</span><span class="sc">+</span>ss10<span class="sc">*</span><span class="fu">qt</span>(<span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>),<span class="dv">9</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 4.2 5.4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="fl">4.8</span><span class="sc">+</span>ss40<span class="sc">*</span><span class="fu">qt</span>(<span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>),<span class="dv">9</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 4.3 5.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="fl">5.839</span><span class="sc">+</span>sb40<span class="sc">*</span><span class="fu">qt</span>(<span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>),<span class="dv">9</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 5.0 6.7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="fl">5.839</span><span class="sc">+</span>sb10<span class="sc">*</span><span class="fu">qt</span>(<span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>),<span class="dv">9</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 4.8 6.9</code></pre>
</div>
</div>
<p>As we would expect, the intervals for m=40 are entirely contained within the intervals for m=10, and the intervals for the posterior mean (computed above) lie entirely within the intervals for the corresponding sample means. This is because the posterior mean intervals include uncertainty only about the surface and bottom mean, whereas the intervals in this assignment include uncertainty about both the true means and the observations. The sample mean for 40 observations has less uncertainty than the sample mean for 10 observations. The intervals for surface and bottom sample means overlap more for m=10 than for m=40, and both have more overlap than the posterior mean intervals.</p>
<ol start="6" type="a">
<li>We do this two different ways and verify that they give the same results to within sampling error. First draw samples of Theta and Rho, draw ssize observations, compute the sample mean, and average.</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">92</span>) <span class="co"># Kuzy</span></span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true" tabindex="-1"></a>numsim<span class="ot">=</span><span class="dv">10000</span></span>
<span id="cb214-3"><a href="#cb214-3" aria-hidden="true" tabindex="-1"></a>ssize<span class="ot">=</span><span class="dv">10</span></span>
<span id="cb214-4"><a href="#cb214-4" aria-hidden="true" tabindex="-1"></a>rhob<span class="ot">=</span><span class="fu">rgamma</span>(numsim,<span class="fl">4.5</span>,<span class="fl">4.627</span>) <span class="co"># sample b precision</span></span>
<span id="cb214-5"><a href="#cb214-5" aria-hidden="true" tabindex="-1"></a>thetab<span class="ot">=</span><span class="fu">rnorm</span>(numsim,<span class="fl">5.84</span>,<span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">10</span><span class="sc">*</span>rhob))     <span class="co"># sample b precision</span></span>
<span id="cb214-6"><a href="#cb214-6" aria-hidden="true" tabindex="-1"></a>rhos<span class="ot">=</span><span class="fu">rgamma</span>(numsim,<span class="fl">4.5</span>,<span class="fl">1.794</span>) <span class="co"># sample s mean</span></span>
<span id="cb214-7"><a href="#cb214-7" aria-hidden="true" tabindex="-1"></a>thetas<span class="ot">=</span><span class="fu">rnorm</span>(numsim,<span class="fl">4.8</span>,<span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">10</span><span class="sc">*</span>rhos))     <span class="co"># sample surface mean</span></span>
<span id="cb214-8"><a href="#cb214-8" aria-hidden="true" tabindex="-1"></a>diff <span class="ot">=</span> <span class="dv">0</span>     <span class="co"># Difference in sample means - initialize to 0</span></span>
<span id="cb214-9"><a href="#cb214-9" aria-hidden="true" tabindex="-1"></a>dd<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb214-10"><a href="#cb214-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>ssize) {</span>
<span id="cb214-11"><a href="#cb214-11" aria-hidden="true" tabindex="-1"></a>  diff <span class="ot">=</span> diff <span class="sc">+</span> </span>
<span id="cb214-12"><a href="#cb214-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rnorm</span>(numsim,thetab,<span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(rhob)) <span class="sc">-</span>    <span class="co"># sample bottom observation</span></span>
<span id="cb214-13"><a href="#cb214-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rnorm</span>(numsim,thetas,<span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(rhos))      <span class="co"># sample surface observation and subtrace</span></span>
<span id="cb214-14"><a href="#cb214-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb214-15"><a href="#cb214-15" aria-hidden="true" tabindex="-1"></a>diff <span class="ot">=</span> diff <span class="sc">/</span> ssize    <span class="co"># Calculate average - divide sum by number of observations</span></span>
<span id="cb214-16"><a href="#cb214-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb214-17"><a href="#cb214-17" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(diff, <span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>))   <span class="co"># quantiles</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##  2.5% 97.5% 
## -0.16  2.23</code></pre>
</div>
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(diff),              <span class="co"># kernel density plot</span></span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="fu">paste</span>(<span class="st">"Density for Difference in Sample Means for m ="</span>,ssize))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ex_files/figure-html/unnamed-chunk-62-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>We can also sample from the t distribution (need two independent samples one for surface and one for bottom)</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a>diff1 <span class="ot">=</span> <span class="fl">5.84</span> <span class="sc">+</span> <span class="fu">rt</span>(numsim,<span class="dv">2</span><span class="sc">*</span><span class="fl">4.5</span>)<span class="sc">*</span>ss10 <span class="sc">-</span></span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a>  <span class="fl">4.8</span> <span class="sc">+</span> <span class="fu">rt</span>(numsim,<span class="dv">2</span><span class="sc">*</span><span class="fl">4.5</span>)<span class="sc">*</span>sb10 </span>
<span id="cb217-3"><a href="#cb217-3" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(diff1,<span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>))  <span class="co"># Compare with quantiles from full sampling method</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##  2.5% 97.5% 
## -0.17  2.23</code></pre>
</div>
</div>
<ol start="7" type="a">
<li></li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Known standard deviation model</span></span>
<span id="cb219-2"><a href="#cb219-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-3"><a href="#cb219-3" aria-hidden="true" tabindex="-1"></a>mu0<span class="ot">=</span><span class="dv">0</span>           <span class="co"># prior mean for theta is 0</span></span>
<span id="cb219-4"><a href="#cb219-4" aria-hidden="true" tabindex="-1"></a>tau0<span class="ot">=</span><span class="cn">Inf</span>        <span class="co"># prior SD of theta is infinite</span></span>
<span id="cb219-5"><a href="#cb219-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-6"><a href="#cb219-6" aria-hidden="true" tabindex="-1"></a>sigmas <span class="ot">=</span> <span class="fu">sd</span>(s) <span class="co"># observation SD is assumed known and equal to sample SD</span></span>
<span id="cb219-7"><a href="#cb219-7" aria-hidden="true" tabindex="-1"></a>sigmab <span class="ot">=</span> <span class="fu">sd</span>(b) <span class="co"># observation SD is assumed known and equal to sample SD</span></span>
<span id="cb219-8"><a href="#cb219-8" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">10</span></span>
<span id="cb219-9"><a href="#cb219-9" aria-hidden="true" tabindex="-1"></a>mus.star <span class="ot">=</span>      <span class="co"># Posterior mean for surface</span></span>
<span id="cb219-10"><a href="#cb219-10" aria-hidden="true" tabindex="-1"></a>  (mu0<span class="sc">/</span>tau0<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">sum</span>(s)<span class="sc">/</span>sigmas<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">/</span>tau0<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>n<span class="sc">/</span>sigmas<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb219-11"><a href="#cb219-11" aria-hidden="true" tabindex="-1"></a>taus.star <span class="ot">=</span>     <span class="co"># Posterior SD of surface mean</span></span>
<span id="cb219-12"><a href="#cb219-12" aria-hidden="true" tabindex="-1"></a>  (<span class="dv">1</span><span class="sc">/</span>tau0<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>n<span class="sc">/</span>sigmas<span class="sc">^</span><span class="dv">2</span>)<span class="sc">^</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb219-13"><a href="#cb219-13" aria-hidden="true" tabindex="-1"></a>mub.star <span class="ot">=</span>      <span class="co"># Posterior mean for bottom</span></span>
<span id="cb219-14"><a href="#cb219-14" aria-hidden="true" tabindex="-1"></a>  (mu0<span class="sc">/</span>tau0<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">sum</span>(b)<span class="sc">/</span>sigmab<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">/</span>tau0<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>n<span class="sc">/</span>sigmab<span class="sc">^</span><span class="dv">2</span>)  </span>
<span id="cb219-15"><a href="#cb219-15" aria-hidden="true" tabindex="-1"></a>taub.star <span class="ot">=</span>     <span class="co"># Posterior SD of surface mean</span></span>
<span id="cb219-16"><a href="#cb219-16" aria-hidden="true" tabindex="-1"></a>  (<span class="dv">1</span><span class="sc">/</span>tau0<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>n<span class="sc">/</span>sigmab<span class="sc">^</span><span class="dv">2</span>)<span class="sc">^</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb219-17"><a href="#cb219-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-18"><a href="#cb219-18" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">"Posterior mean for surface: %.2f"</span>,mus.star)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] "Posterior mean for surface: 4.80"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">"Posterior mean for bottom: %.2f"</span>,mub.star)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] "Posterior mean for bottom: 5.84"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predictive intervals</span></span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-3"><a href="#cb223-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>),    <span class="co"># Surface, sample size 10</span></span>
<span id="cb223-4"><a href="#cb223-4" aria-hidden="true" tabindex="-1"></a>      mus.star,<span class="fu">sqrt</span>(taus.star<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> sigmas<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 4.3 5.4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>),    <span class="co"># Surface, sample size 40</span></span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a>      mus.star,<span class="fu">sqrt</span>(taus.star<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> sigmas<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">40</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 4.4 5.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>),    <span class="co"># Surface, sample size 10</span></span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a>      mub.star,<span class="fu">sqrt</span>(taub.star<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> sigmab<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 5.0 6.7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>),    <span class="co"># Surface, sample size 40</span></span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a>      mub.star,<span class="fu">sqrt</span>(taub.star<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> sigmab<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">40</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 5.1 6.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Kernel density plot</span></span>
<span id="cb231-2"><a href="#cb231-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(diff),<span class="at">main=</span><span class="fu">paste</span>(<span class="st">"Density for Difference in Sample Means"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ex_files/figure-html/unnamed-chunk-64-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="exr-poisson" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.80 (Gibbs: Bird feeders)</strong></span> A biologist counts the number of sparrows visiting six bird feeders placed on a given day.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">Feeder</th>
<th style="text-align: left;">Number of Birds</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;">11</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: left;">22</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: left;">13</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: left;">24</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: left;">19</td>
</tr>
<tr class="even">
<td style="text-align: left;">6</td>
<td style="text-align: left;">16</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<ul>
<li>Assume that the bird counts are independent Poisson random variables with feeder- dependent means <span class="math inline">\(\lambda_i\)</span>, for <span class="math inline">\(i=1,\ldots,6\)</span>.</li>
<li>Assume that the means <span class="math inline">\(\lambda_i\)</span> are independent and identically distributed gamma random variables with shape <span class="math inline">\(a\)</span> and scale <span class="math inline">\(b\)</span> (or equivalently, shape $a and mean <span class="math inline">\(m = ab\)</span> )</li>
<li>The mean <span class="math inline">\(m = ab\)</span> of the Gamma distribution is uniformly distributed on a grid of 200 equally spaced values starting at 5 and ending at 40.</li>
<li>The shape <span class="math inline">\(a\)</span> is independent of the mean <span class="math inline">\(m\)</span> and has a distribution that takes values on a grid of 200 equally spaced points starting at 1 and ending at 50, with prior probabilities proportional to a gamma density with shape <span class="math inline">\(1\)</span> and scale <span class="math inline">\(5\)</span>.</li>
</ul>
<ol type="a">
<li>Use Gibbs sampling to draw 10000 samples from the joint posterior distribution of the mean <span class="math inline">\(m\)</span>, the shape parameter <span class="math inline">\(a\)</span>, and the six mean parameters <span class="math inline">\(\lambda_i\)</span>, <span class="math inline">\(i=1,\ldots,6\)</span>, conditional on the observed bird counts. Using your sample, calculate 95% credible intervals for the mean m, the shape a, and the six mean parameters <span class="math inline">\(\lambda_i\)</span>, <span class="math inline">\(i=1,\ldots,6\)</span>.</li>
<li>Find the effective sample size for the Monte Carlo samples of the mean m, the shape parameter a, and the six mean parameters <span class="math inline">\(\lambda_i\)</span>, <span class="math inline">\(i=1,\ldots,6\)</span>.</li>
<li>Do traceplots for the mean m, the shape parameter a, and the six rate parameters <span class="math inline">\(\lambda_i\)</span>, <span class="math inline">\(i=1,\ldots,6\)</span>.</li>
<li>The fourth feeder had the highest bird count and the first feeder had the lowest bird count. Use your Monte Carlo sample to estimate the posterior probability that the first feeder has a smaller mean bird count than the fourth feeder. Explain how you obtained your estimate.</li>
<li>Discuss your results.</li>
</ol>
<p><strong>Solution</strong>:</p>
<p>A plate diagram for this problem is shown at the right. Gibbs sampling on this model can be done as follows:</p>
<ol type="1">
<li>Initialize <span class="math inline">\(m^{(0)}\)</span> and <span class="math inline">\(\alpha^{(0)}\)</span>. Any initial values will do, but I used the empirical Bayes estimates <span class="math inline">\(m^{(0)}=17.3\)</span> (average of the observations) and <span class="math inline">\(\alpha^{(0)}=10.48\)</span> (square of mean of observations divided by variance of observations). I did not initialize the <span class="math inline">\(\lambda_{i}\)</span> because they are sampled before they are needed.</li>
<li>For <span class="math inline">\(k=1, \ldots, 10,000\)</span> :</li>
</ol>
<ol type="a">
<li>For <span class="math inline">\(i=1, \ldots 6\)</span> :</li>
</ol>
<ul>
<li>Calculate the posterior shape <span class="math inline">\(\alpha_{i}^{*}=\left(\alpha^{(k-1)}+\right.\)</span> <span class="math inline">\(Y_{i}\)</span> ) for the <span class="math inline">\(i^{\text {th }}\)</span> feeder.</li>
<li>Calculate the posterior scale <span class="math inline">\(\beta_{i}{ }^{*}=\left(m^{(k-1)} / \alpha_{i}^{(k-}\right.\)</span></li>
</ul>
<p><img src="https://cdn.mathpix.com/cropped/2025_03_25_c624fa98898366c581aeg-1.jpg?height=603&amp;width=624&amp;top_left_y=1544&amp;top_left_x=1230" class="img-fluid"> $</p>
<p>.{ }<sup>{1)}+1)</sup>{-1}$ for the <span class="math inline">\(i^{\text {th }}\)</span> feeder.</p>
<ul>
<li>Simulate <span class="math inline">\(\lambda_{i}{ }^{(k)}\)</span> from a gamma distribution with shape <span class="math inline">\(\alpha_{i}^{*}\)</span> and scale <span class="math inline">\(\beta_{i}^{*}\)</span>.</li>
</ul>
<ol start="2" type="a">
<li>Find the conditional distribution for <span class="math inline">\(m\)</span> given <span class="math inline">\(\alpha^{(k-1)}\)</span> and <span class="math inline">\(\lambda_{i}{ }^{(k)}, i=1, \ldots, 6\)</span>. To do this, find the prior times likelihood for each possible value of <span class="math inline">\(m\)</span>. Because the prior is uniform, this is the product of the six Gamma likelihoods. Then divide by sum of prior times likelihood. So for each possible value of <span class="math inline">\(m\)</span> :</li>
</ol>
<ul>
<li>Calculate the six gamma likelihoods <span class="math inline">\(g\left(\lambda_{i}^{(k)} \mid \alpha^{(k-1)}, \alpha^{(k-1)} / m\right)\)</span> evaluated at the current estimate <span class="math inline">\(\lambda_{i}^{(k)}\)</span> with shape <span class="math inline">\(\alpha^{(k-1)}\)</span> and scale <span class="math inline">\(\alpha^{(k-1)} / m\)</span>.</li>
<li>Multiply these six gamma likelihoods: <span class="math inline">\(l(m)=\Pi_{i} g\left(\lambda_{i}^{(k)} \mid \alpha^{(k-1)}, \alpha^{(k-1)} / m\right)\)</span>. Then normalize these values to obtain a probability distribution <span class="math inline">\(p(m)=l(m) /\left(\Sigma_{m^{\prime}} l\left(m^{\prime}\right)\right)\)</span> and sample a new value <span class="math inline">\(m^{(k)}\)</span> with probability <span class="math inline">\(p(m)\)</span>.</li>
</ul>
<ol start="3" type="a">
<li>Find the conditional distribution for <span class="math inline">\(\alpha\)</span> given <span class="math inline">\(m^{(k)}\)</span> and <span class="math inline">\(\lambda_{i}^{(k)}, i=1, \ldots, 6\)</span>. To do this, find the prior times likelihood for each possible value of <span class="math inline">\(\alpha\)</span> and normalize to sum to 1 . For each possible value of <span class="math inline">\(\alpha\)</span> :</li>
</ol>
<ul>
<li>Calculate the six Gamma likelihoods <span class="math inline">\(g\left(\lambda_{i}^{(k)} \mid \alpha, \alpha / m^{(k)}\right)\)</span> evaluated at the current estimate <span class="math inline">\(\lambda_{i}^{(k)}\)</span> with shape <span class="math inline">\(\alpha\)</span> and scale <span class="math inline">\(\alpha / m^{(k)}\)</span>.</li>
<li>Multiply these six Gamma likelihoods: <span class="math inline">\(l(\alpha)=g\left(\lambda_{i}^{(k)} \mid \alpha, \alpha / m^{(k)}\right)\)</span></li>
<li>Multiply this by the prior to obtain prior times likelihood <span class="math inline">\(l(\alpha) g(\alpha)\)</span> where <span class="math inline">\(g(\alpha)\)</span> is the gamma prior density function. Then normalize these values to obtain a probability distribution <span class="math inline">\(p(\alpha)=\frac{l(\alpha) / g(\alpha)}{\sum_{\alpha \prime} l(\alpha \prime) / g\left(\alpha^{\prime}\right)}\)</span>, and sample a new value <span class="math inline">\(\alpha^{(k)}\)</span> with probability <span class="math inline">\(p(\alpha)\)</span>.</li>
</ul>
<ol start="3" type="1">
<li>The result of this process is the requested sample.</li>
</ol>
<p>R code for doing the sampling is available on Blackboard. The table below shows credible intervals calculated from the raw Gibbs samples and credible intervals from a thinned sample with interval 3 (that is, only every third sample is kept). The intervals are almost the same. Due to sampling variation, the intervals will be different each time the sampler is run but your results should be similar.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Parameter</th>
<th style="text-align: center;">Gibbs Interval <br> (raw)</th>
<th style="text-align: center;">Gibbs Interval <br> (thinned x3)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(m\)</span></td>
<td style="text-align: center;"><span class="math inline">\([12.74,27.34]\)</span></td>
<td style="text-align: center;"><span class="math inline">\([12.73,26.98]\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(\alpha\)</span></td>
<td style="text-align: center;"><span class="math inline">\([2.23,24.64]\)</span></td>
<td style="text-align: center;"><span class="math inline">\([2.23,24.32]\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(\lambda_{1}\)</span></td>
<td style="text-align: center;"><span class="math inline">\([7.61,19.92]\)</span></td>
<td style="text-align: center;"><span class="math inline">\([7.71,19.5]\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(\lambda_{2}\)</span></td>
<td style="text-align: center;"><span class="math inline">\([13.71,29.45]\)</span></td>
<td style="text-align: center;"><span class="math inline">\([13.92,29.45]\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(\lambda_{3}\)</span></td>
<td style="text-align: center;"><span class="math inline">\([8.81,21.55]\)</span></td>
<td style="text-align: center;"><span class="math inline">\([8.76,21.40]\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(\lambda_{4}\)</span></td>
<td style="text-align: center;"><span class="math inline">\([14.89,31.18]\)</span></td>
<td style="text-align: center;"><span class="math inline">\([14.96,31.13]\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(\lambda_{5}\)</span></td>
<td style="text-align: center;"><span class="math inline">\([12.12,26.78]\)</span></td>
<td style="text-align: center;"><span class="math inline">\([12.23,26.60]\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(\lambda_{6}\)</span></td>
<td style="text-align: center;"><span class="math inline">\([10.46,24.21]\)</span></td>
<td style="text-align: center;"><span class="math inline">\([10.48,24.08]\)</span></td>
</tr>
</tbody>
</table>
<p>In general, thinning increases the variance of the estimator (because we are throwing away information), but has other advantages: (1) it reduces data storage; (2) it reduces computation for any post-processing of the Monte Carlo samples; (3) it allows use of data processing methods intended for independent and identically distributed data, without having to adjust for the correlation.</p>
<p>It is also common to discard a burn-in sample when doing MCMC. I did not require either thinning or discarding a burnin sample.</p>
</div>
<div id="exr-poisson" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.81 (Poisson Distribution for EPL)</strong></span> We will analyze EPL data. Use <code>epl.R</code> as a starting script. This script uses <code>football-data.org</code> API to download the results for two EPL teams: Manchester United and Chelsea. Model the <code>GoalsHome</code> and <code>GoalsAway</code> for each of the teams using Poisson distribution. Given these distributions calculate the following</p>
<ol type="a">
<li>What’s the probability of a nil-nil (0 - 0) draw?</li>
<li>What’s the probability that MU wins the match?</li>
<li>Discuss how could you improve your model based on four Poisson distributions.</li>
<li>Use <code>R</code> and random number simulation to provide empirical answers. Using a random sample of size N = 10, 000, check and see how close you get to the theoretical answers you’ve found to the questions posed above. Provide histograms of the distributions you simulate.</li>
</ol>
<p>Hint: The difference of two Poisson random variables follows a Skellam distribution, defined in <code>skellam</code> package. You can use <code>dskellam</code> to calculate the probability of a draw. You can use <code>rpois</code> to simulate draws from Poisson distribution.</p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.82 (Homicide Rate (Poisson Distribution))</strong></span> Suppose that there are <span class="math inline">\(1.5\)</span> homicides a week. The is the rate, so <span class="math inline">\(\lambda=1.5\)</span>. The tells us that there is a still a <span class="math inline">\(1.4\)</span>% chance of seeing <span class="math inline">\(5\)</span> homicides in a week <span class="math display">\[
p( X= 5 ) = \frac{e^{ - 1.5 } ( 1.5 )^5 }{5!} = 0.014
\]</span> On average this will happen once every <span class="math inline">\(71\)</span> weeks, nearly once a year.</p>
<p>What’s the chance of having zero homicides in a week?</p>
<p><strong>Solution</strong>:</p>
<p>From the probability distribution we calculate <span class="math display">\[
p( X= 0 ) = \frac{e^{ - 1.5 } ( 1.5 )^0 }{0!} = 0.22
\]</span> In <code>R</code></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dpois</span>(<span class="dv">0</span>, <span class="fl">1.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.22</code></pre>
</div>
</div>
<p>So the probability is 22% You shouldn’t be surprised to see this happening.</p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.83 (True/False (Binomial Distribution))</strong></span> &nbsp;</p>
<ol type="a">
<li>The binomial distribution is a discrete probability distribution.</li>
<li>Assuming the Joe DiMaggio’s batting average is <span class="math inline">\(0.325\)</span> per at-bat and his hits are independent, then he has a probability of about <span class="math inline">\(12\)</span>% of getting more than <span class="math inline">\(2\)</span> hits in <span class="math inline">\(4\)</span> at-bats.</li>
<li>Suppose that you toss a fair coin with probability <span class="math inline">\(0.5\)</span> a head. The probability of getting five heads is a row is less than three percent.</li>
<li>Suppose that you toss a biased coin with probability <span class="math inline">\(0.25\)</span> of getting ahead. The probability of getting five heads out of ten tosses is less than thirty percent.</li>
<li>Suppose that you toss a coin <span class="math inline">\(5\)</span> times. Then there are <span class="math inline">\(10\)</span> ways of getting <span class="math inline">\(3\)</span> heads.</li>
<li>The probability of observing three heads out of five tosses of a fair coin is <span class="math inline">\(0.6\)</span>.</li>
<li>A mortgage bank knows from experience that <span class="math inline">\(2\)</span>% of residential loan swill go into default. Suppose it makes <span class="math inline">\(10\)</span> such loans, then the probability that at least one goes into default is <span class="math inline">\(95\)</span>%.</li>
<li>Jessica Simpson is not a professional bowler and <span class="math inline">\(40\)</span>% of her bowling swings are gutter balls. She is planning to take <span class="math inline">\(90\)</span> blowing swings.The mean and standard deviation of the number of gutter balls is<span class="math inline">\(\mu = 36\)</span> and <span class="math inline">\(\sigma = 3.65\)</span>.</li>
<li>The probability of at least one head when tossing a fair coin <span class="math inline">\(4\)</span> times is <span class="math inline">\(0.9375\)</span>.</li>
<li>The Red Sox are to play the Yankees in a seven game series. Assume that the Red Sox have a 50% chance of winning each game, with the results being independent of each other. Then the probability of the series ending 4-3 in favor of the Red Sox is <span class="math inline">\(0.5^{7}=0.0078\)</span>.</li>
<li>Suppose that <span class="math inline">\(X\)</span> is Binomially distributed with <span class="math inline">\(E(X)=5\)</span> and <span class="math inline">\(Var(X)=2\)</span>,then <span class="math inline">\(n=10\)</span> and <span class="math inline">\(p=0.5\)</span>.</li>
<li>If <span class="math inline">\(X\)</span> is a Bernoulli random variable with probability of success, <span class="math inline">\(p\)</span>,then its variance is <span class="math inline">\(V(X)=p(1-p)\)</span>.</li>
<li>Historically 15% of chips manufactured by a computer company are defective. The probability of a random sample of 10 chips containing exactly one defect is 0.15.</li>
</ol>
<p><strong>Solution</strong>:</p>
<ol type="a">
<li>True.</li>
<li>False. We need to calculate <span class="math display">\[\begin{aligned}P(hits &gt; 2) &amp;=&amp; P(hits = 3) + P(hits = 4) \\&amp;=&amp; \binom{4}{3}\hat{p}^3(1-\hat{p}) + \binom{4}{4}\hat{p}^4 \\&amp;=&amp; 10.4\%\end{aligned}\]</span></li>
<li>False. Given a fair coin with 50% probability for a head,<span class="math inline">\(0.5^5 = 0.0312.&gt; 0.03\)</span></li>
<li>True. This follows from a binomial distribution with <span class="math inline">\(n=10\)</span>. <span class="math inline">\(Prob(5H) = \left ( \begin{array}{c}10\\5 \end{array} \right ) ( 0.25)^5 (0.75)^5 =  0.0583\)</span></li>
<li>True. We see this by computing: <span class="math display">\[\binom{5}{3} = \frac{5!}{3!(5-3)!}=10\]</span></li>
<li>False. <span class="math inline">\(P(3 \; heads)=0.5^{5}=0.03125\)</span>. <span class="math inline">\(10\)</span> such combinations are possible so the probability is <span class="math inline">\(0.3125\)</span></li>
<li>False. Using <span class="math inline">\(P( \mathrm{ at \; least \; one} ) = 1 - P( \mathrm{ none} )\)</span> gives<span class="math inline">\(1 - ( 0.98 )^{10} = 0.1829\)</span></li>
<li>False. From a Binomial distribution <span class="math inline">\(E(X) = np = 90 \times 0.4 = 36\)</span> and the standard deviation<span class="math inline">\(s_X  = \sqrt{ n p ( 1 - p ) } = \sqrt{ 21.6 } = 4.65\)</span></li>
<li>True. <span class="math inline">\(P( \mathrm{ at \; least \; one \; head} ) = 1 - ( 0.5 )^4 = 0.9375\)</span></li>
<li>False. The total wins of the Red Sox is a binomial random variable with<span class="math inline">\(n=7\)</span> and <span class="math inline">\(p=0.5\)</span>. The probability of <span class="math inline">\(4\)</span> wins is then<span class="math inline">\(\binom{7}{4} 0.5^{4} 0.5^{7-4}=35\cdot (0.5)^{7}=0.27\)</span>. Alternatively, if the series is stopped as soon as one time wins 4matches, the probability of a 4-3 outcome in favor of the Red Sox is<span class="math inline">\(\binom{6}{3} 0.5^{3} 0.5^{6-3}\cdot 0.5=0.16\)</span>, since the teams should first reach a 3-3 tie</li>
<li>False. The variance of a <span class="math inline">\(Bin(10, 0.5)\)</span> random variable is<span class="math inline">\(np(1-p) = 2.5\)</span> and not <span class="math inline">\(2\)</span></li>
<li>True. The Bernoulli random variable is the building block of the binomial (<span class="math inline">\(n=1\)</span>) and hence has variance <span class="math inline">\(p(1-p)\)</span></li>
<li>False. The probability of one defective is given by the binomial probability <span class="math inline">\(10 \times 0.15 \times (0.85)^9 = 0.3474\)</span></li>
</ol>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.84 (True/False (Poisson Distribution))</strong></span> &nbsp;</p>
<ol type="a">
<li>If <span class="math inline">\(X \sim Poi (2)\)</span> and <span class="math inline">\(Y \sim Poi (3)\)</span>, then <span class="math inline">\(X+Y \sim Poi (6)\)</span>.</li>
<li>Arsenal are playing Burnley at home in an English Premier League (EPL)game this weekend. They are favorites to win. They have a Poisson distribution for the number of goals they will score with a mean rate of <span class="math inline">\(2.5\)</span> per game. Given this, the odds of Arsenal scoring at least two goals is greater than <span class="math inline">\(50\)</span>%.</li>
<li>Arsenal are playing Swansea tomorrow in an English Premier League (EPL). They are favorites to win. The number of goals they expect to score is Poisson with a mean rate of <span class="math inline">\(2.2\)</span>. Given this, the odds of Arsenal scoring at least one goal is greater than <span class="math inline">\(60\%\)</span>.</li>
<li>Arsenal are playing Liverpool at home in an EPL game this weekend. You think that the number of goals to be scored by both teams follow a Poisson distribution with rates <span class="math inline">\(2.2\)</span> and <span class="math inline">\(1.6\)</span> respectively. Given this, the odds of a scoreless <span class="math inline">\(0-0\)</span> draw are <span class="math inline">\(45-1\)</span>.</li>
<li>Suppose your website gets on average <span class="math inline">\(2\)</span> hits per hour. Then the probability of at least one hit in the next hour is <span class="math inline">\(0.135\)</span>.</li>
<li>The soccer team Manchester United scores on average two goals per game.Given that the distribution of goals is Poisson, the chance that they score two or less goals is <span class="math inline">\(87\)</span>%</li>
</ol>
<p><strong>Solution</strong>:</p>
<ol type="a">
<li>False. By the properties of Poisson distribution,<span class="math display">\[E(X+Y) = E(X) + E(Y) = 2+3 = 5.\]</span> So, X+Y does not follow Poi(6),which has a mean 6</li>
<li>True. Here <span class="math inline">\(S\sim Pois(2.5)\)</span>. We need<span class="math inline">\(P(S \geq 2) = 1 - P(S \leq 1) = 1 - 0.2873 = 0.7127.\)</span> In R we have <code>ppois(1,2.5) = 0.28729</code></li>
<li>True. P(#Goal &gt; 0) = 1-P(#Goal = 0) = <code>1-ppois(0,2.2)</code>=0.89.</li>
<li>False. Assuming each scoring’s ability is independent, we have that:<span class="math display">\[\begin{aligned}Pr(Arsenal=0) &amp;=&amp; \frac{(2.2)^0 e^{-2.2}}{0!} = e^{-2.2} \\Pr(Liverpool=0) &amp;=&amp; \frac{(1.6)^0 e^{-1.6}}{0!} = e^{-1.6} \\\longrightarrow\quad Pr(Arsenal=0\;and\; Liverpool=0) &amp;=&amp; e^{-2.2}\times e^{-1.6} = e^{-3.8}\end{aligned}\]</span>The odds are: <span class="math inline">\(O = (1-e^{-3.8})/e^{-3.8}\)</span> or <span class="math inline">\(43.7\)</span> to <span class="math inline">\(1\)</span>.</li>
<li>False, <code>dpois(0,2) = 0.135</code> <span class="math inline">\(= e^{-2}\)</span> so that <span class="math inline">\(P(hit&gt;1)= 1 - P(hit=0)=0.865\)</span></li>
<li>False. We have that :<span class="math display">\[E[g]=2\quad\Rightarrow\quad g\sim Pois(\lambda=2)\]</span> So, we find the chance that they score two or fewer goals is:<span class="math display">\[P(g\le2)=0.6767.\]</span> In <code>R: ppois(2,2)=0.67667</code></li>
</ol>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.85 (True/False (Normal Distribution))</strong></span> &nbsp;</p>
<ol type="a">
<li>The returns for Google stock on the day of earnings are normally distributed with a mean of <span class="math inline">\(5\)</span>% and a standard deviation of <span class="math inline">\(5\)</span>%. The probability that you will make money on the day of earnings is approximately <span class="math inline">\(60\)</span>%.</li>
<li>For any normal random variable, <span class="math inline">\(X\)</span>, we have <span class="math inline">\(\mathbb{P} \left ( \mu - \sigma &lt; X &lt; \mu + \sigma \right ) = 0.64\)</span>. Hint: You may use <span class="math inline">\(pnorm(1) = 0.841\)</span></li>
<li>Suppose that the annual returns for Facebook stock are normally distributed with a mean of <span class="math inline">\(15\)</span>% and a standard deviation of <span class="math inline">\(20\)</span>%. The probability that Facebook has returns greater than <span class="math inline">\(10\)</span>% for next year is <span class="math inline">\(60\)</span>%</li>
<li>Consider the standard normal random variable <span class="math inline">\(Z \sim N ( 0 , 1 )\)</span>. Then the random variable <span class="math inline">\(-Z\)</span> is also standard normal.</li>
<li>A local bank experiences a <span class="math inline">\(2\)</span>% default rate on residential loans made in a certain city. Suppose that the bank makes <span class="math inline">\(2000\)</span> loans. Then the probability of more than <span class="math inline">\(50\)</span> defaults is <span class="math inline">\(25\)</span> percent.</li>
<li>The Binomial distribution can be approximated by a normal distribution when the number of trials is large.</li>
<li>Let <span class="math inline">\(X \sim N(5, 10)\)</span>. Then <span class="math inline">\(P \left (X&gt;5 \right ) = \frac{1}{2}\)</span>.</li>
<li>Shaquille O’Neal has a <span class="math inline">\(55\)</span>% chance of making a free throw in Basketball. Suppose he has <span class="math inline">\(900\)</span> free throws this year. Then the chance he makes more than <span class="math inline">\(500\)</span> free throws is <span class="math inline">\(45\)</span>%</li>
<li>Suppose that the random variable <span class="math inline">\(X \sim N ( -2 , 4 )\)</span> then <span class="math inline">\(- 2 X \sim N ( 4 , 16 )\)</span>.</li>
<li>Mortimer’s steak house advertises that it is the home of the <span class="math inline">\(16\)</span> ounce steak. They claim that the weight of their steaks is normally distributed with mean <span class="math inline">\(16\)</span> and standard deviation <span class="math inline">\(2\)</span>. If this is so,then the probability that a steak weights less that <span class="math inline">\(14\)</span> ounces is<span class="math inline">\(16\)</span>%.</li>
<li>Advertising costs for a <span class="math inline">\(30\)</span>-second commercial are assumed to be normally distributed with a mean of <span class="math inline">\(10,000\)</span> and a standard deviation of<span class="math inline">\(1000\)</span>. Then the probability that a given commercial costs between<span class="math inline">\(9000\)</span> and <span class="math inline">\(10,000\)</span> is <span class="math inline">\(50\)</span>%.</li>
<li>In a sample of <span class="math inline">\(120\)</span> Zagat’s ratings of Chicago restaurants, the average restaurant had a rating of <span class="math inline">\(19.6\)</span> with a standard deviation of <span class="math inline">\(2.5\)</span>. If you randomly pick a restaurant, the chance that you pick one with with a rating over <span class="math inline">\(25\)</span> is less than <span class="math inline">\(1\)</span>%.</li>
<li>A hospital finds that <span class="math inline">\(20\)</span>% of its bills are at least one month in arrears. A random sample of <span class="math inline">\(50\)</span> bills were taken. Then the probability that less than <span class="math inline">\(10\)</span> bills in the sample were at least one month in arrears is <span class="math inline">\(50\)</span>%</li>
<li>A Chicago radio station believes <span class="math inline">\(30\)</span>% of its listeners are younger than<span class="math inline">\(30\)</span>. Out of a sample of <span class="math inline">\(500\)</span> they find that <span class="math inline">\(250\)</span> are younger than<span class="math inline">\(30\)</span>. This data supports their claim at the <span class="math inline">\(1\)</span>% level.</li>
<li>The probability that a standard normal distribution is more than <span class="math inline">\(1.96\)</span>standard deviations from the mean is <span class="math inline">\(0.05\)</span>.</li>
<li>Suppose that the amount of money spent at Disney World is normally distributed with a mean of $60 and a standard deviation of $15. Then approximately 45% of people spend more than $70 per visit.</li>
<li>A Normal distribution with mean 4 and standard deviation 3.6 will provide a good approximation to a Binomial random variable with parameters <span class="math inline">\(n=40\)</span> and <span class="math inline">\(p= 0.10\)</span>.</li>
<li>If <span class="math inline">\(X\)</span> is normally distributed with mean <span class="math inline">\(3\)</span> and variance <span class="math inline">\(9\)</span> then the probability that <span class="math inline">\(X\)</span> is greater than <span class="math inline">\(1\)</span> is <span class="math inline">\(0.254\)</span>.</li>
</ol>
<p><strong>Solution</strong>:</p>
<ol type="a">
<li>False.<span class="math display">\[P(ret &gt; 0) = 1 - P(ret \leq 0) = 1 - pnorm(0, 0.05, 0.05) = 84.2\%\]</span></li>
<li>False. <span class="math inline">\(pnorm(1) = 0.841\)</span> and <span class="math inline">\(2 \times pnorm(1)-1=0.6828&gt;0.64\)</span></li>
<li>True. Let R denote returns. Convert to standard normal and compute<span class="math display">\[\mathbb{P} \left ( \frac{R- \mu}{\sigma} &gt; \frac{0.1-\mu}{\sigma} \right ) = \mathbb{P} \left ( Z &gt; - 0.25 \right ) = 0.5987\]</span>where <span class="math inline">\(\mu = 0.15\)</span> and <span class="math inline">\(\sigma = 0.2\)</span>.</li>
<li>True. If <span class="math inline">\(X \sim N(0,1)\)</span>, then<span class="math inline">\(-X \sim N\Big(-1(0),(-1)^2\times 1\Big) = N(0,1)\)</span>. Moreover, we have that the pdf of <span class="math inline">\(Z\)</span> and <span class="math inline">\(-Z\)</span> is the same: <span class="math display">\[\begin{aligned}f(z) = \frac{1}{\sqrt{2\pi}}\exp{-\frac{1}{2}z^2} = \frac{1}{\sqrt{2\pi}}\exp{-\frac{1}{2}(-z)^2} = f(-z)\end{aligned}\]</span>Lastly, we can observe that all the even moments are the same due to symmetry and all the odd moments are zero. Thus, they are the same distribution.</li>
<li>False. The probability of having more than 50 defaults can be calculated using a Normal approximation to the <span class="math inline">\(Bin ( 2000, 0.02) \approx N ( 2000 \times 0.02 , 2000 \times 0.02 \times 0.98 )\)</span>.So, the mean is 40 and the standard deviation is 6.261. Therefore, <span class="math display">\[
\begin{aligned}Pr(default &gt; 50) &amp;=&amp; Pr\Big(\frac{default-40}{6.261} - \frac{50-40}{6.261}\Big) = Pr(z&gt;1.5972) \approx .055
\end{aligned}
\]</span></li>
<li>True, if <span class="math inline">\(n\)</span> is large enough, a reasonable approximation to <span class="math inline">\(B(n,p)\)</span> is<span class="math inline">\(N(np,np(1-p))\)</span></li>
<li>True, since the mean is 5, then half the density will be to the right of 5</li>
<li>False. <span class="math inline">\(\mu=np=495,\,\sigma=\sqrt{np(1-p)}=14.92\)</span>. Then<span class="math inline">\(P(X&gt;500)=P(Z&gt;0.335)=1-0.631=36.9\%\)</span></li>
<li>True. We have <span class="math inline">\(- 2 X \sim N ( 4 , 16 )\)</span>.</li>
<li>True. We have<span class="math inline">\(P( X &lt; 14 ) = P \left ( \frac{ X - 16 }{2} &lt;  \frac{ 14 - 16 }{2} \right ) = P( Z &lt; - 1 ) = 0.1587\)</span></li>
<li>False. Required probability is <span class="math inline">\(0.5 - P( Z &lt; -1 ) = 0.3413\)</span></li>
<li>False. <span class="math inline">\(P(X&gt;25)= 1 - P( Z &lt; 2.16) = 0.0154\)</span></li>
<li>True. Using normal approximation, <span class="math inline">\(n=50, p=0.2\)</span>, have<span class="math inline">\(X \sim N ( 10 , 8 )\)</span></li>
<li>False. <span class="math inline">\(n=500\)</span>, <span class="math inline">\(\hat{p} \sim N \left ( p , \frac{p(1-p)}{n} \right )\)</span>and <span class="math inline">\(H_0 : p = 0.3\)</span> versus <span class="math inline">\(H_1 : p \neq 0.3\)</span>. Yields a <span class="math inline">\(99\)</span>% confidence interval of <span class="math inline">\((0.1835 , 0.4165 )\)</span>. Sample proportion doesn’t lie in confidence interval so the data does not support their claim. Or could use a <span class="math inline">\(Z\)</span>-test</li>
<li>True. In a normal distribution, 2.5% of the population is more than 1.96standard deviations below the mean, and 2.5% is more than 1.96 standard deviations above the mean. Hence 5% of the distribution is more than1.96 standard deviations from the mean</li>
<li>False. <span class="math inline">\(z_{70}=\frac{70-60}{15}=0.67\)</span> and 1-F(<span class="math inline">\(z_{70}\)</span>) = 0.25. Hence,about 25% of people spend more than $70 per visit.</li>
<li>False. For <span class="math inline">\(n \geq 40\)</span>, we can approximate a Binomial distribution <span class="math inline">\(Bin(n,p)\)</span> with a normal <span class="math inline">\(N ( np , np (1-p))\)</span>. In this case, we get<span class="math inline">\(np = 4\)</span> and variance <span class="math inline">\(40 \times 0.1 \times 0.9 = 3.6\)</span> or a standard deviation of <span class="math inline">\(1.90\)</span></li>
<li>False. The standardized <span class="math inline">\(Z\)</span>-score is given by <span class="math inline">\(Z= (1-3)/3 = -0.667\)</span>. <span class="math inline">\(P(X&gt; 1) = P(Z&gt; -0.667) = P(Z &lt; 0.667) = 0.7486\)</span></li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb234"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="fl">0.667</span>) <span class="co"># 0.7476139</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.75</code></pre>
</div>
</div>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.86 (Tarone Study)</strong></span> <span class="citation" data-cites="tarone1982use">Tarone (<a href="references.html#ref-tarone1982use" role="doc-biblioref">1982</a>)</span> reports data from 71 studies on tumor incidence in rats</p>
<ol type="a">
<li>In one of the studies, 2 out of 13 rats had tumors. Assume there are 20 possible tumor probabilities: <span class="math inline">\(0.025, 0.075,\ldots, 0.975\)</span>. Assume that the tumor probability is uniformly distributed. Find the posterior distribution for the tumor probability given the data for this study.</li>
<li>Repeat Part a for a second study in which 1 in 18 rats had a tumor.</li>
<li>Parts a and b assumed that each study had a different tumor probability, and that these tumor probabilities were uniformly distributed a priori. Now, assume the tumor probabilities are the same for the two studies, and that this probability has a uniform prior distribution. Find the posterior distribution for the common tumor probability given the combined results from the two studies.</li>
<li>Compare the three distributions for Parts a, b, and c.&nbsp;Comment on your results.</li>
</ol>
<p><strong>Solution</strong>:</p>
<p>We assume that tumors occur independently, with a probability of <span class="math inline">\(\Theta\)</span> of a tumor in each rat in the study. Our data <span class="math inline">\(X\)</span> consist of observations on <span class="math inline">\(N\)</span> rats, in which we record which rats have tumors. We can use either of two methods to represent the likelihood of what we have observed:</p>
<p>Method 1: We list, for each observation, whether or not the rat has a tumor. We multiply together the probability of getting the observation we obtained: <span class="math inline">\(\Theta\)</span> if the rat has a tumor, and 1-<span class="math inline">\(\Theta\)</span> if the rat does not have a tumor. If x out of n rats have tumors, the probability of observing this sequence of observations is <span class="math inline">\(\Theta^k(1-\Theta)^{n-k}\)</span>. Using Method 1, the posterior distribution for <span class="math inline">\(\Theta\)</span> is given by: <span class="math display">\[
g (\theta | x ) = \dfrac{f ( x | \theta ) g (\theta )}{\sum_{i=1}^{20} f ( x | \theta_i ) g (\theta_i )} = \dfrac{\theta^x (1 - \theta )^{n- x}}{\sum_{i=1}^{20} \theta_i^x (1 - \theta_i )^{n - x}}
\]</span></p>
<p>Method 2: We count how many of the rats have tumors. We remember from our previous statistics class that if the tumors occur independently with probability <span class="math inline">\(\Theta\)</span>, the number of rats with tumors out of a total of <span class="math inline">\(n\)</span> rats will have a Binomial distribution with parameters <span class="math inline">\(n\)</span> and <span class="math inline">\(\Theta\)</span>. The probability of getting <span class="math inline">\(k\)</span> tumors is <span class="math display">\[
C_n^k \theta^k (1 - \theta )^{n - k},\quad k = 0, 1, 2, ..., n,\quad \mathrm{where}\quad C_n^k = \dfrac{n!}{k!(n-k)!}
\]</span> Then, the posterior distribution for <span class="math inline">\(\Theta\)</span> is given by: <span class="math display">\[
g (\theta | x ) = \dfrac{f ( x | \theta ) g (\theta )}{\sum_{i=1}^{20} f ( x | \theta_i ) g (\theta_i )} = \dfrac{C_n^k \theta^x (1 - \theta )^{n - x}}{\sum_{i=1}^{20} C_n^k \theta_i^x (1 - \theta_i )^{n - x}}
\]</span></p>
<p>In Method 1, we are representing the likelihood of getting this exact sequence of observations. In Method 2, we are representing the likelihood of getting this number of tumors.</p>
<p>It is clear that the two methods give the same posterior distribution, because the constant <span class="math inline">\(C_n^k\)</span> cancels out of the numerator and denominator of Bayes rule. That is, the number of tumors is a sufficient statistic for <span class="math inline">\(\Theta\)</span>, and the order in which the tumors occur is irrelevant.</p>
<p>Part a. The posterior distribution for <span class="math inline">\(\Theta_1\)</span>, the tumor probability in the first study, is: <span class="math display">\[
g (\theta | x =2) = \dfrac{\theta^2 (1 - \theta )^{11}}{\sum_{i=1}^{20} \theta_i^2 (1 - \theta_i )^{11}}
\]</span></p>
<div class="sourceCode cell-code" id="cb236"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>, <span class="fl">0.05</span>)</span>
<span id="cb236-2"><a href="#cb236-2" aria-hidden="true" tabindex="-1"></a>prior <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">20</span>, <span class="dv">20</span>)</span>
<span id="cb236-3"><a href="#cb236-3" aria-hidden="true" tabindex="-1"></a>tarone <span class="ot">=</span> <span class="cf">function</span>(n,k) {</span>
<span id="cb236-4"><a href="#cb236-4" aria-hidden="true" tabindex="-1"></a>    likelihood <span class="ot">&lt;-</span> theta<span class="sc">^</span>k <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> theta)<span class="sc">^</span>(n<span class="sc">-</span>k)</span>
<span id="cb236-5"><a href="#cb236-5" aria-hidden="true" tabindex="-1"></a>    posterior <span class="ot">&lt;-</span> likelihood <span class="sc">*</span> prior <span class="sc">/</span> <span class="fu">sum</span>(likelihood <span class="sc">*</span> prior)</span>
<span id="cb236-6"><a href="#cb236-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">data.frame</span>(theta, likelihood, posterior)))</span>
<span id="cb236-7"><a href="#cb236-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">barplot</span>(posterior, <span class="at">names.arg =</span> theta, <span class="at">xlab =</span> <span class="fu">expression</span>(theta), <span class="at">ylab =</span> <span class="st">"Pr(theta | X)"</span>)</span>
<span id="cb236-8"><a href="#cb236-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(posterior)</span>
<span id="cb236-9"><a href="#cb236-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb236-10"><a href="#cb236-10" aria-hidden="true" tabindex="-1"></a>posta <span class="ot">=</span> <span class="fu">tarone</span>(<span class="dv">13</span>,<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel" data-layout-align="center" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<pre><code>## 
## 
## | theta| likelihood| posterior|
## |-----:|----------:|---------:|
## |  0.03|          0|      0.03|
## |  0.08|          0|      0.13|
## |  0.12|          0|      0.20|
## |  0.18|          0|      0.20|
## |  0.22|          0|      0.17|
## |  0.28|          0|      0.12|
## |  0.33|          0|      0.08|
## |  0.38|          0|      0.04|
## |  0.43|          0|      0.02|
## |  0.48|          0|      0.01|
## |  0.52|          0|      0.00|
## |  0.58|          0|      0.00|
## |  0.63|          0|      0.00|
## |  0.68|          0|      0.00|
## |  0.73|          0|      0.00|
## |  0.78|          0|      0.00|
## |  0.83|          0|      0.00|
## |  0.88|          0|      0.00|
## |  0.92|          0|      0.00|
## |  0.98|          0|      0.00|</code></pre>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ex_files/figure-html/unnamed-chunk-67-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
<p>Part b. The posterior distribution for <span class="math inline">\(\Theta_2\)</span>, the tumor probability in the second study, is: <span class="math display">\[
g (\theta | x =2) = \dfrac{\theta (1 - \theta )^{17}}{\sum_{i=1}^{20} \theta_i(1 - \theta_i )^{17}}
\]</span></p>
<div class="sourceCode cell-code" id="cb238"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a>postb  <span class="ot">=</span> <span class="fu">tarone</span>(<span class="dv">18</span>,<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel" data-layout-align="center" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<pre><code>## 
## 
## | theta| likelihood| posterior|
## |-----:|----------:|---------:|
## |  0.03|       0.02|      0.27|
## |  0.08|       0.02|      0.33|
## |  0.12|       0.01|      0.21|
## |  0.18|       0.01|      0.11|
## |  0.22|       0.00|      0.05|
## |  0.28|       0.00|      0.02|
## |  0.33|       0.00|      0.01|
## |  0.38|       0.00|      0.00|
## |  0.43|       0.00|      0.00|
## |  0.48|       0.00|      0.00|
## |  0.52|       0.00|      0.00|
## |  0.58|       0.00|      0.00|
## |  0.63|       0.00|      0.00|
## |  0.68|       0.00|      0.00|
## |  0.73|       0.00|      0.00|
## |  0.78|       0.00|      0.00|
## |  0.83|       0.00|      0.00|
## |  0.88|       0.00|      0.00|
## |  0.92|       0.00|      0.00|
## |  0.98|       0.00|      0.00|</code></pre>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ex_files/figure-html/unnamed-chunk-68-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
<p>Part c.&nbsp;If the tumor probabilities are the same in the two studies, it is appropriate to treat them as a single study in which 3 rats out of 31 have a tumor. The posterior distribution for <span class="math inline">\(\Theta\)</span>, the common tumor probability, is: <span class="math display">\[
g (\theta | x =2) = \dfrac{\theta^3 (1 - \theta )^{28}}{\sum_{i=1}^{20} \theta_i^3(1 - \theta_i )^{28}}
\]</span></p>
<div class="sourceCode cell-code" id="cb240"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a>postc <span class="ot">=</span> <span class="fu">tarone</span>(<span class="dv">31</span>,<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel" data-layout-align="center" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<pre><code>## 
## 
## | theta| likelihood| posterior|
## |-----:|----------:|---------:|
## |  0.03|          0|      0.06|
## |  0.08|          0|      0.34|
## |  0.12|          0|      0.34|
## |  0.18|          0|      0.18|
## |  0.22|          0|      0.07|
## |  0.28|          0|      0.02|
## |  0.33|          0|      0.00|
## |  0.38|          0|      0.00|
## |  0.43|          0|      0.00|
## |  0.48|          0|      0.00|
## |  0.52|          0|      0.00|
## |  0.58|          0|      0.00|
## |  0.63|          0|      0.00|
## |  0.68|          0|      0.00|
## |  0.73|          0|      0.00|
## |  0.78|          0|      0.00|
## |  0.83|          0|      0.00|
## |  0.88|          0|      0.00|
## |  0.92|          0|      0.00|
## |  0.98|          0|      0.00|</code></pre>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ex_files/figure-html/unnamed-chunk-69-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
<p>It is useful to verify that we get the same posterior distribution by using Method 2 to calculate the likelihood of the data. It is also useful to verify that we would get the same results in Part c if we used the posterior distribution from Part a as the prior distribution for Part c, and the likelihood from Part b as the likelihood for part c.&nbsp;That is, we would get the same result from a two-step process, in which we started with a uniform prior distribution, incorporated the results from the first study to obtain a posterior distribution, and then incorporated the results from the second study to get a new posterior distribution.</p>
<p>Part d. We can compare the distributions more easily if we plot the prior distribution, the posterior distributions for the parameters of the two individual studies, and the combined posterior distribution together (see below). We see that the posterior distribution from the first study puts more probability on higher values of <span class="math inline">\(\Theta\)</span> than the posterior distribution for the second study. This is not surprising, because a higher proportion of rats in the first study had tumors. There is a great deal of overlap in the two distributions, which suggests that the two probabilities may be the same. Thus, it is reasonable to consider combining the two samples. If there had been very little overlap in the posterior distributions from Parts a and b, it would not have been reasonable to combine the studies. Later in the semester, we will look more carefully at the problem of when to combine probabilities and when to estimate them separately. When the studies are combined, the posterior distribution is narrower than the posterior distribution for either of the two individual studies, with less probability on very low and very high values of <span class="math inline">\(\Theta\)</span>. Note that the combined distribution is consistent with both of the individual distributions, in the sense that it places high probability on values that also have high probability in the other two distributions. The combined distribution is more concentrated around values close to the combined sample proportion of about 1 in 10.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb242"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a>allDist<span class="ot">=</span><span class="fu">rbind</span>(prior,posta,postb,postc) </span>
<span id="cb242-2"><a href="#cb242-2" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(allDist,<span class="at">main=</span><span class="st">"Prior and Posterior Distributions for TumorProbability"</span>,<span class="at">xlab=</span><span class="st">"Theta"</span>,<span class="at">ylab=</span><span class="st">"Probability"</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">"mediumpurple"</span>,<span class="st">"lightblue"</span>,<span class="st">"pink"</span>,<span class="st">"lightgreen"</span>), <span class="at">border=</span><span class="fu">c</span>(<span class="st">"darkviolet"</span>,<span class="st">"darkblue"</span>, <span class="st">"red"</span>,<span class="st">"darkgreen"</span>),<span class="at">names.arg=</span>theta, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Prior"</span>,<span class="st">"Study 1"</span>, <span class="st">"Study 2"</span>, <span class="st">"Both Studies"</span>), <span class="at">beside=</span><span class="cn">TRUE</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ex_files/figure-html/unnamed-chunk-70-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.87</strong></span> Let <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> be independent and identically distributed as a <span class="math inline">\(Exp(1)\)</span> distribution. Their joint distribution is given by</p>
<p><span class="math display">\[
f_{X,Y}(x,y) = \exp(-x)\exp(-y) \mathrm{ , where} \; \; 0 &lt; x,y &lt; \infty
\]</span></p>
<ol type="a">
<li>Use the convolution formula to find the distribution of <span class="math inline">\(X + \frac{1}{2} Y\)</span>. Check your answer by also using a moment generating function approach.</li>
<li>Guess want happens if you consider <span class="math inline">\(X + \frac{1}{2} Y + \frac{1}{3} Z\)</span> where <span class="math inline">\(Z\)</span> is also <span class="math inline">\(Exp(1)\)</span>?</li>
</ol>
<p><strong>Solution</strong>:</p>
<p>First, we need to show the family of exponential distributions is closed under scaling. Let <span class="math inline">\(Z = aY\)</span> so that <span class="math display">\[P(Z \leq z) = P(Y \leq z/a) = 1 - \exp(-z/a)\]</span> Therefore, <span class="math inline">\(Z \sim Exp(1/a)\)</span> and <span class="math inline">\(f_{aY} = \frac{1}{a}\exp(-Y/a)\)</span>.</p>
<p>Let <span class="math inline">\(W = X + \frac{1}{2}Y\)</span>. The density function of W is <span class="math display">\[\begin{aligned}     f_W(W = w) &amp;=&amp; P(X+\frac{1}{2}Y = w) \\     &amp;=&amp; \int_0^w f_{X,\frac{1}{2}Y}(x, w-x)dx  \\     &amp;=&amp; \int_0^w f_X(x)f_{\frac{1}{2}Y}(w-x)dx \\     &amp;=&amp; \exp(-w)*\left(\frac{1}{2}\exp(-2w)\right)\end{aligned}\]</span></p>
<p><span class="math display">\[\begin{aligned}     E(W) &amp;=&amp; \int w*f_W(w)dw \\     &amp;=&amp; \frac{3}{2}\left(\int w*\frac{1}{3}\exp(-3w)dw\right) \\     &amp;=&amp; \frac{3}{2} = E(X) + \frac{1}{2}E(Y)\end{aligned}\]</span></p>
<p>By induction, the density function for <span class="math inline">\(W = X + \frac{1}{2} Y + \frac{1}{3} Z\)</span> should be <span class="math inline">\(\exp(-w)*\left(\frac{1}{2}\exp(-2w)\right)*\left(\frac{1}{3}\exp(-3w)\right)\)</span></p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.88 (Poisson MLE vs Baye)</strong></span> You are developing tools for monitoring number of advertisemnt clicks on a website. You have observed the following data:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb243"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">7</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">7</span>,<span class="dv">5</span>,<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>which represents the number of clicks every minute over the last 10 minutes. You assume that the number of clicks per minute follows a Poisson distribution with parameter <span class="math inline">\(\lambda\)</span>.</p>
<ol type="a">
<li>Plot likelihood function for <span class="math inline">\(\lambda\)</span>.</li>
<li>Estimate <span class="math inline">\(\lambda\)</span> using Maximum Likelihood Estimation (MLE). MLE is the value of <span class="math inline">\(\lambda\)</span> that maximizes the likelihood function or log-likelihood function. Maximizing likelihood is equivalent to maximizing the log-likelihood function (log is a monotonically increasing function).</li>
<li>Using <code>barplot</code>, plot the predicted vs observed probabilities of for number of clicks from 1 to 7. Is the model a good fit?</li>
<li>Assume that you know, that historically, the average number of clicks per minute is 4 and variance is also 4. Those numbers were valculated over a long period of time. You can use this information as a prior. Assume that the prior distribution is <span class="math inline">\(Gamma(\alpha,\beta)\)</span>. What would be appropriate values for <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> that would represent this prior information?</li>
<li>Find the posterior distribution for <span class="math inline">\(\lambda\)</span> and calculate the Bayesian estimate for <span class="math inline">\(\lambda\)</span> as the expectation over the posterior.</li>
<li>After collecting data for a few days, you realized that about 20% of the observations are zero. How this information would change your prior distribution? This is an open-ended question.</li>
</ol>
<p><em>Hint</em>: For part c, you can use the following code to calculate the predicted probabilities for the number of clicks from 0 to 5.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a>tb <span class="ot">=</span> <span class="fu">table</span>(y)</span>
<span id="cb244-2"><a href="#cb244-2" aria-hidden="true" tabindex="-1"></a>observed <span class="ot">=</span> tb<span class="sc">/</span><span class="fu">length</span>(y)</span>
<span id="cb244-3"><a href="#cb244-3" aria-hidden="true" tabindex="-1"></a>predicted <span class="ot">=</span> <span class="fu">dpois</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>,lambda_mle)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Solution</strong>: a)</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb245"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="fl">0.1</span>)</span>
<span id="cb245-2"><a href="#cb245-2" aria-hidden="true" tabindex="-1"></a>likelihood <span class="ot">=</span> <span class="fu">sapply</span>(lambda, <span class="cf">function</span>(l) <span class="fu">prod</span>(<span class="fu">dpois</span>(y, l)))</span>
<span id="cb245-3"><a href="#cb245-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lambda, likelihood, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">xlab =</span> <span class="fu">expression</span>(lambda), <span class="at">ylab =</span> <span class="st">"Likelihood"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ex_files/figure-html/unnamed-chunk-73-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<ol start="2" type="a">
<li></li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb246"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a>lambda_mle <span class="ot">=</span> <span class="fu">optim</span>(<span class="at">par =</span> <span class="dv">1</span>, <span class="at">fn =</span> <span class="cf">function</span>(l) <span class="sc">-</span><span class="fu">sum</span>(<span class="fu">dpois</span>(y, l, <span class="at">log =</span> <span class="cn">TRUE</span>)))<span class="sc">$</span>par</span>
<span id="cb246-2"><a href="#cb246-2" aria-hidden="true" tabindex="-1"></a>lambda_mle</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 4</code></pre>
</div>
</div>
<p>Alternatively, the likelihood function is <span class="math display">\[
L(\lambda) = \prod_{i=1}^{n} \frac{\lambda^{y_i}e^{-\lambda}}{y_i!}
\]</span> and the log-likelihood function is <span class="math display">\[
\log L(\lambda) = \sum_{i=1}^{n} y_i \log(\lambda) - n\lambda
\]</span> The MLE is the value of <span class="math inline">\(\lambda\)</span> that maximizes the log-likelihood function. We can find the MLE by taking the derivative of the log-likelihood function with respect to <span class="math inline">\(\lambda\)</span> and setting it equal to zero. This gives <span class="math display">\[
\frac{d}{d\lambda} \log L(\lambda) = \frac{1}{\lambda} \sum_{i=1}^{n} y_i - n = 0
\]</span> Solving for <span class="math inline">\(\lambda\)</span> gives <span class="math display">\[
\lambda = \frac{1}{n} \sum_{i=1}^{n} y_i.
\]</span> A simple average of the data gives the MLE for <span class="math inline">\(\lambda\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb248"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 4</code></pre>
</div>
</div>
<ol start="3" type="a">
<li></li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb250"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">=</span> <span class="fu">table</span>(y)<span class="sc">/</span><span class="fu">length</span>(y)</span>
<span id="cb250-2"><a href="#cb250-2" aria-hidden="true" tabindex="-1"></a>poisson <span class="ot">=</span> <span class="fu">dpois</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>,lambda_mle)</span>
<span id="cb250-3"><a href="#cb250-3" aria-hidden="true" tabindex="-1"></a>d <span class="ot">=</span> <span class="fu">cbind</span>(pred, poisson)</span>
<span id="cb250-4"><a href="#cb250-4" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">t</span>(d),<span class="at">names.arg=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>, <span class="at">xlab =</span> <span class="st">"Clicks"</span>, <span class="at">ylab =</span> <span class="st">"Frequency"</span>, <span class="at">beside =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ex_files/figure-html/unnamed-chunk-76-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<ol start="4" type="a">
<li>We know that <span class="math inline">\(E(X) = \alpha/\beta = 4\)</span> and <span class="math inline">\(Var(X) = \alpha/\beta^2 = 4\)</span>. For example, <span class="math inline">\(\alpha = 4\)</span> and <span class="math inline">\(\beta = 1\)</span> would match the historical data.</li>
<li></li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb251"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">=</span> <span class="dv">4</span></span>
<span id="cb251-2"><a href="#cb251-2" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb251-3"><a href="#cb251-3" aria-hidden="true" tabindex="-1"></a>alphas <span class="ot">=</span> alpha <span class="sc">+</span> <span class="fu">sum</span>(y)</span>
<span id="cb251-4"><a href="#cb251-4" aria-hidden="true" tabindex="-1"></a>betas <span class="ot">=</span> beta <span class="sc">+</span> <span class="fu">length</span>(y)</span>
<span id="cb251-5"><a href="#cb251-5" aria-hidden="true" tabindex="-1"></a>lambda_bayes <span class="ot">=</span> alphas<span class="sc">/</span>betas</span>
<span id="cb251-6"><a href="#cb251-6" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">data.frame</span>(<span class="at">alpha =</span> alphas, <span class="at">beta =</span> betas, <span class="at">lambda_bayes =</span> lambda_bayes))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">alpha</th>
<th style="text-align: right;">beta</th>
<th style="text-align: right;">lambda_bayes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">83</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">4</td>
</tr>
</tbody>
</table>
</div>
</div>
<ol start="6" type="a">
<li>We can use a mixture prior with one component concentrated around zero and another component concentrated around the mean that is calculated by removing zeroes from the data. The component weights are 0.2 and 0.8 respectively.</li>
</ol>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.89 (Exponential Distribution)</strong></span> Let <span class="math inline">\(x_1, x_2,\ldots, x_N\)</span> be an independent sample from the exponential distribution with density <span class="math inline">\(p (x | \lambda) = \lambda\exp (-\lambda x)\)</span>, <span class="math inline">\(x \ge 0\)</span>, <span class="math inline">\(\lambda&gt; 0\)</span>. Find the maximum likelihood estimate <span class="math inline">\(\lambda_{\text{ML}}\)</span>. Choose the conjugate prior distribution <span class="math inline">\(p (\lambda)\)</span>, and find the posterior distribution <span class="math inline">\(p (\lambda | x_1,\ldots, x_N)\)</span> and calculate the Bayesian estimate for <span class="math inline">\(\lambda\)</span> as the expectation over the posterior.</p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.90 (Bernoulli Baeys)</strong></span> We have <span class="math inline">\(N\)</span> Bernoulli trials with success probability in each trial being equal to <span class="math inline">\(q\)</span>, we observed <span class="math inline">\(k\)</span> successes. Find the conjugate distribution <span class="math inline">\(p (q)\)</span>. Find the posterior distribution <span class="math inline">\(p (q | k, N)\)</span> and its expectation.</p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.91 (Exponential Family (Gamma))</strong></span> Write density function of Gamma distribution in a standard exponential family form. Find <span class="math inline">\(Ex\)</span> and <span class="math inline">\(E\log x\)</span> by differentiating the normalizing constant.</p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.92 (Exponential Family (Binomial))</strong></span> Write density function of Binomial distribution in a standard exponential family form. Find <span class="math inline">\(Ex\)</span> and <span class="math inline">\(Var x\)</span> by differentiating the normalizing constant.</p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.93 (Normal)</strong></span> Let <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> are <strong>independent</strong> <span class="math inline">\(N(0,1)\)</span> random variables. Let <span class="math display">\[Y_1 = X_1^2 + X_2^2, \quad Y_2 = \frac{X_1}{\sqrt{Y_1}}\]</span></p>
<ol type="a">
<li>Find joint distribution of <span class="math inline">\(Y_1\)</span> and <span class="math inline">\(Y_2\)</span>.</li>
<li>Are <span class="math inline">\(Y_1\)</span> and <span class="math inline">\(Y_2\)</span> independent or not?</li>
<li>Can you interpret the result geometrically?</li>
</ol>
<p>Density of <span class="math inline">\(N(\mu, \sigma^2)\)</span> is <span class="math display">\[f(x) = \frac{1}{\sqrt{2\pi\sigma^2}} e^{-\frac{(x-\mu)^2}{2\sigma^2}}\]</span></p>
</div>
</section>
<section id="ab-testing-1" class="level2" data-number="27.5">
<h2 data-number="27.5" class="anchored" data-anchor-id="ab-testing-1"><span class="header-section-number">27.5</span> AB Testing</h2>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.94 (A/B Testing)</strong></span> During a recent breakout of the flu, 850 out 6,224 people diagnosed with the virus presented severe symptoms. During the same flu season, a experimental anti-virus drug was being tested. The drug was given to 238 people with the flu and only 6 of them developed severe symptoms. Based on this information, can you conclude, for sure, that the drug is a success?</p>
<p><strong>Solution</strong>:</p>
<p>Null hypothesis is <span class="math inline">\(H_0: p_1 - p_2 = 0\)</span>, <span class="math inline">\(H_a: p_1 - p_2 \neq 0\)</span>. <span class="math display">\[
\hat{p}_1 = \frac{850}{6224} = 0.136, \quad \hat{p}_2 = \frac{6}{238} = 0.025, \quad \hat{p}_1 - \hat{p}_2 = 0.136-0.025 = 0.111
\]</span> The standard error is <span class="math display">\[
s = \sqrt{\frac{0.136 \times (1 - 0.136)}{6224} + \frac{0.025 \times ( 1- 0.025)}{238} }= 0.011
\]</span> t-stat is <span class="math display">\[
t = \frac{\hat{p}_1 - \hat{p}_2 - 0}{s} = \frac{0.136 - 0.025}{0.011} = 10.09 &gt; 1.96
\]</span></p>
<p>Yes, given this information we can conclude that the drug is working.</p>
<p>If you do confidence interval, the <span class="math inline">\(95\%\)</span> confidence interval of <span class="math inline">\(p_1 - p_2\)</span> is <span class="math display">\[
[0.111 - 1.96 \times 0.011, 0.111 + 1.96\times 0.011] = [0.089, 0.133]
\]</span> which doesn’t contain 0. We reject the null hypothesis.</p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.95 (Tesla Supplier)</strong></span> Tesla purchases Lithium as a raw material for their batteries from either of two suppliers and is concerned about the amounts of impurity the material contains. The percentage impurity levels in consignments of the Lithium follows closely a normal distribution with the means and standard deviations given in the table below. The company is particularly anxious that the impurity level not exceed <span class="math inline">\(5\)</span>% and wants to purchase from the supplier who is ore likely to meet that specification.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th style="text-align: center;">Mean</th>
<th style="text-align: center;">Standard Deviation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Supplier A</td>
<td style="text-align: center;">4.4</td>
<td style="text-align: center;">0.4</td>
</tr>
<tr class="even">
<td>Supplier B</td>
<td style="text-align: center;">4.2</td>
<td style="text-align: center;">0.6</td>
</tr>
</tbody>
</table>
<ol type="a">
<li>Which supplier should be chosen?</li>
<li>What if Supplier B implements some quality control which has no effect on the standard deviation but raises their mean to <span class="math inline">\(4.6\)</span>?</li>
</ol>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.96 (Red Sox)</strong></span> On September 24, 2003, Pete Thamel in the New York Times reported that the Boston Red Sox had been accused of cheating by another American League Team. The claim was that the Red Sox had a much better winning record at home games than at games played in other cities.</p>
<p>The following table provides the wins and losses for home and away games for the Red Sox in the 2003 season</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th style="text-align: center;">Record</th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Team</td>
<td style="text-align: center;">Home Wins</td>
<td>Home Losses</td>
<td>Away Wins</td>
<td>Away Losses</td>
</tr>
<tr class="even">
<td>Boston Red Sox</td>
<td style="text-align: center;">53</td>
<td>28</td>
<td>42</td>
<td>39</td>
</tr>
</tbody>
</table>
<p>Is there any evidence that the proportion of Home wins is significantly different from home and away games?</p>
<p>Discuss any other issues that are relevant.</p>
<p>Hint: a 95% confidence interval for a difference in proportions <span class="math inline">\(p_1 - p_2\)</span> is given by <span class="math display">\[
( \hat{p}_1 - \hat{p}_2 ) \pm 1.96
\sqrt{ \frac{ \hat{p}_1 ( 1 - \hat{p}_1 ) }{ n_1 }  +
\frac{ \hat{p}_2 ( 1 - \hat{p}_2 ) }{ n_2 } }
\]</span></p>
<p><strong>Solution</strong>:</p>
<p>The home and away winning proportions are given by <span class="math display">\[
p_1 = \frac{53}{81} = 0.654  \; \; \text{ and} \; \;  \text{ Var} = \frac{ p_1 ( 1- p_1 ) }{ n_1 } = \frac{53 \times 28 }{81^3} = 0.0028
\]</span> and <span class="math display">\[
p_2 = \frac{42}{81} = 0.518 \; \; \text{ and} \; \;  \text{ Var} = \frac{ p_2 ( 1- p_2 ) }{ n_2 } = \frac{42 \times 39}{81^3} = 0.0031
\]</span> Can either do the problem as a confidence interval or a hypothesis test.</p>
<p>For the CI, we get <span class="math display">\[
\left (  \frac{53}{81} - \frac{42}{81} \right ) \pm 1.96 \sqrt{  \frac{53 \times 28 }{81^3} + \frac{42 \times 39}{81^3} } = ( 0.286 , -0.014 )
\]</span> As the confidence interval contains zero there is no significant difference at the <span class="math inline">\(5\)</span>% level.</p>
<p>For the hypothesis test we have the null hypothesis that <span class="math inline">\(H_0 : p_1 = p_2\)</span> versus <span class="math inline">\(H_1 : p_1 \neq p_2\)</span>. Then the test statistic is approximately normally distributed (large <span class="math inline">\(n = n_1 + n_2\)</span>) is and given by <span class="math display">\[Z = \frac{ 0.654 - 0.518 }{\sqrt{ 0.0059} } = 1.875\]</span> At the <span class="math inline">\(5\)</span>% level the critical value is <span class="math inline">\(1.96\)</span> and so there’s not statistical significance.</p>
<p>The major issue here is whether you should test whether the proportions from home and away are different. There might be a significant home team bias in general and we should test to see if the Red Sox advantage is significantly different from that. All things else equal this will reduce the significance of the Red Sox home advantage bias.</p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.97 (Myocardial Infarction)</strong></span> In a five year study of the effects of aspirin on Myocardial Infarction (MI), or heart attack, you have the following dataset on the reduction of the probability of getting MI from taking aspirin versus a Placebo, or control.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Treatment</th>
<th style="text-align: center;">with MI</th>
<th style="text-align: center;">without MI</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Placebo</td>
<td style="text-align: center;">198</td>
<td style="text-align: center;">10845</td>
</tr>
<tr class="even">
<td style="text-align: center;">Aspirin</td>
<td style="text-align: center;">104</td>
<td style="text-align: center;">10933</td>
</tr>
</tbody>
</table>
<ol type="a">
<li>Find a <span class="math inline">\(95\)</span>% confidence interval for the difference in proportions <span class="math inline">\(p_1-p_2\)</span>.</li>
<li>Perform a hypothesis test of the null <span class="math inline">\(H_0 : p_1 = p_2\)</span> at a <span class="math inline">\(1\)</span>% significance level.</li>
</ol>
<p><strong>Solution</strong>:</p>
<p>Converting to proportions:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Treatment</th>
<th style="text-align: center;">with MI</th>
<th style="text-align: center;">without MI</th>
<th style="text-align: center;">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Placebo</td>
<td style="text-align: center;">0.01793</td>
<td style="text-align: center;">0.98207</td>
<td style="text-align: center;">11043</td>
</tr>
<tr class="even">
<td style="text-align: center;">Aspirin</td>
<td style="text-align: center;">0.00942</td>
<td style="text-align: center;">0.99058</td>
<td style="text-align: center;">11037</td>
</tr>
</tbody>
</table>
<ol type="a">
<li>The CI for a difference in proportion is: <span class="math display">\[(\hat{p}_1-\hat{p}_2)\pm z_{\alpha/2}\sqrt{\frac{\hat{p}_1(1-\hat{p}_1)}{n_1}+\frac{\hat{p}_2(1-\hat{p}_2)}{n_2}}\]</span> <span class="math display">\[=(0.01793-0.00942)\pm 1.96\sqrt{\frac{0.01793(1-0.01793)}{11043}+\frac{0.00942(1-0.00942)}{11037}}\]</span> <span class="math display">\[=0.00851\pm 1.96\sqrt{0.0000015945+0.0000008454}=0.00851\pm 1.96\sqrt{0.0000024399}\]</span> <span class="math display">\[=0.00851\pm 1.96*0.00156205=0.00851\pm 0.00306\]</span> Therefore, the CI for the difference in these proportions is: <span class="math display">\[(0.00545,0.01157)\]</span></li>
<li>At the 1% level, we would have a implied CI for the difference in proportions of: <span class="math display">\[=0.00851\pm 2.58*0.00156205=0.00851\pm 0.00403\]</span> Therefore, the CI for the difference in these proportions is: <span class="math display">\[(0.00448,0.01254)\]</span> We can see that this CI does not contain 0, so therefore we can reject the null that <span class="math inline">\(p_1=p_2\)</span> at the 1% significance level.</li>
</ol>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.98 (San Francisco Giants)</strong></span> In October 1992, the ownership of the San Francisco Giants considered a sale of the franchise that would have resulted in a move to Florida. A survey from the <em>San Francisco Chronicle</em> found that in a random sample of <span class="math inline">\(625\)</span> people, 50.7% would be disappointed by the move. Find a 95% confidence interval of the population proportion</p>
<p><strong>Solution</strong>:</p>
<p>The 95% CI is found by <span class="math display">\[
\hat{p} \pm z_{\alpha /2}\sqrt{\frac{\hat{p}(1-\hat{p})}{n}}=.507\pm 1.96\sqrt{\frac{.507\times .493}{625}}=.507\pm 2\times .020=\left(.467,.547\right)
\]</span></p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.99 (Pfizer)</strong></span> Pfizer introduced Viagra in early 1998 and during <span class="math inline">\(1998\)</span> of the <span class="math inline">\(6\)</span> million Viagra users <span class="math inline">\(77\)</span> died from coronary problems such as heart attacks. Pfizer claimed that this rate is no more than that in the general population.</p>
<p>You find from a clinical study of <span class="math inline">\(1,500,000\)</span> men who were not on Viagra that <span class="math inline">\(11\)</span> of then died of coronary problems in the same length of time during the <span class="math inline">\(77\)</span> Viagra users who dies in <span class="math inline">\(1998\)</span>.</p>
<p>Do you agree with Pfizer’s claim that the proportion of Viagra users dying from coronary problems is no more than that of other comparable men?</p>
<p><strong>Solution</strong>:</p>
<p>A 95% confidence interval for a difference in proportions <span class="math inline">\(p_1 - p_2\)</span> is given by <span class="math display">\[( \hat{p}_1 - \hat{p}_2 ) \pm 1.96
\sqrt{ \frac{ \hat{p}_1 ( 1 - \hat{p}_1 ) }{ n_1 }  +
\frac{ \hat{p}_2 ( 1 - \hat{p}_2 ) }{ n_2 } }\]</span></p>
<p>Can do a confidence interval or a <span class="math inline">\(Z\)</span>-score test.</p>
<p>With Viagra, <span class="math inline">\(\hat{p}_1 = 77/6000000 = 0.00001283\)</span> and without Viagra <span class="math inline">\(\hat{p}_2 = 11/1500000 = 0.00000733\)</span>. Need to test whether these are equal.</p>
<p>With a <span class="math inline">\(95\)</span>% confidence interval for <span class="math inline">\(( p_1 - p_2 )\)</span>, you get an interval <span class="math inline">\(( 0.00000549 , 0.0000055 )\)</span> which doesn’t contain zero. Hence evidence that the proportion is higher.</p>
<p>Measured very accurately due to the large sample sizes.</p>
<p>With testing might use a one-sided test and an <span class="math inline">\(\alpha\)</span> of <span class="math inline">\(0.01\)</span>.</p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.100 (Voter: CI)</strong></span> Given a random sample of <span class="math inline">\(1000\)</span> voters, <span class="math inline">\(400\)</span> say they will vote for Donald Trump if the Republican nomination for the 2016 US Presidential Election. Given that he gets the nomination, a <span class="math inline">\(95\%\)</span> confidence interval for the true proportion of voters that will vote for him includes <span class="math inline">\(45\%\)</span>.</p>
<p><strong>Solution</strong>:</p>
<p>False, <span class="math inline">\(\hat p = \frac{400}{1000} = 40\%\)</span> and <span class="math display">\[
s_{\hat p} = \sqrt{\frac{\hat p(1-\hat p)}{1000}} = 0.0072
\]</span> The <span class="math inline">\(95\%\)</span> confidence interval is <span class="math inline">\([0.4 \pm] 0.0142\)</span>. which does not include <span class="math inline">\(45\%\)</span>.</p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.101 (Survey AB testing)</strong></span> In a pre-election survey of <span class="math inline">\(435\)</span> voters, <span class="math inline">\(10\)</span> indicated that they planned to vote for Ralph Nader. In a separate survey of <span class="math inline">\(500\)</span> people, <span class="math inline">\(250\)</span> said they planned to vote for George Bush.</p>
<ol type="a">
<li>Perform a hypothesis test at the 5% level for the hypothesis that Nader will get 3% or less of the vote.</li>
<li>Find a 95% confidence interval for the difference in the proportion of people that will vote for George Bush versus Ralph Nader.</li>
</ol>
<p><strong>Solution</strong>:</p>
<ol type="a">
<li><span class="math inline">\(H_{0}:p\leq 0.03\)</span> <span class="math inline">\(H_{1}:p&gt;0.03\)</span> <span class="math inline">\(z=\frac{\hat{p}-p_{0}}{\sqrt{\frac{p_{0}(1-p_{0})}{n}}}\)</span> where <span class="math inline">\(\hat{p}=\frac{10}{435}=0.023\)</span> and <span class="math inline">\(p_{0}=0.03\)</span>. Hence, <span class="math inline">\(z=\frac{0.023-0.03}{\sqrt{\frac{0.03\cdot 0.97}{435}}}=-0.86\)</span>, <span class="math inline">\(z_{\alpha }=1.65\)</span> (one-sided test!) so we do not reject <span class="math inline">\(H_{0}\)</span> as <span class="math inline">\(z&lt;z_{\alpha }\)</span>.</li>
<li>We know that the confidence interval is given by <span class="math inline">\((\hat{p}_{1}-\hat{p}_{2})\pm 1.96\sqrt{\frac{\hat{p}_{1}(1-\hat{p}_{1})}{n_{1}}+\frac{\hat{p}_{2}(1-\hat{p}_{2})}{n_{2}}}\)</span> and we have <span class="math inline">\(\hat{p}_{1}=\frac{250}{500}=0.5\)</span> and <span class="math inline">\(\hat{p}_{2}=\frac{10}{435}=0.023\)</span>. Plugging everything into the formula we find: <span class="math inline">\((0.5-0.023)\pm 1.96\sqrt{\frac{0.5\cdot 0.5}{500}+\frac{0.023\cdot 0.977}{435}}=[0.431,0.523]\)</span></li>
</ol>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.102 (Significance Tests.)</strong></span> Some defendants in southern states have challenged verdicts made during the ’50s and ’60s, because of possible unfair jury selections. Juries are supposed to be selected at random from the population. In one specific case, only 12 jurors in an 80 person panel were African American. In the state in question, 50% of the population was African American. Could a jury with 12 African Americans out of 80 people be the result of pure chance?</p>
<p>Using <span class="math inline">\(n = 80\)</span>, <span class="math inline">\(X = 12\)</span> find a 99% confidence interval for the proportion <span class="math inline">\(p\)</span>. Is that significantly different from <span class="math inline">\(p = 0.5\)</span>.</p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.103</strong></span> A marketing firm is studying the effects of background music on people’s buying behavior. A random sample of <span class="math inline">\(150\)</span> people had classical music playing while shopping and <span class="math inline">\(200\)</span> had pop music playing. The group that listened to classical music spent on average $ <span class="math inline">\(74\)</span> with a standard deviation of $ <span class="math inline">\(18\)</span> while the pop music group spent $ <span class="math inline">\(78.4\)</span> with a standard deviation of $ <span class="math inline">\(12\)</span>.</p>
<ol type="a">
<li>Test whether there is any significant difference between the difference in purchasing habits. Describe clearly your null and alternative hypotheses and any test statistics that you use.</li>
<li>Is there a difference between using a <span class="math inline">\(5\)</span>% and <span class="math inline">\(1\)</span>% significance level.</li>
</ol>
<p><strong>Solution</strong>:</p>
<p>We are given the following: <span class="math inline">\(\bar{x}=74,s_{x}=18,n_{x}=150,\bar{y}=78.4,s_{y}=12,n_{y}=200\)</span></p>
<p><span class="math display">\[\begin{aligned}
H_{0}:\mu_{x}-\mu_{y} &amp; = &amp; 0\\
H_{1}:\mu_{x}-\mu_{y} &amp; \neq &amp; 0\end{aligned}
\]</span></p>
<p>In order to test for this hypothesis, we calculate the z-score and compare it with the z score at 5% and 1% confidence level.<span class="math display">\[z=\frac{\bar{x}-\bar{y}}{\sqrt{\frac{s_{x}^{2}}{n_{x}}+\frac{s_{y}^{2}}{n_{y}}}}=\frac{74-78.4}{\sqrt{\frac{324}{150}+\frac{144}{200}}}=-2.592\]</span></p>
<p>Since <span class="math inline">\(z&gt;z_{0.025}\)</span>, we can reject the null hypothesis at 95% confidence level and say that there exist significant differences between purchasing habits.</p>
<p>For <span class="math inline">\(\alpha=0.05\)</span>, <span class="math inline">\(z_{\alpha/2}=1.96\)</span> and for <span class="math inline">\(\alpha=0.01\)</span>, <span class="math inline">\(z_{\alpha/2}=2.575\)</span>. Thus, the answer does not change when we move from 95% to 99% confidence level.</p>
<p>Alternately, the above question can be solved by creating a confidence interval based on the differences. Again, we will reach the same conclusion.</p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.104 (Sensitivity and Specificity)</strong></span> The quality of Nvidia’s graphic chips have the probability that a randomly chosen chip being defective is only <span class="math inline">\(0.1\)</span>%. You have invented a new technology for testing whether a given chip is defective or not. This test will always identify a defective chip as defective and only “falsely” identify a good chip as defective with probability <span class="math inline">\(1\)</span>%</p>
<ol type="a">
<li>What are the sensitivity and specificity of your testing device?</li>
<li>Given that the test identifies a defective chip, what’s the posterior probability that it is actually defective?</li>
<li>What percentage of the chips will the new technology identify as being defective?</li>
<li>Should you advise Nvidia to go ahead and implement your testing device? Explain.</li>
</ol>
<p><strong>Solution</strong>:</p>
<p>We have the following probabilities (<span class="math inline">\(D\)</span> represents “defective chip” and <span class="math inline">\(T\)</span> represents “test result indicates defective chip”): <span class="math display">\[P(D)=0.001\]</span> <span class="math display">\[P(T|D)=1\]</span> <span class="math display">\[P(T|\bar{D})=0.01\]</span></p>
<ol type="a">
<li>Sensitivity: <span class="math inline">\(P(T|D)=1\)</span> and Specificity: <span class="math inline">\(P(\bar{T}|\bar{D})=1-P(T|\bar{D})=1-0.01=0.99\)</span></li>
<li><span class="math display">\[P(D|T)=\frac{P(T|D)P(D)}{P(T)}=\frac{P(T|D)P(D)}{P(T|D)P(D)+P(T|\bar{D})P(\bar{D})}\]</span> <span class="math display">\[=\frac{(1)(0.001)}{(1)(0.001)+(0.01)(1-0.001)}=0.090992\]</span></li>
<li><span class="math display">\[P(T) = P(T|D)P(D)+P(T|\bar{D})P(\bar{D})\]</span> <span class="math display">\[=(1)(0.001)+(0.01)(1-0.001)=0.01099\]</span></li>
<li>No, only 9% of those chips indicated to be defective by the test will actually be defective. Essentially, we would be throwing away 91% of the chips indicated to be defective even though they are perfectly fine!</li>
</ol>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.105 (CI fo Google)</strong></span> Google is test marketing a new website design to see if it increases the number of click-through on banner ads. In a small study of a million page views they find the following table of responses</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th style="text-align: center;">Total Viewers</th>
<th style="text-align: center;">Click-Throughs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>new design</td>
<td style="text-align: center;">700,000</td>
<td style="text-align: center;">10,000</td>
</tr>
<tr class="even">
<td>old design</td>
<td style="text-align: center;">300,000</td>
<td style="text-align: center;">2,000</td>
</tr>
</tbody>
</table>
<p>Find a <span class="math inline">\(99\)</span>% confidence interval for the increase in the proportion of people who click-through on banner ads using the new web design.</p>
<p>Hint: a 99% confidence interval for a difference in proportions <span class="math inline">\(p_1 - p_2\)</span> is given by <span class="math inline">\(( \hat{p}_1 - \hat{p}_2 ) \pm 2.58\sqrt{ \frac{ \hat{p}_1 ( 1 - \hat{p}_1 ) }{ n_1 }  + \frac{ \hat{p}_2 ( 1 - \hat{p}_2 ) }{ n_2 } }\)</span></p>
<p><strong>Solution</strong>:</p>
<p>We are interested in the distribution of <span class="math inline">\(p_1-p_2\)</span>. We have that: <span class="math display">\[
\begin{aligned}
\hat{p}_1 = \frac{10000}{700000} = \frac{1}{70} \\
\hat{p}_1 = \frac{2000}{300000} = \frac{1}{150}
\end{aligned}
\]</span></p>
<p>Following the hint, we have that the <span class="math inline">\(99\%\)</span> confidence interval is:</p>
<p><span class="math display">\[
\begin{aligned}
p_1 - p_2 &amp;\in &amp; \Big[\hat{p}_1- \hat{p}_2 - 2.58\sqrt{\frac{\hat{p}_1(1-\hat{p}_1 )}{n_1}+\frac{\hat{p}_2(1-\hat{p}_2)}{n_2}}, \hat{p}_1- \hat{p}_2 + 2.58\sqrt{\frac{\hat{p}_1(1-\hat{p}_1 )}{n_1}+\frac{\hat{p}_2(1-\hat{p}_2)}{n_2}}\Big] \\
&amp;=&amp; [0.00762-0.00053,0.00762+0.00053]  \\
&amp;=&amp; [0.00709,0.00815]
\end{aligned}
\]</span></p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.106 (Amazon)</strong></span> Amazon is test marketing a new package delivery system. It wants to see if same-day service is feasible for packages bought with Amazon prime. In a small study of a hundred thousand delivers they find the following times for delivery</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th style="text-align: center;">Deliveries</th>
<th style="text-align: center;">Mean-Time (Hours)</th>
<th style="text-align: center;">Standard Deviation-Time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>new system</td>
<td style="text-align: center;">80,000</td>
<td style="text-align: center;">4.5</td>
<td style="text-align: center;">2.1</td>
</tr>
<tr class="even">
<td>old system</td>
<td style="text-align: center;">20,000</td>
<td style="text-align: center;">5.6</td>
<td style="text-align: center;">2.5</td>
</tr>
</tbody>
</table>
<ol type="a">
<li>Find a <span class="math inline">\(95\)</span>% confidence interval for the decrease in delivery time.</li>
<li>If they switch to the new system, what proportion of deliveries will be under <span class="math inline">\(5\)</span> hours which is required to guarantee same day service.</li>
</ol>
<p>Hint: a 95% confidence interval for a difference in means <span class="math inline">\(\mu_1 - \mu_2\)</span> is given by <span class="math inline">\(( \bar{x}_1 - \bar{x}_2 ) \pm 1.96
\sqrt{ \frac{s_1^2 }{ n_1 }  + \frac{ s_2^2 }{ n_2 } }\)</span> ]</p>
<p><strong>Solution</strong>:</p>
<ol type="a">
<li>Follow the hint, the answer is (-1.14, -1.06).</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb252"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a>(<span class="fl">4.5-5.6</span>)<span class="sc">-</span><span class="fl">1.96</span><span class="sc">*</span><span class="fu">sqrt</span>(<span class="fl">2.1</span><span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">80000</span><span class="fl">+2.5</span><span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">20000</span>) <span class="co">#-1.14</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] -1.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb254"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a>(<span class="fl">4.5-5.6</span>)<span class="sc">+</span><span class="fl">1.96</span><span class="sc">*</span><span class="fu">sqrt</span>(<span class="fl">2.1</span><span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">80000</span><span class="fl">+2.5</span><span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">20000</span>) <span class="co">#-1.06</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] -1.1</code></pre>
</div>
</div>
<p>Hence, the 95% confidence interval is (-1.14, -1.06). a) As we have a large sample size, we can assume a normal distribution with given sample mean and standard deviation, <span class="math inline">\(P(T \leq 5) = 0.594\)</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb256"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="dv">5</span>,<span class="at">mean=</span><span class="fl">4.5</span>,<span class="at">sd=</span><span class="fl">2.1</span>) <span class="co">#0.594</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.59</code></pre>
</div>
</div>
<p>Hence, 59.4% of deliveries will be under 5 hours.</p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.107 (Vitamin C)</strong></span> In the very famous study of the benefits of Vitamin C, <span class="math inline">\(279\)</span> people were randomly assigned to a dose of vitamin C or a placebo (control of nothing). The objective was to study where vitamin C reduces the incidence of a common cold. The following table provides the responses from the experiment</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Group</th>
<th style="text-align: center;">Colds</th>
<th style="text-align: center;">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Vitamin C</td>
<td style="text-align: center;">17</td>
<td style="text-align: center;">139</td>
</tr>
<tr class="even">
<td style="text-align: center;">Placebo</td>
<td style="text-align: center;">31</td>
<td style="text-align: center;">140</td>
</tr>
</tbody>
</table>
<ol type="a">
<li>Is there a significant difference in the proportion of colds between the vitamin C and placebo groups?</li>
<li>Find a <span class="math inline">\(99\)</span>% confidence interval for the difference. Would you recommend the use of vitamin C to prevent a cold?</li>
</ol>
<p>Hint: a 95% confidence interval for a difference in proportions <span class="math inline">\(p_1 - p_2\)</span> is given by <span class="math display">\[
( \hat{p}_1 - \hat{p}_2 ) \pm 1.96  \sqrt{ \frac{ \hat{p}_1 (1- \hat{p}_1) }{ n_1 }  + \frac{ \hat{p}_2 (1- \hat{p}_2)   }{ n_2 } }
\]</span></p>
<p><strong>Solution</strong>:</p>
<p>To test <span class="math display">\[H_0: p_1 - p_2 \neq 0,\]</span> we could perform a two-sample t-test. <span class="math display">\[
\hat{p}_1 = \frac{17}{139} = 12.23\% \mbox{ and } \hat{p}_2 = \frac{31}{140} = 22.14\%
\]</span> <span class="math display">\[
\hat{\sigma} = \sqrt{ \frac{ \hat{p}_1 (1- \hat{p}_1) }{ n_1 }  + \frac{ \hat{p}_2 (1- \hat{p}_2)   }{ n_2 } }  = 4.48\%
\]</span> <span class="math display">\[
t-stat = \frac{\hat{p}_1 - \hat{p}_2}{\hat{\sigma} } = -2.21 &lt; -1.96 = qnorm(0.025)
\]</span> Yes, we can reject the null hypothesis and there is a significant difference at 5% level.</p>
<p>To form the 99% confidence interval of the difference, we use</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb258"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="fl">0.995</span>) <span class="co">#2.58.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 2.6</code></pre>
</div>
</div>
<p><span class="math display">\[
0 \in [-9.91\% - 2.58*4.48\%, -9.91\% + 2.58*4.48\%]
\]</span> We cannot recommend the use of vitamin to prevent a cold at the 1% significance level.</p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.108 (Facebook vs Reading)</strong></span> In a recent article it was claimed that “<span class="math inline">\(96\)</span>% of Americans under the age of <span class="math inline">\(50\)</span>” spent more than three hours a day on Facebook.</p>
<p>To test this hypothesis, a survey of <span class="math inline">\(418\)</span> people under the age of <span class="math inline">\(50\)</span> were taken and it was found that <span class="math inline">\(401\)</span> used Facebook for more than three hours a day.</p>
<p>Test the hypothesis at the <span class="math inline">\(5\)</span>% level that the claim of <span class="math inline">\(96\)</span>% is correct.</p>
<p><strong>Solution</strong>:</p>
<p>We want to test the proportion of people under the age of 50 on Facebook. <span class="math display">\[H_0: p = 96\%\]</span></p>
<p>The estimated proportion from the survey is <span class="math display">\[\hat{p} = 401/418 = 0.959\]</span></p>
<p>The standard deviation of the sample proportion is <span class="math display">\[\hat{\sigma} = \sqrt{\frac{\hat{p}*(1-\hat{p})}{n}} = 0.0096\]</span></p>
<p>To perform a t-test, the corresponding statistic is <span class="math display">\[\mbox{t-stat} = \frac{0.959 - 0.96}{0.0096} = -0.1\]</span></p>
<p>It seems that we cannot reject the null hypothesis at the 5% level.</p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.109 (Paired T-Test)</strong></span> The following table shows the outcome of eight years of a ten year bet that Warren Buffett placed with Protege Partners, a New York hedge fund. Buffett claimed that a simple index fund would beat a portfolio strategy (fund-of-funds) picked by Protege over a ten year time frame. At Buffett’s shareholder meeting, he provided an update of the current state of the bet. The bundle of hedge funds picked by Protege had returned <span class="math inline">\(21.9\)</span>% in the eight years through <span class="math inline">\(2015\)</span> and the S&amp;P500 index fund had soared <span class="math inline">\(65.7\)</span>%.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th style="text-align: center;">SP Index</th>
<th style="text-align: center;">Hedge Funds</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2008</td>
<td style="text-align: center;">-37.0%</td>
<td style="text-align: center;">-23.9%</td>
</tr>
<tr class="even">
<td>2009</td>
<td style="text-align: center;">26.6%</td>
<td style="text-align: center;">15.9%</td>
</tr>
<tr class="odd">
<td>2010</td>
<td style="text-align: center;">15.1%</td>
<td style="text-align: center;">8.5%</td>
</tr>
<tr class="even">
<td>2011</td>
<td style="text-align: center;">2.1%</td>
<td style="text-align: center;">-1.9%</td>
</tr>
<tr class="odd">
<td>2012</td>
<td style="text-align: center;">16.0%</td>
<td style="text-align: center;">6.5%</td>
</tr>
<tr class="even">
<td>2013</td>
<td style="text-align: center;">32.3%</td>
<td style="text-align: center;">11.8%</td>
</tr>
<tr class="odd">
<td>2014</td>
<td style="text-align: center;">13.6%</td>
<td style="text-align: center;">5.6%</td>
</tr>
<tr class="even">
<td>2015</td>
<td style="text-align: center;">1.4%</td>
<td style="text-align: center;">1.7%</td>
</tr>
<tr class="odd">
<td>cumulative</td>
<td style="text-align: center;">65.7%</td>
<td style="text-align: center;">21.9%</td>
</tr>
</tbody>
</table>
<ol type="a">
<li>Use a paired <span class="math inline">\(t\)</span>-test to assess the statistical significance between the two return strategies</li>
<li>How likely is Buffett to win his bet in two years?</li>
</ol>
<p><strong>Solution</strong>:</p>
<p>To conduct a paired t-test, we need define a new variable <span class="math display">\[
D = SP.Index - Hedge.Funds.
\]</span> Assume that <span class="math inline">\(D_i \overset{i.i.d.}{\sim} N(\mu, \sigma^2)\)</span>. the null hypothesis we want to test is <span class="math display">\[
H_0: \mu=0
\]</span> The mean and standard deviation of the difference <span class="math inline">\(\{D_i\}_{i=1}^n\)</span> are <span class="math display">\[
\bar{D} = 0.0574,\quad s_D = 0.0969
\]</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb260"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a>SP.Index <span class="ot">=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">37</span>,<span class="fl">26.6</span>,<span class="fl">15.1</span>,<span class="fl">2.1</span>,<span class="dv">16</span>,<span class="fl">32.3</span>,<span class="fl">13.6</span>,<span class="fl">1.4</span>)</span>
<span id="cb260-2"><a href="#cb260-2" aria-hidden="true" tabindex="-1"></a>Hedge.Funds <span class="ot">=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">23.9</span>,<span class="fl">15.9</span>,<span class="fl">8.5</span>,<span class="sc">-</span><span class="fl">1.9</span>,<span class="fl">6.5</span>,<span class="fl">11.8</span>,<span class="fl">5.6</span>,<span class="fl">1.7</span>)</span>
<span id="cb260-3"><a href="#cb260-3" aria-hidden="true" tabindex="-1"></a>SP.Index <span class="ot">=</span> SP.Index<span class="sc">/</span><span class="dv">100</span></span>
<span id="cb260-4"><a href="#cb260-4" aria-hidden="true" tabindex="-1"></a>Hedge.Funds <span class="ot">=</span> Hedge.Funds<span class="sc">/</span><span class="dv">100</span></span>
<span id="cb260-5"><a href="#cb260-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(SP.Index<span class="sc">-</span>Hedge.Funds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.057</code></pre>
</div>
<div class="sourceCode cell-code" id="cb262"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb262-1"><a href="#cb262-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(SP.Index<span class="sc">-</span>Hedge.Funds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.097</code></pre>
</div>
</div>
<p>Therefore the t-statistic is <span class="math display">\[t=\frac{\bar{D}}{s_D\sqrt{1/n}} = \frac{0.0574}{0.0969\times\sqrt{1/8}}=1.6755.\]</span> Notice that the degree of freedom is <span class="math inline">\(8 - 1 = 7\)</span>. The corresponding p-value is <span class="math display">\[P(|t_7|&gt;1.6755) = 0.1378\]</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb264"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb264-1"><a href="#cb264-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">*</span><span class="fu">pt</span>(<span class="fl">1.6755</span>,<span class="at">df=</span><span class="dv">7</span>,<span class="at">lower.tail =</span> <span class="cn">FALSE</span>) <span class="co">#0.1377437</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.14</code></pre>
</div>
</div>
<p>In <code>R</code>, you can easily perform t-test using the following command, which gives the same test result as above.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb266"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(SP.Index,Hedge.Funds,<span class="at">paired =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## 
##  Paired t-test
## 
## data:  SP.Index and Hedge.Funds
## t = 2, df = 7, p-value = 0.1
## alternative hypothesis: true mean difference is not equal to 0
## 95 percent confidence interval:
##  -0.024  0.138
## sample estimates:
## mean difference 
##           0.057</code></pre>
</div>
</div>
<p>The p-value is larger than 0.05. Thus we don’t reject the null hypothesis at 5% significance level. In other words, these two return strategies are not significantly different.</p>
<p>For the second question, the exact probability of Buffett winning his bet is calculated by <span class="math display">\[P\left(\frac{(1+S_9)(1+S_{10})(1+65.7\%)}{(1+H_9)(1+H_{10})(1+21.9\%)}&gt;1\right)\]</span> where <span class="math inline">\(S_9, S_{10}, H_9, H_{10}\)</span> are returns of two strategies in 9th and 10th year. To derive the distribution of the left hand side expression is difficult. Here we instead give a simulation solution, where the returns are assumed to be i.i.d. Normal variables.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb268"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb268-1"><a href="#cb268-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">=</span> <span class="fu">mean</span>(SP.Index)</span>
<span id="cb268-2"><a href="#cb268-2" aria-hidden="true" tabindex="-1"></a>s1 <span class="ot">=</span> <span class="fu">sd</span>(SP.Index)</span>
<span id="cb268-3"><a href="#cb268-3" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">=</span> <span class="fu">mean</span>(Hedge.Funds)</span>
<span id="cb268-4"><a href="#cb268-4" aria-hidden="true" tabindex="-1"></a>s2 <span class="ot">=</span> <span class="fu">sd</span>(Hedge.Funds)</span>
<span id="cb268-5"><a href="#cb268-5" aria-hidden="true" tabindex="-1"></a>N <span class="ot">=</span> <span class="dv">1000</span> </span>
<span id="cb268-6"><a href="#cb268-6" aria-hidden="true" tabindex="-1"></a>cum1 <span class="ot">=</span> <span class="cn">NULL</span> <span class="co"># cumulative return of SP.Index</span></span>
<span id="cb268-7"><a href="#cb268-7" aria-hidden="true" tabindex="-1"></a>cum2 <span class="ot">=</span> <span class="cn">NULL</span> <span class="co"># cumulative return of Hedge.Funds</span></span>
<span id="cb268-8"><a href="#cb268-8" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">410</span>)</span>
<span id="cb268-9"><a href="#cb268-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N)</span>
<span id="cb268-10"><a href="#cb268-10" aria-hidden="true" tabindex="-1"></a>{ </span>
<span id="cb268-11"><a href="#cb268-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># simulate returns in 2016 and 2017</span></span>
<span id="cb268-12"><a href="#cb268-12" aria-hidden="true" tabindex="-1"></a>  return1 <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.657</span>, <span class="fu">rnorm</span>(<span class="at">n=</span><span class="dv">2</span>, <span class="at">mean =</span> m1, <span class="at">sd =</span> s1)) </span>
<span id="cb268-13"><a href="#cb268-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># compute the cumulative return</span></span>
<span id="cb268-14"><a href="#cb268-14" aria-hidden="true" tabindex="-1"></a>  cum1 <span class="ot">=</span> <span class="fu">c</span>(cum1, <span class="fu">cumprod</span>(<span class="dv">1</span><span class="sc">+</span>return1)) </span>
<span id="cb268-15"><a href="#cb268-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb268-16"><a href="#cb268-16" aria-hidden="true" tabindex="-1"></a>  return2 <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.219</span>, <span class="fu">rnorm</span>(<span class="at">n=</span><span class="dv">2</span>, <span class="at">mean =</span> m2, <span class="at">sd =</span> s2))</span>
<span id="cb268-17"><a href="#cb268-17" aria-hidden="true" tabindex="-1"></a>  cum2 <span class="ot">=</span> <span class="fu">c</span>(cum2, <span class="fu">cumprod</span>(<span class="dv">1</span><span class="sc">+</span>return2))</span>
<span id="cb268-18"><a href="#cb268-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb268-19"><a href="#cb268-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb268-20"><a href="#cb268-20" aria-hidden="true" tabindex="-1"></a><span class="co"># compute the prob. of Buffett winning</span></span>
<span id="cb268-21"><a href="#cb268-21" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(cum1<span class="sc">&gt;</span>cum2) <span class="co">#0.9296667</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.93</code></pre>
</div>
</div>
<p>The estimated probability is 92.97%, indicating that Buffett is very likely to win his bet. Since the paired t - test suggests no significant difference in average returns, you can also estimate the mean by pooling the data and redo the simulation, which gives a smaller estimate (89.27%).</p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.110 (Shaquille O’Neal)</strong></span> Shaquille O’Neal (nicknamed Shaq) is an ex-American Professional basketball player. He was notoriously bad at free throws (an uncontested shot given to a player when they are fouled). The following table compares the first three years of Shaq’s career to his last three years.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Group</th>
<th style="text-align: center;">Free Throws Made</th>
<th style="text-align: center;">Free Throws Attempted</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Early Years</td>
<td style="text-align: center;">1352</td>
<td style="text-align: center;">2425</td>
</tr>
<tr class="even">
<td style="text-align: center;">Later Years</td>
<td style="text-align: center;">1121</td>
<td style="text-align: center;">2132</td>
</tr>
</tbody>
</table>
<p>Did Shaq get worse at free throws over his career?</p>
<p><strong>Solution</strong>:</p>
<p><span class="math display">\[
\hat{p}_1 = \frac{1352}{2425} = 0.5575, \quad \hat{p}_2 = \frac{1121}{2132} = 0.5258,
\quad se( \hat{p_1} - \hat{p_2} ) = \sqrt{ \frac{ \hat{p}_1 (1- \hat{p}_1) }{ n_1 }  + \frac{ \hat{p}_2 (1- \hat{p}_2)   }{ n_2 } } = 0.0148
\]</span> The <span class="math inline">\(Z\)</span>-score is <span class="math display">\[
Z = \frac{ \hat{p}_1 - \hat{p}_2 }{ se( \hat{p_1} - \hat{p_2} ) } = 2.14 \; .
\]</span> The p-value of Z-test is <span class="math display">\[P(|N(0,1)|&gt;2.14) = 0.0324\]</span> Thus we conclude that Shaq got worse at free throws.</p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.111 (Furniture Website)</strong></span> Furniture.com wishes to estimate the average annual expenditure on furniture among its subscribers. A sample of 1000 subscribers is taken. The sample standard deviation is found to be $670 and the sample mean is $3790.</p>
<ol type="a">
<li>Give a 90% confidence interval for the average expenditure.</li>
<li>Test the hypothesis that the average expenditure is less than $2,500 at the 1% level.</li>
</ol>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.112 (Grocery AB Testting)</strong></span> A grocery delivery service is studying the impact of weather on customer ordering behavior. To do so, they identified households which made orders both in October and in February on the same day of the week and approximately the same time of day. They found 112 such matched orders. The mean purchase amount in October was $121.45, with a standard deviation of $32.78, while the mean purchase amount in February was $135.99 with a standard deviation of $24.81. The standard deviation of the difference between the two orders was $38.28. To quantify the evidence in the data regarding a difference in the average purchase amount between the two months, compute the <span class="math inline">\(p\)</span>-value of the data.</p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.113 (SimCity AB Testing)</strong></span> SimCity 5 is one of Electronic Arts (EA’s) most popular video games. As EA prepared to release the new version, they released a promotional offer to drive more pre-orders. The offer was displayed on their webpage as a banner across the top of the pre-order page. They decided to test some other options to see what design or layout would drive more revenue.</p>
<p>The control removed the promotional offer from the page altogether. The test lead to some very surprising results. With a sample size of <span class="math inline">\(1000\)</span> visitors, of the <span class="math inline">\(500\)</span> which got the promotional offer they found <span class="math inline">\(143\)</span> people wanted to purchase the games and of the half that got the control they found that <span class="math inline">\(199\)</span> wanted to buy the new version of SimCity.</p>
<p>Test at the <span class="math inline">\(1\)</span>% level whether EA should provide a promotional offer or not.</p>
<p><strong>Solution</strong>:</p>
<p>To see whether the promotion program works, we need to find out whether the proportion of people who want to buy the game is larger. Denote <span class="math inline">\(p_1\)</span> is the proportion from the experimental group with promotion and <span class="math inline">\(p_2\)</span> from the control group without promotion. Therefore, the null hypothesis we are testing is <span class="math display">\[H_0: p_1 &gt; p_2\]</span></p>
<p>In the sample, we observe <span class="math display">\[n_1 = n_2 = 500\]</span> <span class="math display">\[\hat{p_1} = 199/500 \mbox{ and } \hat{p_2} = 143/500\]</span></p>
<p>To perform the two-sample t-test, we need to calculate the pooled sample standard deviation first. <span class="math display">\[\bar{p} = \hat{p_1}*\frac{n_1}{n_1+n_2} + \hat{p_2}*\frac{n_2}{n_1+n_2} = 171/500\]</span> <span class="math display">\[\bar{\sigma} = \sqrt{\bar{p}*(1-\bar{p})*(\frac{1}{n_1} + \frac{1}{n_2})} = 0.03\]</span></p>
<p>Then, <span class="math display">\[\mbox{t-stat} = \frac{\hat{p_1} - \hat{p_2}}{\bar{\sigma}} = 3.73 &gt; \mbox{qnorm(0.995)} = 2.58\]</span></p>
<p>Now we can conclude that the promotional program works statistically at the 1% level.</p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.114 (True/False)</strong></span> &nbsp;</p>
<ol type="a">
<li>At the Apple conference it was claimed that “<span class="math inline">\(97\)</span>% of people love the iWatch”. From a market survey, you found empirically that <span class="math inline">\(1175\)</span> out of a sample of <span class="math inline">\(1400\)</span> people love the new iWatch. Statistically speaking,you can reject Apple’s claim at the <span class="math inline">\(1\)</span>% significance level. Hint: You may use <span class="math inline">\(pnorm(2.58) = 0.995\)</span></li>
<li>Given a random sample of <span class="math inline">\(2000\)</span> voters, <span class="math inline">\(800\)</span> say they will vote for Hillary Clinton in the 2016 US Presidential Election. At the <span class="math inline">\(95\)</span>%level, I can reject the null hypothesis that Hillary has an evens chance of winning the election.</li>
<li>The average movie is Netflix’s database has an average customer rating of <span class="math inline">\(3.1\)</span> with a standard deviation of <span class="math inline">\(1\)</span>. The last episode of Breaking Bad had a rating of <span class="math inline">\(4.7\)</span> with a standard deviation of <span class="math inline">\(0.5\)</span>. The<span class="math inline">\(p-value\)</span> for testing whether Breaking Bad’s rating is statistical different from the average is a lot less than <span class="math inline">\(1\)</span>%.</li>
<li>A chip manufacturer needs to add the right amount of chemicals to make the chips resistant to heat. On average the population of chips needs to be able to withstand heat of 300 degrees. Suppose you have a random sample of <span class="math inline">\(30\)</span> chips with a mean of <span class="math inline">\(305\)</span> and a standard deviation of<span class="math inline">\(8\)</span>. Then you can reject the null hypothesis <span class="math inline">\(H_0: \mu= 300\)</span> versus<span class="math inline">\(H_a: \mu&gt; 300\)</span> at the <span class="math inline">\(5\)</span>% level.</li>
<li>Zagats rates restaurants on food quality. In a random sample of <span class="math inline">\(100\)</span>restaurants you observe a mean of <span class="math inline">\(20\)</span> with a standard deviation of<span class="math inline">\(2.5\)</span>. Your favorite restaurant has a score of <span class="math inline">\(25\)</span>. This is statistically different from the population mean at the <span class="math inline">\(5\)</span>% level.</li>
<li>The <span class="math inline">\(t\)</span>-score is used to test whether a null hypothesis can be rejected.</li>
<li>An oil company introduces a new fuel that they claim has on average no more than <span class="math inline">\(100\)</span> milligrams of toxic matter per liter. They take a sample of <span class="math inline">\(100\)</span> liters and find that <span class="math inline">\(\bar{X} = 105\)</span> with a given<span class="math inline">\(\sigma_X = 20\)</span>. Then there is evidence at the <span class="math inline">\(5\)</span>% level that their claim is wrong.</li>
<li>A wine producer claims that the proportion of customers who cannot distinguish his product from grape juice is at most 5%. For a sample of<span class="math inline">\(100\)</span> people he finds that <span class="math inline">\(10\)</span> fail the taste test. He should reject his null hypothesis <span class="math inline">\(H_{0}:p=0.05\)</span> at the <span class="math inline">\(5\)</span>% level.</li>
<li>As the <span class="math inline">\(t\)</span>-ratio increases the <span class="math inline">\(p\)</span>-value of a hypothesis test decreases.</li>
</ol>
<p><strong>Solution</strong>:</p>
<ol type="a">
<li>True. <span class="math display">\[\hat{p} = \frac{1175}{1400} = 83.9\%\]</span><span class="math display">\[\hat{\sigma} = \sqrt{\frac{\hat{p}(1-\hat{p})}{1400}} = 0.98\%\]</span> For<span class="math inline">\(H_0: p = 97\%\)</span>,<span class="math display">\[t-stat = \frac{\hat{p} - 97\%}{0.98\%} = -13.37 &lt; -2.58 = qnorm(0.005)\]</span>Yes, we can reject the null hypothesis at 1% significance level.</li>
<li>True. The t-statistic is<span class="math inline">\(T = (\hat{p}-0.5)/\sqrt{\frac{\hat{p} \times (1-\hat{p})}{n}} = -9.13 &lt;\)</span>where <span class="math inline">\(qnorm(0.025) = -1.96\)</span></li>
<li>False. The formula for a T-ratio is <span class="math display">\[\begin{aligned}T = \frac{\bar{x}_1-\bar{x}_2 - (\mu_1 -\mu_2)}{\sqrt{\frac{s_{x_1}^2}{n_1}+\frac{s_{x_2}^2}{n_2}}}\end{aligned}\]</span> However, since we do not know <span class="math inline">\(n_1\)</span> and <span class="math inline">\(n_2\)</span> we cannot get the T-ratio and thus p-value.</li>
<li>True. Since the sample size is <span class="math inline">\(n\ge30\)</span> the t test is effectively the same as the z test. Therefore, we find the following z value:<span class="math display">\[z=\frac{\bar{x}-\mu}{s/\sqrt{n}}=\frac{305-300}{8/\sqrt{30}}=3.4233\]</span>Here we use a one-sided test: <span class="math display">\[z_\alpha=1.65\]</span> Since <span class="math inline">\(z&gt;z_\alpha\)</span>, we can reject <span class="math inline">\(H_0\)</span> in favor of <span class="math inline">\(H_a\)</span> at the 5% level</li>
<li>True. We can calculate the t statistic as <span class="math inline">\((25-20)/(2.5/10)&gt;1.96\)</span>. Hence we reject the null.</li>
<li>True. The <span class="math inline">\(t\)</span> score can be used to test whether a null hypothesis can be rejected or not. Alternately, a z score can be used</li>
<li>True. This is a one-side test <span class="math inline">\(H_0 : \mu_x \leq 100\)</span> versus<span class="math inline">\(H_1 : \mu_X &gt; 100\)</span>. The <span class="math inline">\(Z\)</span>-score is<span class="math inline">\(Z = \frac{105 -100}{ 20 / \sqrt{100} } = 2.5\)</span>. The critical value for a 1-sided test at the <span class="math inline">\(5\)</span>% level is <span class="math inline">\(1.64\)</span>. Therefore you can reject <span class="math inline">\(H_0\)</span>are the <span class="math inline">\(5\)</span>% .</li>
<li>True. <span class="math inline">\(z=\frac{\hat{p}-p_{0}}{\sqrt{\frac{p_{0}(1-p_{0})}{n}}}=\frac{0.1-0.05}{\sqrt{\frac{0.05\cdot 0.95}{100}}}=2.29\)</span> <span class="math inline">\(z_{\alpha /2}=1.96\)</span>Reject the null-hypothesis since <span class="math inline">\(\left\vert z\right\vert &gt;z_{\alpha/2}\)</span></li>
<li>True. If <span class="math inline">\(t&gt;0\)</span> moving out into the tails decreases the <span class="math inline">\(p\)</span>-value. If <span class="math inline">\(t&lt;0\)</span> it will increase the <span class="math inline">\(p\)</span>-value as the <span class="math inline">\(t\)</span> is getting less negative.</li>
</ol>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.115 (True/False: CI)</strong></span> &nbsp;</p>
<ol type="a">
<li>There is much discussion of the effects of second-hand smoke. In a survey of <span class="math inline">\(500\)</span> children who live in families where someone smokes, it was found that <span class="math inline">\(10\)</span> children were in poor health. A <span class="math inline">\(95\)</span>% confidence interval for the probability of a child living in a smoking family being in poor health is then <span class="math inline">\(2\)</span>% to <span class="math inline">\(4\)</span>%.</li>
<li>You are finding a confidence interval for a population mean. Holding everything else constant, an interval based on an unknown standard deviation will be wider than one based on a known standard deviation no matter what the sample size is.</li>
<li>There is a <span class="math inline">\(95\)</span>% probability that a normal random variable lies between <span class="math inline">\(\mu \pm \sigma\)</span>.</li>
<li>A recent CNN poll found that <span class="math inline">\(49\)</span>% of <span class="math inline">\(10000\)</span> voters said they would vote for Obama versus Romney if that was the election in November 2012. A <span class="math inline">\(95\)</span>% confidence interval for the true proportion of voters that would vote for Obama is then <span class="math inline">\(0.49 \pm 0.03\)</span>.</li>
<li>A mileage test for a new electric car model called the “Pizzazz” is conducted. With a sample size of <span class="math inline">\(n=30\)</span> the mean mileage for the sample is <span class="math inline">\(36.8\)</span> miles with a sample standard deviation of <span class="math inline">\(4.5\)</span>. A <span class="math inline">\(95\)</span>% confidence interval for the population mean is <span class="math inline">\((32.3,41.3)\)</span> miles.</li>
<li>In a random sample of <span class="math inline">\(100\)</span> NCAA basketball games, the team leading after one quarter won the game <span class="math inline">\(72\)</span> times. Then a 95% confidence interval for the proportion of teams leading after the first quarter that go on to win is approximately <span class="math inline">\((0.6,0.84)\)</span>.</li>
<li>For the same sample, a 95% prediction interval for a particular team winning is also <span class="math inline">\((0.6,0.84)\)</span>.</li>
<li>In playing poker in Vegas, from <span class="math inline">\(100\)</span> hours of play, you make an average of $50 per hour with a standard deviation of $10. A 95% confidence interval for your mean gain per hour is approximately $ <span class="math inline">\(( 48 , 52 )\)</span></li>
<li>If 27 out of 100 respondents to a survey state that they drink Pepsi then a 95% confidence interval for the proportion <span class="math inline">\(p\)</span> of the population that drinks Pepsi is <span class="math inline">\(( 0.26 , 0.28 )\)</span>.</li>
<li>The <span class="math inline">\(p\)</span>-value is the probability that the Null hypothesis is true.</li>
</ol>
<p><strong>Solution</strong>:</p>
<ol type="a">
<li>False The <span class="math inline">\(95\%\)</span> confidence interval should be: <span class="math display">\[\begin{aligned} \Bigg[.02 - 1.96\sqrt{\frac{.02(1-.02)}{500}},.02 + 1.96\sqrt{\frac{.02(1-.02)}{500}}\Bigg]\end{aligned}\]</span> So, the lower bound on this interval will definitely be less than 2 percent.</li>
<li>True Because you need to use the same data to estimate the standard deviation, and thus contains more noise or error. In other words, we are comparing between <span class="math inline">\(z\)</span> distribution and <span class="math inline">\(t\)</span> distribution</li>
<li>False. There is a 95% probability that it lies between <span class="math inline">\(\mu\pm1.96\sigma\)</span></li>
<li>False. The confidence interval for the proportion is given by: <span class="math display">\[\hat{p}\pm1.96\sqrt{\hat{p}(1-\hat{p})/n}\]</span> <em>This gives:</em> <span class="math display">\[0.49\pm1.96\sqrt{(0.49)(0.51)/10000}=0.49\pm0.009798\]</span></li>
<li>False. <span class="math inline">\(CI=36.8\pm1.96\frac{4.5}{\sqrt{30}}=(35.19,38.41)\)</span></li>
<li>False. The 95% CI is approximately equal to <span class="math display">\[.72 \pm  1.96 \sqrt{ \frac{ \hat{p} (1- \hat{p})}{n} } = 0.72 \pm 1.96 \times 0.045=(.63,.81)\]</span></li>
<li>False. The prediction interval is equal to <span class="math display">\[0.72 \pm 2 \sqrt{ \hat{p} (1- \hat{p} ) } \sqrt{1+1/n}\]</span> In this case, that contains the entire interval (0,1)</li>
<li>True. The CI is given by <span class="math inline">\(50 \pm 2 \times \frac{10}{\sqrt{100} } =(48,52)\)</span></li>
<li>False. The 95% confidence interval for the proportion is given by <span class="math inline">\(\hat{p} \pm 1.96 \sqrt{ \hat{p} ( 1 - \hat{p} ) / n }\)</span>. Which here gives <span class="math inline">\(0.27 \pm 1.96 \sqrt{ 0.27 \times 0.73 / 100 }\)</span> or the interval <span class="math inline">\(( 0.18 , 0.36 )\)</span></li>
<li>False. The p-value is the probability of the observing something more extreme than the observed sample assuming the null hypothesis is true</li>
</ol>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.116 (True/False: Sampling Distribution)</strong></span> &nbsp;</p>
<ol type="a">
<li>The Central Limit Theorem states that the distribution of a sample mean is approximately Normal.</li>
<li>The Central Limit Theorem states that the distribution of the sample mean <span class="math inline">\(\bar{X}\)</span> is Normally distributed for large samples.</li>
<li>The Central Limit Theorem guarantees that the distribution of <span class="math inline">\(\bar{X}\)</span> is constant.</li>
<li>The sample mean, <span class="math inline">\(\bar{x}\)</span>, approximates the population mean for large random samples.</li>
<li>The trimmed mean of a dataset is more sensitive to outliers than the mean.</li>
<li>The sample mean of a dataset must be larger than its standard deviation</li>
<li>Selection bias is not a problem when you are estimating a population mean.</li>
<li>The kurtosis of a distribution is not sensitive to outliers.</li>
</ol>
<p><strong>Solution</strong>:</p>
<ol type="a">
<li>True. The standard deviation of the sample mean is <span class="math inline">\(\frac{\sigma}{\sqrt{n}}\)</span>. The CLT has (approximately) <span class="math inline">\(\bar{X} \sim N(\mu, \frac{\sigma^2}{n})\)</span>, where <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma^2\)</span> are the population true value</li>
<li>True. If <span class="math inline">\(X_i\)</span> is a random sample (or <span class="math inline">\(iid\)</span>) with mean <span class="math inline">\(\mu\)</span>, then <span class="math inline">\(\sqrt{n}\big(\bar{X} - \mu \big) \longrightarrow^d N(0,\sigma^2)\)</span></li>
<li>False. For some set of independent random variables, the mean of a sufficiently large number of them (each with finite mean and variance) will have a distribution with variance depending on the number of samples.</li>
<li>True. The CLT states that the <span class="math inline">\(\bar{X} \sim N \left ( \mu, \frac{\sigma^2}{n} \right )\)</span>, or the best guess for the population mean is <span class="math inline">\(\bar{x}\)</span></li>
<li>False. The trimmed mean is the average of the observations deleting the outer 5% in the tails. Hence, it is less sensitive to outliers than the sample .</li>
<li>False. Many datasets have a negative mean and the standard deviation must be positive.</li>
<li>False. When sampling to estimate a population mean, you need to be certain to select a random sample, or selection bias may affect your results.</li>
<li>False. Kurtosis depends on each observation in the distribution and is extremely sensitive to the outliers</li>
</ol>
</div>
</section>
<section id="field-vs-observational" class="level2" data-number="27.6">
<h2 data-number="27.6" class="anchored" data-anchor-id="field-vs-observational"><span class="header-section-number">27.6</span> Field vs Observational</h2>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.117</strong></span> What is the difference between a randomized trial and an observational study?</p>
</div>
<!-- https://analytics.googleblog.com/2013/01/multi-armed-bandit-experiments.html -->
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.118</strong></span> Consider a complex A/B experiment, with 6 alternatives, when you you have 5 variations to your page, plus the original.</p>
<ol type="a">
<li>Use Bonferroni correction for multiple comparisons. Calculate the significance level for each of the 5 tests and find the number of samples needed to achieve a power of 0.95. Assume that the significance level for each test is .05.</li>
<li>Implement TS for the same experiment. Assume an original arm with a 4% conversion rate, and an optimal arm with a 5% conversion rate. The other 4 arms include one suboptimal arm that beats the original with conversion rate of 4.5%, and three inferior arms with rates of 3%, 2%, and 3.5%. Plot the savings from a six-armed experiment, relative to a Bonferroni adjusted power calculation for a classical experiment. First plot should show the number of days required to end the experiment, with the vertical line showing the time required by the classical power calculation. The second plot should show the number of conversions that were saved by the bandit. What is the overall cost savings due to ending the experiment more quickly, and due to to the experiment being less wasteful while it is running?</li>
<li>Run your simulator 500 times and shows the history of the serving weights for all the arms in the first of our 500 simulation runs. Comment on the results.</li>
<li>Plot the daily cost of running the multi-armed bandit relative to an “oracle” strategy of always playing arm 2, the optimal arm</li>
</ol>
<p><strong>Solution</strong>:</p>
<ol type="a">
<li>The standard power calculation with a significance level of 0.05 is .05 / (6 - 1), and find that we need 15,307 observations in each arm of the experiment. With 6 arms that’s a total of 91,842 observations</li>
<li>The TS algorithm will converge to the optimal arm in 3,000 observations, and will have a 95% chance of having converged to the optimal arm in 5,000 observations. The savings are 86,842 observations, or 95% of the observations required by the classical power calculation.</li>
</ol>
</div>
</section>
<section id="added-after-course-started" class="level2" data-number="27.7">
<h2 data-number="27.7" class="anchored" data-anchor-id="added-after-course-started"><span class="header-section-number">27.7</span> Added After Course Started</h2>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.119 (Emily, Car, Stock Market, Sweepstakes, Vacation and Bayes.)</strong></span> &nbsp;</p>
<!-- https://www2.isye.gatech.edu/isye6420/Bank/MidtermFall2019Sol.pdf -->
<p>Emily is taking Bayesian Analysis course. She believes she will get an A with probability 0.6, a B with probability 0.3, and a C or less with probability 0.1. At the end of semester she will get a car as a present form her (very) rich uncle depending on her class performance. For getting an A in the course Emily will get a car with probability 0.8, for B with probability 0.5, and for anything less than B, she will get a car with probability of 0.2. These are the probabilities if the market is bullish. If the market is bearish, the uncle is less likely to make expensive presents, and the above probabilities are 0.5, 0.3, and 0.1, respectively. The probabilities of bullish and bearish market are equal, 0.5 each. If Emily gets a car, she would travel to Redington Shores with probability 0.7, or stay on campus with probability 0.3. If she does not get a car, these two probabilities are 0.2 and 0.8, respectively. Independently, Emily may be a lucky winner of a sweepstake lottery for a free air ticket and vacation in hotel Sol at Redington Shores. The chance to win the sweepstake is 0.001, but if Emily wins, she will go to vacation with probability of 0.99, irrespective of what happened with the car.</p>
<p>After the semester was over you learned that Emily is at Redington Shores.</p>
<ol type="a">
<li>What is the probability that she got a car?</li>
<li>What is the probability that she won the sweepstakes?</li>
<li>What is the probability that she got a B in the course?</li>
<li>What is the probability that the market was bearish?</li>
</ol>
<p><em>Hint</em>: You can solve this problem by any of the 3 ways: (ii) direct simulation using R, or Python, and (ii) exact calculation. Use just one of the two ways to solve it. The exact solution, although straightforward, may be quite messy.</p>
<p><strong>Solution</strong>: We introduce the following RV’s:</p>
<ul>
<li><span class="math inline">\(C \in \{0,1\}\)</span>: Emily gets a car</li>
<li><span class="math inline">\(G\in \{A,B,\le C\}\)</span>: Emily’s grade</li>
<li><span class="math inline">\(M\in \{1, 0\}\)</span>: Market condition (Bullish, Bearish)</li>
<li><span class="math inline">\(R\in \{0, 1\}\)</span>: Vacation (Redington Shores)</li>
<li><span class="math inline">\(L\)</span>: Emily is a lucky winner of a sweepstake</li>
</ul>
<p>The conditional independence is given by the following graph <!-- https://www.mermaidchart.com/app/projects/ab5d5333-d1a5-42f8-ac1d-8e287a49d7b8/diagrams/30323a8e-087d-4321-b95e-7d89ad5d2f25/share/invite/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJkb2N1bWVudElEIjoiMzAzMjNhOGUtMDg3ZC00MzIxLWI5NWUtN2Q4OWFkNWQyZjI1IiwiYWNjZXNzIjoiRWRpdCIsImlhdCI6MTc1MDIyMDg1Nn0.EcU1lXeiF3JPt9TvozD5HmiH3iMvpX3Jtv-ihNJXWPE --></p>
<!-- ![](fig/emily-car.svg) -->
<div class="cell" data-fig-width="3" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-emily-car" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-emily-car-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div>
<pre class="mermaid mermaid-js" data-label="fig-emily-car">graph LR
    M((M)) --&gt; C((C))
    G((G)) --&gt; C
    C --&gt; R((R))
    L((L)) --&gt; R
</pre>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-emily-car-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;27.1
</figcaption>
</figure>
</div>
</div>
</div>
<p>we can write the joint distribution as <span class="math display">\[
P(C,G,M,R,L) = P(M)P(G)P(C|G,M)P(L)P(R|C,L)
\]</span></p>
<p>Here is what we know</p>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<table class="caption-top table">
<caption>Market (<span class="math inline">\(M\)</span>)</caption>
<thead>
<tr class="header">
<th style="text-align: left;">0</th>
<th style="text-align: left;">1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0.5</td>
<td style="text-align: left;">0.5</td>
</tr>
</tbody>
</table>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<table class="caption-top table">
<caption>Grade (<span class="math inline">\(G\)</span>)</caption>
<thead>
<tr class="header">
<th style="text-align: left;">A</th>
<th style="text-align: left;">B</th>
<th style="text-align: left;"><span class="math inline">\(\le C\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0.6</td>
<td style="text-align: left;">0.3</td>
<td style="text-align: left;">0.1</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<table class="caption-top table">
<caption>Car (<span class="math inline">\(C\mid M,G\)</span>)</caption>
<thead>
<tr class="header">
<th style="text-align: left;">0</th>
<th style="text-align: left;">1</th>
<th style="text-align: left;">M</th>
<th style="text-align: left;">G</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0.5</td>
<td style="text-align: left;">0.5</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">A</td>
</tr>
<tr class="even">
<td style="text-align: left;">0.7</td>
<td style="text-align: left;">0.3</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">B</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0.9</td>
<td style="text-align: left;">0.1</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">C</td>
</tr>
<tr class="even">
<td style="text-align: left;">0.2</td>
<td style="text-align: left;">0.8</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">A</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0.5</td>
<td style="text-align: left;">0.5</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">B</td>
</tr>
<tr class="even">
<td style="text-align: left;">0.8</td>
<td style="text-align: left;">0.2</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">C</td>
</tr>
</tbody>
</table>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<table class="caption-top table">
<caption>Vacation (<span class="math inline">\(R\mid L,C\)</span>)</caption>
<thead>
<tr class="header">
<th style="text-align: left;">0</th>
<th style="text-align: left;">1</th>
<th style="text-align: left;">L</th>
<th style="text-align: left;">C</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0.8</td>
<td style="text-align: left;">0.2</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">0.3</td>
<td style="text-align: left;">0.7</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">0.99</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">0.99</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<ol type="a">
<li>We can calculate the probability of getting a car as <span class="math display">\[
P(C=1\mid R=1) = P(C,R)/P(R) = \sum_{G,M,L}P(C=1,G,M,R=1,L)/\sum_{C,G,M,L}P(C,G,M,R=1,L)
\]</span></li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb270"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb270-1"><a href="#cb270-1" aria-hidden="true" tabindex="-1"></a>m<span class="ot">=</span><span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>) <span class="co"># P(M)</span></span>
<span id="cb270-2"><a href="#cb270-2" aria-hidden="true" tabindex="-1"></a>g<span class="ot">=</span><span class="fu">c</span>(<span class="fl">0.6</span>,<span class="fl">0.3</span>,<span class="fl">0.1</span>) <span class="co"># P(G)</span></span>
<span id="cb270-3"><a href="#cb270-3" aria-hidden="true" tabindex="-1"></a>jmg <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">t</span>(<span class="fu">outer</span>(m, g, <span class="at">FUN =</span> <span class="st">"*"</span>)))  <span class="co"># P(G)P(M)</span></span>
<span id="cb270-4"><a href="#cb270-4" aria-hidden="true" tabindex="-1"></a>cmg <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.3</span>,<span class="fl">0.1</span>,<span class="fl">0.8</span>,<span class="fl">0.5</span>,<span class="fl">0.2</span>) <span class="co"># P(C=1 | M,G)</span></span>
<span id="cb270-5"><a href="#cb270-5" aria-hidden="true" tabindex="-1"></a>jcmg<span class="ot">=</span>jmg<span class="sc">*</span>cmg <span class="co"># P(M)P(G)P(C=1 | M,G)</span></span>
<span id="cb270-6"><a href="#cb270-6" aria-hidden="true" tabindex="-1"></a>l<span class="ot">=</span><span class="fu">c</span>(<span class="fl">0.001</span>,<span class="fl">0.999</span>) <span class="co"># L</span></span>
<span id="cb270-7"><a href="#cb270-7" aria-hidden="true" tabindex="-1"></a>rlc <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.99</span>,<span class="fl">0.7</span>) <span class="co"># P(R=1 | C=1,L)</span></span>
<span id="cb270-8"><a href="#cb270-8" aria-hidden="true" tabindex="-1"></a>cr<span class="ot">=</span><span class="fu">outer</span>(jcmg, l<span class="sc">*</span>rlc, <span class="at">FUN =</span> <span class="st">"*"</span>) <span class="co"># P(C=1 | M,G)P(M)P(G)P(R=1 | C=1,L)</span></span>
<span id="cb270-9"><a href="#cb270-9" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(cr) <span class="co"># sum P(C=1 | M,G)P(M)P(G)P(R=1 | C=1,L)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.37</code></pre>
</div>
<div class="sourceCode cell-code" id="cb272"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb272-1"><a href="#cb272-1" aria-hidden="true" tabindex="-1"></a>c0mg <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.7</span>,<span class="fl">0.9</span>,<span class="fl">0.2</span>,<span class="fl">0.5</span>,<span class="fl">0.8</span>) <span class="co"># P(C=0 | M,G)</span></span>
<span id="cb272-2"><a href="#cb272-2" aria-hidden="true" tabindex="-1"></a>jc0mg<span class="ot">=</span>jmg<span class="sc">*</span>c0mg <span class="co"># P(C=0 | M,G)P(M)P(G)</span></span>
<span id="cb272-3"><a href="#cb272-3" aria-hidden="true" tabindex="-1"></a>rlc0 <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.99</span>,<span class="fl">0.2</span>) <span class="co"># P(R=1 | C=0,L)</span></span>
<span id="cb272-4"><a href="#cb272-4" aria-hidden="true" tabindex="-1"></a>c0r<span class="ot">=</span><span class="fu">outer</span>(jc0mg, l<span class="sc">*</span>rlc0, <span class="at">FUN =</span> <span class="st">"*"</span>) <span class="co"># P(C=1 | M,G)P(M)P(G)P(R=1 | C=1,L)</span></span>
<span id="cb272-5"><a href="#cb272-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(c0r)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.095</code></pre>
</div>
<div class="sourceCode cell-code" id="cb274"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb274-1"><a href="#cb274-1" aria-hidden="true" tabindex="-1"></a>PR <span class="ot">=</span> <span class="fu">sum</span>(cr) <span class="sc">+</span> <span class="fu">sum</span>(c0r)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Thus <span class="math inline">\(P(C=1,R=1) = 0.3676523\)</span> and <span class="math inline">\(P(R=1) = 0.4630275\)</span>, take the ratio to get <span class="math inline">\(P(C=1\mid R=1)\)</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb275"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(cr)<span class="sc">/</span>PR</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.79</code></pre>
</div>
</div>
<p><span class="math display">\[
P(C=1\mid R=1) = 0.3676523/0.4630275 = 0.794
\]</span> We can also use MC simulations</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb277"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb277-1"><a href="#cb277-1" aria-hidden="true" tabindex="-1"></a>gmc  <span class="ot">=</span> <span class="fu">array</span>(<span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.7</span>,<span class="fl">0.9</span>,<span class="fl">0.2</span>,<span class="fl">0.5</span>,<span class="fl">0.8</span>, <span class="fl">0.5</span>,<span class="fl">0.3</span>,<span class="fl">0.1</span>,<span class="fl">0.8</span>,<span class="fl">0.5</span>,<span class="fl">0.2</span>), <span class="at">dim=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">2</span>)) <span class="co"># G,M,C</span></span>
<span id="cb277-2"><a href="#cb277-2" aria-hidden="true" tabindex="-1"></a>clr <span class="ot">=</span> <span class="fu">array</span>(<span class="fu">c</span>(<span class="fl">0.8</span> ,<span class="fl">0.3</span> ,<span class="fl">0.01</span>,<span class="fl">0.01</span>,<span class="fl">0.2</span> ,<span class="fl">0.7</span> ,<span class="fl">0.99</span>,<span class="fl">0.99</span>), <span class="at">dim=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>)) <span class="co"># C,L,R</span></span>
<span id="cb277-3"><a href="#cb277-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb277-4"><a href="#cb277-4" aria-hidden="true" tabindex="-1"></a>simvac <span class="ot">=</span> <span class="cf">function</span>(){</span>
<span id="cb277-5"><a href="#cb277-5" aria-hidden="true" tabindex="-1"></a>    m <span class="ot">=</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="dv">1</span>,<span class="at">prob=</span><span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>))</span>
<span id="cb277-6"><a href="#cb277-6" aria-hidden="true" tabindex="-1"></a>    g <span class="ot">=</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">1</span>,<span class="at">prob=</span><span class="fu">c</span>(<span class="fl">0.6</span>,<span class="fl">0.3</span>,<span class="fl">0.1</span>))</span>
<span id="cb277-7"><a href="#cb277-7" aria-hidden="true" tabindex="-1"></a>    c <span class="ot">=</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="dv">1</span>,<span class="at">prob=</span>gmc[g,m,])</span>
<span id="cb277-8"><a href="#cb277-8" aria-hidden="true" tabindex="-1"></a>    l <span class="ot">=</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="dv">1</span>,<span class="at">prob=</span><span class="fu">c</span>(<span class="fl">0.999</span>,<span class="fl">0.001</span>))</span>
<span id="cb277-9"><a href="#cb277-9" aria-hidden="true" tabindex="-1"></a>    r <span class="ot">=</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="dv">1</span>,<span class="at">prob=</span>clr[c,l,])    </span>
<span id="cb277-10"><a href="#cb277-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">c</span>(m,g,c,l,r))</span>
<span id="cb277-11"><a href="#cb277-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb277-12"><a href="#cb277-12" aria-hidden="true" tabindex="-1"></a>N <span class="ot">=</span> <span class="dv">10000</span></span>
<span id="cb277-13"><a href="#cb277-13" aria-hidden="true" tabindex="-1"></a>d <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>,N,<span class="dv">5</span>)</span>
<span id="cb277-14"><a href="#cb277-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb277-15"><a href="#cb277-15" aria-hidden="true" tabindex="-1"></a>    d[i,] <span class="ot">=</span> <span class="fu">simvac</span>()</span>
<span id="cb277-16"><a href="#cb277-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb277-17"><a href="#cb277-17" aria-hidden="true" tabindex="-1"></a>PR <span class="ot">=</span> <span class="fu">sum</span>(d[,<span class="dv">5</span>]<span class="sc">==</span><span class="dv">2</span>)<span class="sc">/</span>N</span>
<span id="cb277-18"><a href="#cb277-18" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(PR)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.46</code></pre>
</div>
<div class="sourceCode cell-code" id="cb279"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb279-1"><a href="#cb279-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(d[,<span class="dv">3</span>]<span class="sc">==</span><span class="dv">2</span> <span class="sc">&amp;</span> d[,<span class="dv">5</span>]<span class="sc">==</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sum</span>(d[,<span class="dv">5</span>]<span class="sc">==</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.79</code></pre>
</div>
</div>
<ol start="2" type="a">
<li></li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb281"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb281-1"><a href="#cb281-1" aria-hidden="true" tabindex="-1"></a>PLR <span class="ot">=</span> <span class="fl">0.001</span> <span class="sc">*</span> <span class="fl">0.99</span></span>
<span id="cb281-2"><a href="#cb281-2" aria-hidden="true" tabindex="-1"></a>PLR<span class="sc">/</span>PR</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.0021</code></pre>
</div>
</div>
<p><span class="math display">\[
P(L=1\mid R=1) = \dfrac{0.00099}{0.4630} = 0.002138102
\]</span></p>
<ol start="3" type="a">
<li></li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb283"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb283-1"><a href="#cb283-1" aria-hidden="true" tabindex="-1"></a>PRGB <span class="ot">=</span></span>
<span id="cb283-2"><a href="#cb283-2" aria-hidden="true" tabindex="-1"></a><span class="fl">0.5</span><span class="sc">*</span><span class="fl">0.3</span><span class="sc">*</span><span class="fl">0.999</span><span class="sc">*</span><span class="fl">0.5</span><span class="sc">*</span><span class="fl">0.7</span><span class="sc">+</span></span>
<span id="cb283-3"><a href="#cb283-3" aria-hidden="true" tabindex="-1"></a><span class="fl">0.5</span><span class="sc">*</span><span class="fl">0.3</span><span class="sc">*</span><span class="fl">0.999</span><span class="sc">*</span><span class="fl">0.5</span><span class="sc">*</span><span class="fl">0.2</span><span class="sc">+</span></span>
<span id="cb283-4"><a href="#cb283-4" aria-hidden="true" tabindex="-1"></a><span class="fl">0.5</span><span class="sc">*</span><span class="fl">0.3</span><span class="sc">*</span><span class="fl">0.999</span><span class="sc">*</span><span class="fl">0.3</span><span class="sc">*</span><span class="fl">0.7</span><span class="sc">+</span></span>
<span id="cb283-5"><a href="#cb283-5" aria-hidden="true" tabindex="-1"></a><span class="fl">0.5</span><span class="sc">*</span><span class="fl">0.3</span><span class="sc">*</span><span class="fl">0.999</span><span class="sc">*</span><span class="fl">0.7</span><span class="sc">*</span><span class="fl">0.2</span><span class="sc">+</span></span>
<span id="cb283-6"><a href="#cb283-6" aria-hidden="true" tabindex="-1"></a><span class="fl">0.3</span> <span class="sc">*</span> <span class="fl">0.001</span> <span class="sc">*</span> <span class="fl">0.99</span></span>
<span id="cb283-7"><a href="#cb283-7" aria-hidden="true" tabindex="-1"></a><span class="co"># P(G=B , R=1)</span></span>
<span id="cb283-8"><a href="#cb283-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(PRGB)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.12</code></pre>
</div>
<div class="sourceCode cell-code" id="cb285"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb285-1"><a href="#cb285-1" aria-hidden="true" tabindex="-1"></a><span class="co"># P(G=B | R=1)</span></span>
<span id="cb285-2"><a href="#cb285-2" aria-hidden="true" tabindex="-1"></a>PRGB<span class="sc">/</span>PR</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.26</code></pre>
</div>
</div>
<ol start="4" type="a">
<li>PMR</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb287"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb287-1"><a href="#cb287-1" aria-hidden="true" tabindex="-1"></a>PMR <span class="ot">=</span> <span class="co">#P(M,R)</span></span>
<span id="cb287-2"><a href="#cb287-2" aria-hidden="true" tabindex="-1"></a><span class="fl">0.5</span><span class="sc">*</span><span class="fl">0.6</span><span class="sc">*</span><span class="fl">0.999</span><span class="sc">*</span><span class="fl">0.8</span><span class="sc">*</span><span class="fl">0.7</span><span class="sc">+</span></span>
<span id="cb287-3"><a href="#cb287-3" aria-hidden="true" tabindex="-1"></a><span class="fl">0.5</span><span class="sc">*</span><span class="fl">0.6</span><span class="sc">*</span><span class="fl">0.999</span><span class="sc">*</span><span class="fl">0.2</span><span class="sc">*</span><span class="fl">0.2</span><span class="sc">+</span></span>
<span id="cb287-4"><a href="#cb287-4" aria-hidden="true" tabindex="-1"></a><span class="fl">0.5</span><span class="sc">*</span><span class="fl">0.3</span><span class="sc">*</span><span class="fl">0.999</span><span class="sc">*</span><span class="fl">0.5</span><span class="sc">*</span><span class="fl">0.7</span><span class="sc">+</span></span>
<span id="cb287-5"><a href="#cb287-5" aria-hidden="true" tabindex="-1"></a><span class="fl">0.5</span><span class="sc">*</span><span class="fl">0.3</span><span class="sc">*</span><span class="fl">0.999</span><span class="sc">*</span><span class="fl">0.5</span><span class="sc">*</span><span class="fl">0.2</span><span class="sc">+</span></span>
<span id="cb287-6"><a href="#cb287-6" aria-hidden="true" tabindex="-1"></a><span class="fl">0.5</span><span class="sc">*</span><span class="fl">0.1</span><span class="sc">*</span><span class="fl">0.999</span><span class="sc">*</span><span class="fl">0.2</span><span class="sc">*</span><span class="fl">0.7</span><span class="sc">+</span></span>
<span id="cb287-7"><a href="#cb287-7" aria-hidden="true" tabindex="-1"></a><span class="fl">0.5</span><span class="sc">*</span><span class="fl">0.1</span><span class="sc">*</span><span class="fl">0.999</span><span class="sc">*</span><span class="fl">0.8</span><span class="sc">*</span><span class="fl">0.2</span><span class="sc">+</span></span>
<span id="cb287-8"><a href="#cb287-8" aria-hidden="true" tabindex="-1"></a><span class="fl">0.5</span> <span class="sc">*</span> <span class="fl">0.001</span> <span class="sc">*</span> <span class="fl">0.99</span></span>
<span id="cb287-9"><a href="#cb287-9" aria-hidden="true" tabindex="-1"></a><span class="co">#P(M,R)</span></span>
<span id="cb287-10"><a href="#cb287-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(PMR)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.26</code></pre>
</div>
<div class="sourceCode cell-code" id="cb289"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb289-1"><a href="#cb289-1" aria-hidden="true" tabindex="-1"></a><span class="co">#P(M=0,R)</span></span>
<span id="cb289-2"><a href="#cb289-2" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span>PMR<span class="sc">/</span>PR</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.43</code></pre>
</div>
</div>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.120 (Poisson: Website visits)</strong></span> A web designer is analyzing traffic on a web site. Assume the number of visitors arriving at the site at a given time of day is modeled as a Poisson random variable with a rate of <span class="math inline">\(\lambda\)</span> visitors per minute. Based on prior experience with similar web sites, the following estimates are given:</p>
<ul>
<li>There is a 90% probability that the rate is greater than 5 visitors per minute.</li>
<li>The rate is equally likely to be greater than or less than 14 visitors per minute.</li>
<li>There is a 90% probability that the rate is less than 27 visitors per minute.</li>
</ul>
<p>Find a Gamma prior distribution for the arrival rate that fits these judgments as well as possible. Comment on your results.</p>
<p>Hint: there is no “right” answer to this problem. You can use trial and error to find a distribution that fits as well as possible. You can also use an optimization method such as Excel Solver to minimize a measure of how far apart the given quantiles are from the ones in the target distribution.</p>
<p><strong>Solution</strong>:</p>
<p>We can try different values to see whether we can get a result that is close to the given quantiles. Given, there are only 2 parameters, I simply did a grid-search. I generated a grid of 200x200 points and calculated the quantiles for each point. Then I found the point that was closest to the given quantiles. I used sum of absolute value differences to measure the distance between the given and calculated quantiles. You can use squared differences instead.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb291"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb291-1"><a href="#cb291-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">=</span> <span class="fu">expand.grid</span>(<span class="fu">seq</span>(<span class="at">from=</span><span class="fl">0.5</span>,<span class="at">to=</span><span class="dv">7</span>,<span class="at">length=</span><span class="dv">200</span>),<span class="fu">seq</span>(<span class="at">from=</span><span class="fl">0.5</span>,<span class="at">to=</span><span class="dv">10</span>,<span class="at">length=</span><span class="dv">200</span>))</span>
<span id="cb291-2"><a href="#cb291-2" aria-hidden="true" tabindex="-1"></a>qf <span class="ot">=</span> <span class="cf">function</span>(th) {</span>
<span id="cb291-3"><a href="#cb291-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">qgamma</span>(<span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">0.9</span>), <span class="at">shape=</span>th[<span class="dv">1</span>], <span class="at">scale=</span>th[<span class="dv">2</span>])</span>
<span id="cb291-4"><a href="#cb291-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb291-5"><a href="#cb291-5" aria-hidden="true" tabindex="-1"></a>r <span class="ot">=</span> <span class="fu">apply</span>(g,<span class="dv">1</span>,qf)</span>
<span id="cb291-6"><a href="#cb291-6" aria-hidden="true" tabindex="-1"></a>target <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">14</span>,<span class="dv">27</span>)</span>
<span id="cb291-7"><a href="#cb291-7" aria-hidden="true" tabindex="-1"></a>ind <span class="ot">=</span> <span class="fu">which.min</span>((<span class="fu">colSums</span>(<span class="fu">abs</span>(r<span class="sc">-</span>target))))</span>
<span id="cb291-8"><a href="#cb291-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(g[ind,])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##       Var1 Var2
## 20272  2.8  5.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb293"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb293-1"><a href="#cb293-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">quantile =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">0.9</span>), <span class="at">expert =</span> target, <span class="at">calculated =</span> <span class="fu">qf</span>(<span class="fu">as.numeric</span>(g[ind,])))</span>
<span id="cb293-2"><a href="#cb293-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">quantile</th>
<th style="text-align: right;">expert</th>
<th style="text-align: right;">calculated</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">5.3</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">13.3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.9</td>
<td style="text-align: right;">27</td>
<td style="text-align: right;">27.0</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Notice instead of looping through the grid, I used <code>expand.grid</code> combined with <code>apply</code> to calculate the quantiles for each point. This is a more efficient way to do the same thing.</p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.121 (Normal-Likelihod)</strong></span> We observe samples of normal random variable <span class="math inline">\(Y_i\mid \mu,\sigma \sim N(\mu,\sigma^2)\)</span> with known <span class="math inline">\(\sigma\)</span>, specify and plot likelihood for <span class="math inline">\(\mu\)</span></p>
<ol type="a">
<li>y = (-4.3,0.7,-19.4), <span class="math inline">\(\sigma=10\)</span></li>
<li>y = (-12,12,-4.5,0.6), <span class="math inline">\(\sigma=6\)</span></li>
<li>y = (-4.3,0.7,-19.4), <span class="math inline">\(\sigma=2\)</span></li>
<li>y = (12.4,12.1), <span class="math inline">\(\sigma=5\)</span></li>
</ol>
<p><em>Hint</em>: Remember that the nornal likelihood is the product of the normal density function evaluated at each observation <span class="math display">\[
L(\mu|y,\sigma) = \prod_{i=1}^n \dfrac{1}{\sqrt{2\pi}\sigma}e^{-(y_i-\mu)^2/2\sigma^2} = \dfrac{1}{(2\pi\sigma^2)^{n/2}}e^{-\sum_{i=1}^n(y_i-\mu)^2/2\sigma^2}
\]</span> The expression under the exponenta can be simplified to <span class="math display">\[
\sum_{i=1}^n(y_i-\mu)^2 = \sum_{i=1}^n (\mu^2 - 2\mu y_i + y_i^2) = n\mu^2 - 2\mu\sum_{i=1}^n y_i + \sum_{i=1}^n y_i^2 = n\mu^2 - 2\mu n\bar{y} + \sum_{i=1}^n y_i^2 = n(\mu^2 - 2\mu\bar{y} + \sum_{i=1}^n y_i^2)      
\]</span> Now <span class="math display">\[
\mu^2 - 2\mu\bar{y} + \sum_{i=1}^n y_i^2 = \mu^2 - 2\mu\bar{y} + \bar y^2 - \bar y^2 + \sum_{i=1}^n y_i^2 (\mu - \bar{y})^2 + \sum_{i=1}^n(y_i-\bar{y})^2
\]</span> The last summad does not depend on <span class="math inline">\(\mu\)</span> and can be ignored. Thus, the likelihood is proportional to <span class="math display">\[
e^{\dfrac{-(\mu - \bar{y})^2}{2\sigma^2/n}}
\]</span></p>
<p><strong>Solution</strong>: Let’s implement the likelihood function. We will use two different functions to calculate the likelihood. The first function uses the <span class="math inline">\(\bar y\)</span> as summary statistic and evaluates normal density function to calculate the likelihood for the mean of the data. The second function uses the product of the normal density function to calculate the likelihood for the mean of the data. We will compare the results of the two functions to see if they are consistent.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb294"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb294-1"><a href="#cb294-1" aria-hidden="true" tabindex="-1"></a>lhood1 <span class="ot">=</span> <span class="cf">function</span>(y, mu, sigma) {</span>
<span id="cb294-2"><a href="#cb294-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">dnorm</span>(<span class="fu">mean</span>(y), mu, sigma<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(y))) </span>
<span id="cb294-3"><a href="#cb294-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb294-4"><a href="#cb294-4" aria-hidden="true" tabindex="-1"></a>lhood2 <span class="ot">=</span> <span class="cf">function</span>(y, mu, sigma) {</span>
<span id="cb294-5"><a href="#cb294-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">prod</span>(<span class="fu">dnorm</span>(y, mu, sigma))</span>
<span id="cb294-6"><a href="#cb294-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb294-7"><a href="#cb294-7" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">=</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">15</span>,<span class="dv">15</span>,<span class="fl">0.1</span>)</span>
<span id="cb294-8"><a href="#cb294-8" aria-hidden="true" tabindex="-1"></a>a1 <span class="ot">=</span> <span class="fu">lhood1</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">4.3</span>,<span class="fl">0.7</span>,<span class="sc">-</span><span class="fl">19.4</span>),mu,<span class="dv">10</span>)</span>
<span id="cb294-9"><a href="#cb294-9" aria-hidden="true" tabindex="-1"></a>a2 <span class="ot">=</span> <span class="fu">sapply</span>(mu,lhood2,<span class="at">y=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">4.3</span>,<span class="fl">0.7</span>,<span class="sc">-</span><span class="fl">19.4</span>),<span class="at">sigma=</span><span class="dv">10</span>)</span>
<span id="cb294-10"><a href="#cb294-10" aria-hidden="true" tabindex="-1"></a>(a1<span class="sc">/</span>a2)[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 3253 3253 3253 3253 3253</code></pre>
</div>
<div class="sourceCode cell-code" id="cb296"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb296-1"><a href="#cb296-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mu,a1)</span>
<span id="cb296-2"><a href="#cb296-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(mu,<span class="fl">3253.175</span><span class="sc">*</span>a2,<span class="at">col=</span><span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ex_files/figure-html/unnamed-chunk-90-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>We see that two approaches to calculating the likelihood agree (up to a constant).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb297"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb297-1"><a href="#cb297-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mu,a1,<span class="at">type=</span><span class="st">"l"</span>,<span class="at">xlab=</span><span class="st">"mu"</span>,<span class="at">ylab=</span><span class="st">"likelihood"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ex_files/figure-html/unnamed-chunk-91-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb298"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb298-1"><a href="#cb298-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mu,<span class="fu">lhood1</span>(<span class="fu">c</span> (<span class="sc">-</span><span class="dv">12</span>,<span class="dv">12</span>,<span class="sc">-</span><span class="fl">4.5</span>,<span class="fl">0.6</span>),mu,<span class="dv">6</span>),<span class="at">type=</span><span class="st">"l"</span>,<span class="at">xlab=</span><span class="st">"mu"</span>,<span class="at">ylab=</span><span class="st">"likelihood"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ex_files/figure-html/unnamed-chunk-91-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb299"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb299-1"><a href="#cb299-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mu,<span class="fu">lhood1</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">4.3</span>,<span class="fl">0.7</span>,<span class="sc">-</span><span class="fl">19.4</span>),mu,<span class="dv">2</span>),<span class="at">type=</span><span class="st">"l"</span>,<span class="at">xlab=</span><span class="st">"mu"</span>,<span class="at">ylab=</span><span class="st">"likelihood"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ex_files/figure-html/unnamed-chunk-91-3.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb300"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb300-1"><a href="#cb300-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mu,<span class="fu">lhood1</span>(<span class="fu">c</span>(<span class="fl">12.4</span>,<span class="fl">12.1</span>),mu,<span class="dv">5</span>),<span class="at">type=</span><span class="st">"l"</span>,<span class="at">xlab=</span><span class="st">"mu"</span>,<span class="at">ylab=</span><span class="st">"likelihood"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ex_files/figure-html/unnamed-chunk-91-4.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.122 (Normal-Normal for Lock5Data)</strong></span> <code>Lock5Data</code> package (Lock et al.&nbsp;2016), includes results for a cross-sectional study of hippocampal volumes among 75 subjects (Singh et al.&nbsp;2014): 25 collegiate football players with a history of concussions (<code>FBConcuss</code>), 25 collegiate football players that do not have a history of concussions (<code>FBNoConcuss</code>), and 25 control subjects. For our analysis, we’ll focus on the subjects with a history of concussions:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb301"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb301-1"><a href="#cb301-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Lock5Data)</span>
<span id="cb301-2"><a href="#cb301-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(FootballBrain)</span>
<span id="cb301-3"><a href="#cb301-3" aria-hidden="true" tabindex="-1"></a>d <span class="ot">=</span> FootballBrain[FootballBrain<span class="sc">$</span>Group<span class="sc">==</span><span class="st">"FBConcuss"</span>,]</span>
<span id="cb301-4"><a href="#cb301-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(d<span class="sc">$</span>Hipp,<span class="at">bw=</span><span class="dv">300</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ex_files/figure-html/unnamed-chunk-92-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<ol type="a">
<li>Assume that the hippocampal volumes of the subjects with a history of concussions are independent normal random variables with unknown mean <span class="math inline">\(\mu\)</span> and known standard deviation <span class="math inline">\(\sigma\)</span>. Estimate <span class="math inline">\(\sigma\)</span> using the sample standard deviation of the hippocampal volumes (<code>FBConcuss</code> group). Calculate the likelihood for <span class="math inline">\(\mu\)</span>.</li>
<li>Assume that <span class="math inline">\(\mu\)</span> has a normal prior distribution with mean <span class="math inline">\(\mu_0\)</span> and standard deviation <span class="math inline">\(\sigma_0\)</span>. Estimate those parameters using the sample mean and standard error of the hippocampal volumes across all subjects.</li>
<li>Find the posterior distribution for <span class="math inline">\(\mu\)</span>.</li>
<li>Find a 95% posterior credible interval for <span class="math inline">\(\mu\)</span>.</li>
</ol>
<p><strong>Solution</strong>:</p>
<ol type="a">
<li>The sample standard deviation of the hippocampal volumes is</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb302"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb302-1"><a href="#cb302-1" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">=</span> <span class="fu">sd</span>(d<span class="sc">$</span>Hipp)</span>
<span id="cb302-2"><a href="#cb302-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(sigma)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 593</code></pre>
</div>
</div>
<p>Thus, we assume that <span class="math display">\[
p(\mu\mid y) \propto e^{\dfrac{-(\bar y-\mu)^2}{2\cdot 593.3^2/25}}
\]</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb304"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb304-1"><a href="#cb304-1" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">5000</span>,<span class="dv">6500</span>,<span class="at">length.out=</span><span class="dv">200</span>)</span>
<span id="cb304-2"><a href="#cb304-2" aria-hidden="true" tabindex="-1"></a>lhood <span class="ot">=</span> <span class="fu">dnorm</span>(<span class="fu">mean</span>(d<span class="sc">$</span>Hipp),mu,sigma<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(d<span class="sc">$</span>Hipp))) </span>
<span id="cb304-3"><a href="#cb304-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mu,lhood,<span class="at">type=</span><span class="st">"l"</span>,<span class="at">xlab=</span><span class="st">"mu"</span>,<span class="at">ylab=</span><span class="st">"likelihood"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ex_files/figure-html/unnamed-chunk-94-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<ol start="2" type="a">
<li>The sample mean and standard deviation of the hippocampal volumes across all subjects are</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb305"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb305-1"><a href="#cb305-1" aria-hidden="true" tabindex="-1"></a>mu0 <span class="ot">=</span> <span class="fu">mean</span>(FootballBrain<span class="sc">$</span>Hipp)</span>
<span id="cb305-2"><a href="#cb305-2" aria-hidden="true" tabindex="-1"></a>sigma0 <span class="ot">=</span> <span class="fu">sd</span>(FootballBrain<span class="sc">$</span>Hipp)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">75</span>) </span>
<span id="cb305-3"><a href="#cb305-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mu0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 6599</code></pre>
</div>
<div class="sourceCode cell-code" id="cb307"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb307-1"><a href="#cb307-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(sigma0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 131</code></pre>
</div>
</div>
<p>Thus, we assume that the prior is <span class="math display">\[
\mu \sim N(6598.8, 226.7^2)
\]</span></p>
<ol start="3" type="a">
<li>The posterior distribution for <span class="math inline">\(\mu\)</span> has mean of <span class="math display">\[
\mu^* = \frac{\sigma^2}{n\sigma_0^2 + \sigma^2}\mu_0 + \frac{n\sigma_0^2}{n\sigma_0^2 + \sigma^2}\bar{y}
\]</span> and variance of <span class="math display">\[
\sigma^{*2} = \sigma_n^2 = \frac{\sigma^2\sigma_0^2}{n\sigma_0^2 + \sigma^2}
\]</span></li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb309"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb309-1"><a href="#cb309-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">=</span> <span class="dv">25</span><span class="sc">*</span>sigma0<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> sigma<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb309-2"><a href="#cb309-2" aria-hidden="true" tabindex="-1"></a>mus <span class="ot">=</span> sigma<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>k<span class="sc">*</span>mu0 <span class="sc">+</span> <span class="dv">25</span><span class="sc">*</span>sigma0<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>k<span class="sc">*</span><span class="fu">mean</span>(d<span class="sc">$</span>Hipp)</span>
<span id="cb309-3"><a href="#cb309-3" aria-hidden="true" tabindex="-1"></a>sigmas2 <span class="ot">=</span> sigma<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>sigma0<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>k</span>
<span id="cb309-4"><a href="#cb309-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mus)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 6125</code></pre>
</div>
<div class="sourceCode cell-code" id="cb311"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb311-1"><a href="#cb311-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(sigmas2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 7730</code></pre>
</div>
</div>
<ol start="4" type="a">
<li>A 95% posterior credible interval for <span class="math inline">\(\mu\)</span> is</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb313"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb313-1"><a href="#cb313-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>),mus,<span class="fu">sqrt</span>(sigmas2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 5952 6297</code></pre>
</div>
</div>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.123 (Normal-Normal chest measurements)</strong></span> We have chest measurements of 10 000 men. Now, based on memories of my experience as an assistant in a gentlemen’s outfitters in my university vacations, I would suggest a prior <span class="math display">\[
\mu \sim N(38, 9).
\]</span> Of course, it is open to question whether these men form a random sample from the whole population, but unless I am given information to the contrary I would stick to the prior I have just quoted, except that I might be inclined to increase the variance. My data shows that the mean turned out to be 39.8 with a standard deviation of 2.0 for the sample of 10 000.</p>
<ol type="a">
<li>Calculate the posterior mean for the chest measurements of men in this population</li>
<li>Calculate the predictive distribution for the next observation <span class="math inline">\(x_{n+1}\)</span></li>
</ol>
<p><strong>Solution</strong>:</p>
<ol type="a">
<li></li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb315"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb315-1"><a href="#cb315-1" aria-hidden="true" tabindex="-1"></a>mu0 <span class="ot">=</span> <span class="dv">38</span></span>
<span id="cb315-2"><a href="#cb315-2" aria-hidden="true" tabindex="-1"></a>sigma0 <span class="ot">=</span> <span class="dv">9</span></span>
<span id="cb315-3"><a href="#cb315-3" aria-hidden="true" tabindex="-1"></a>yhat <span class="ot">=</span> <span class="fl">39.8</span></span>
<span id="cb315-4"><a href="#cb315-4" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb315-5"><a href="#cb315-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">10000</span></span>
<span id="cb315-6"><a href="#cb315-6" aria-hidden="true" tabindex="-1"></a>k <span class="ot">=</span> n<span class="sc">*</span>sigma0<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> sigma<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb315-7"><a href="#cb315-7" aria-hidden="true" tabindex="-1"></a>mus <span class="ot">=</span> sigma<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>k<span class="sc">*</span>mu0 <span class="sc">+</span> n<span class="sc">*</span>sigma0<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>k<span class="sc">*</span>yhat</span>
<span id="cb315-8"><a href="#cb315-8" aria-hidden="true" tabindex="-1"></a>sigmas2 <span class="ot">=</span> sigma<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>sigma0<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>k</span>
<span id="cb315-9"><a href="#cb315-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mus)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 40</code></pre>
</div>
<div class="sourceCode cell-code" id="cb317"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb317-1"><a href="#cb317-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(sigmas2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 4e-04</code></pre>
</div>
</div>
<p>Note that the posterior mean is equal to <span class="math inline">\(\bar y = 39.8\)</span> equal to the sample mean and variance is <span class="math inline">\(0.0004\)</span> which is equal to 4/10000, the . Thus, our posterior is standardized likelihood <span class="math display">\[
N(\bar y, \sigma^2/n)
\]</span> Naturally, the closeness of the posterior to the standardized likelihood results from the large sample size, and whatever my prior had been, unless it were very very extreme, I would have got very much the same result.</p>
<p>More formally, the posterior will be close to the standardized likelihood if the ratio of posterior and prior variances <span class="math inline">\(\sigma_*^2/\sigma_0^2\)</span> is small or in other words when when <span class="math inline">\(\sigma_0^2\)</span> is large compared to <span class="math inline">\(\sigma^2/n\)</span>.</p>
<ol start="2" type="a">
<li>The predictive distribution for the next observation <span class="math inline">\(x_{n+1}\)</span> can be derived by writing <span class="math display">\[
x_{n+1}  = (x_{n+1} - \mu) + \mu
\]</span> Now <span class="math inline">\(x_{n+1}-\mu \sim N(0,\sigma^2)\)</span> and <span class="math inline">\(\mu \sim N(\mu^*,\sigma^{*2})\)</span>. Thus, the predictive distribution is <span class="math display">\[
x_{n+1} \sim N(\mu^*,\sigma^{*2} + \sigma^2)
\]</span></li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb319"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb319-1"><a href="#cb319-1" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">=</span> mus</span>
<span id="cb319-2"><a href="#cb319-2" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">=</span> <span class="fu">sqrt</span>(sigmas2 <span class="sc">+</span> sigma<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb319-3"><a href="#cb319-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mu)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 40</code></pre>
</div>
<div class="sourceCode cell-code" id="cb321"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb321-1"><a href="#cb321-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(sigma)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 2</code></pre>
</div>
</div>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.124 (Normal-Normal Hypothesis Test)</strong></span> Assume Normal-Normal model with known variance, <span class="math inline">\(X\mid \theta \sim  N(\theta,\sigma^2)\)</span>, <span class="math inline">\(\theta \sim  N(\mu ,\tau^2)\)</span>, and <span class="math inline">\(\theta\mid X \sim  N(\mu^*,\rho^2)\)</span>. Given <span class="math inline">\(L_0 = L(d_1\mid H_0)\)</span> and <span class="math inline">\(L_1 = L(d_0\mid H_1)\)</span> losses, show that for testing <span class="math inline">\(H_0 : \theta \le \theta_0\)</span> the “rejection region” is <span class="math inline">\(\mu^* &gt; \theta_0 + z\rho\)</span>, where <span class="math inline">\(z = \Phi^{-1}\left(L_1/(L_0+L_1)\right)\)</span>. Remember, that in the classical <span class="math inline">\(\alpha\)</span>-level test, the rejection region is <span class="math inline">\(X &gt; \theta_0 + z_{1-\alpha}\sigma\)</span></p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 27.125 (Normal-Normal Hypothesis Test)</strong></span> Assume <span class="math inline">\(X\mid \theta \sim  N(\theta,\sigma^2)\)</span> and <span class="math inline">\(\theta \sim p(\theta)=1\)</span>. Consider testing <span class="math inline">\(H_0 : \theta  \le \theta_0\)</span> v.s. <span class="math inline">\(H_1 : \theta  &gt; \theta_0\)</span>. Show that <span class="math inline">\(p_0 = P(\theta  \le \theta_0 \mid X)\)</span> is equal to classical p-value.</p>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-logan1983multivariate" class="csl-entry" role="listitem">
Logan, John A. 1983. <span>“A Multivariate Model for Mobility Tables.”</span> <em>American Journal of Sociology</em> 89 (2): 324–49.
</div>
<div id="ref-tarone1982use" class="csl-entry" role="listitem">
Tarone, Robert E. 1982. <span>“The Use of Historical Control Information in Testing for a Trend in Proportions.”</span> <em>Biometrics. Journal of the International Biometric Society</em>, 215–20.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./26-robots.html" class="pagination-link" aria-label="AI Agents">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">AI Agents</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./references.html" class="pagination-link" aria-label="References">
        <span class="nav-page-text">References</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>