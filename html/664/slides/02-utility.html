<!DOCTYPE html>
<html lang="en"><head>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/tabby.min.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-29e2c20b02301cfff04dc8050bf30c7e.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.6.37">

  <meta name="author" content="Vadim Sokolov   George Mason University   Spring 2025">
  <title>Bayes AI</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="site_libs/revealjs/dist/theme/quarto-bbe7401fe57d4b791b917637bb662036.css">
  <link rel="stylesheet" href="style.css">
  <link href="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src="site_libs/quarto-diagram/mermaid.min.js"></script>
  <script src="site_libs/quarto-diagram/mermaid-init.js"></script>
  <link href="site_libs/quarto-diagram/mermaid.css" rel="stylesheet">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="center">
  <h1 class="title" style="font-size:40px;">Bayes AI</h1>
  <p class="subtitle" style="color:blue;font-size:50px;">Unit 2: Utility and Decision Theory</p>
<img style="height: 350px;" src="fig/page/02-utility.jpg">
  <p class="author">Vadim Sokolov <br> George Mason University <br> Spring 2025</p>

<p style="font-size:10px;"> 
<a href="https://vsokolov.org/courses/664.html">Course Page</a>, <a href="https://vsokolov.org/html/664/slides/">Slides</a>
</p>


</section>
<section id="probability-and-psychology" class="slide level2 smaller">
<h2>Probability and Psychology</h2>
<p>How do people form probabilities or expectations in reality?</p>
<p>Psychologists have categorized many different biases that people have in their beliefs or judgments.</p>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Loss Aversion</strong></p>
</div>
<div class="callout-content">
<p>The most important finding of Kahneman and Tversky is that people are loss averse.</p>
</div>
</div>
</div>
<p>Utilities are defined over gains and losses rather than over final (or terminal) wealth, an idea first proposed by Markowitz. This is a violation of the EU postulates. Let <span class="math inline">\((x,y)\)</span> denote a bet with gain <span class="math inline">\(x\)</span> with probability <span class="math inline">\(y\)</span>.</p>
<p>To illustrate this subjects were asked:</p>
<p><em>In addition to whatever you own, you have been given $1000, now choose between the gambles <span class="math inline">\(A = ( 1000 , 0.5 )\)</span> and <span class="math inline">\(B = ( 500 , 1 )\)</span>.</em></p>
<p><span class="math inline">\(B\)</span> was the more popular choice.</p>
</section>
<section id="example" class="slide level2">
<h2>Example</h2>
<p>The same subjects were then asked: <em>In addition to whatever you own, you have been given $2000, now choose between the gambles <span class="math inline">\(C = ( -1000 , 0.5 )\)</span> and <span class="math inline">\(D = ( -500 , 1 )\)</span>.</em></p>
<ul>
<li><p>This time <span class="math inline">\(C\)</span> was more popular.</p></li>
<li><p>The key here is that their final wealth positions are identical yet people chose differently. The subjects are apparently focusing only on gains and losses.</p></li>
</ul>
<p>When they are not given any information about prior winnings, they choose <span class="math inline">\(B\)</span> over <span class="math inline">\(A\)</span> and <span class="math inline">\(C\)</span> over <span class="math inline">\(D\)</span>. Clearly for a risk averse people this is the rational choice.</p>
<ul>
<li>This effect is known as loss aversion.</li>
</ul>
</section>
<section id="representativeness" class="slide level2">
<h2>Representativeness</h2>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Representativeness</strong></p>
</div>
<div class="callout-content">
<p>When people try to determine the probability that evidence <span class="math inline">\(A\)</span> was generated by model <span class="math inline">\(B\)</span>, they often use the representative heuristic. This means that they evaluate the probability by the degree to which <span class="math inline">\(A\)</span> reflects the essential characteristics of <span class="math inline">\(B\)</span>.</p>
</div>
</div>
</div>
<ul>
<li>A common bias is <em>base rate neglect</em> or ignoring prior evidence.</li>
<li>For example, in tossing a fair coin the sequence <em>HHTHTHHTHH</em> with seven heads is likely to appear and yet people draw conclusions from too few data points and think 7 heads is representative of the true process and conclude <span class="math inline">\(p=0.7\)</span>.</li>
</ul>
</section>
<section id="expected-utility-eu-theory-normative" class="slide level2 smaller">
<h2>Expected Utility (EU) Theory: Normative</h2>
<p>Let <span class="math inline">\(P,Q\)</span> be two probability distributions or <em>risky gambles/lotteries</em>.</p>
<p><span class="math inline">\(p P + (1 - p ) Q\)</span> is the <em>compound</em> or <em>mixture</em> lottery.</p>
<p>The rational agent (You) will have preferences between gambles.</p>
<ul>
<li>We write <span class="math inline">\(P \succeq Q\)</span> if and only if You strictly prefer <span class="math inline">\(P\)</span> to <span class="math inline">\(Q\)</span>. If two lotteries are <em>indifferent</em> we write <span class="math inline">\(P \sim Q\)</span>.</li>
<li>EU – a number of plausible axioms – completeness, transitivity, continuity and independence – then preferences are an expectation of a utility function.</li>
<li>The theory is a <em>normative</em> one and not necessarily <em>descriptive</em>. It suggests how a rational agent should formulate beliefs and preferences and not how they actually behave.</li>
<li>Expected utility <span class="math inline">\(U(P)\)</span> of a risky gamble is then</li>
</ul>
<p><span class="math display">\[
P \succeq Q \; \; \iff \; \; U (P) \geq U (Q )
\]</span></p>
</section>
<section id="key-facts" class="slide level2 scrollable">
<h2>Key Facts</h2>
<p>The two key facts then are uniqueness of probability and existence of expected utility. Formally,</p>
<ol type="1">
<li>If <span class="math inline">\(P \succeq R \succeq Q\)</span> and <span class="math inline">\(w P + (1 - w ) Q \sim R\)</span> then <span class="math inline">\(w\)</span> is unique.</li>
<li>There exists an expected utility <span class="math inline">\(U(\cdot )\)</span> such that <span class="math inline">\(P \succeq Q \; \; \iff \; \; U (P) \geq U (Q)\)</span>. Furthermore <span class="math display">\[
U \left (w P + (1 - w ) Q \right ) = wU (P) +(1 - w ) U(Q)
\]</span> for any <span class="math inline">\(P, Q\)</span> and <span class="math inline">\(0 \leq w \leq 1\)</span>.</li>
</ol>
<p>This implies that <span class="math inline">\(U\)</span> is additive and it is also unique up to affine transformation.</p>
</section>
<section id="st.-petersburg-paradox" class="slide level2 smaller">
<h2>St.&nbsp;Petersburg Paradox</h2>
<p>What are you willing to pay to enter the following game?</p>
<ul>
<li>I toss a fair game and when the first head appears, on the <span class="math inline">\(T\)</span>th toss, I pay you <span class="math inline">\(\$2^T\)</span> dollars.</li>
<li>First, probability of first head on <span class="math inline">\(T\)</span>th toss is <span class="math inline">\(2^{-T}\)</span></li>
</ul>
<p><span class="math display">\[
\begin{aligned}
E ( X) &amp; = \sum_{T=1}^{\infty}  2^T 2^{-T} \\
    &amp; = 2 ( 1/2) + 4 (1/4) + 8(1/8) + \ldots \\
    &amp; = 1 + 1 + 1+  \ldots \rightarrow \infty
\end{aligned}
\]</span> - Bernoulli (1754) constructed utility to value bets with <span class="math inline">\(E( u(X) )\)</span>.</p>
<p>Some examples of utility functions are,</p>
<ul>
<li><span class="math inline">\(U(x) = V_0 (1-x^{-\alpha})\)</span>, <span class="math inline">\(\alpha &gt; 0\)</span>, which gives an expected utility of <span class="math inline">\(V_0 \left(1-\frac{1}{2^{\alpha+1}-1}\right)\)</span></li>
<li>Log utility, <span class="math inline">\(U(x) = \log(x)\)</span>, with expected value <span class="math inline">\(2 \log(2)\)</span>.</li>
</ul>
<p>Notice that after obtaining an expected utility value, you’ll have to find the corresponding reward/dollar amount.</p>
</section>
<section id="attitudes-to-risk" class="slide level2 scrollable">
<h2>Attitudes to Risk</h2>
<p>Two gambles</p>
<ol type="1">
<li>get <span class="math inline">\(P_1\)</span> for sure</li>
<li>get <span class="math inline">\(P_2 = P_1+k\)</span> and <span class="math inline">\(P_3 = P_1-k\)</span> with probability 1/2.</li>
</ol>
<ul>
<li>Risk neutral: indifferent about fair bets, has linear utility.</li>
<li>Risk averse: prefers certainty over fair bets, concave utility.</li>
<li>Risk loving: prefers fair bets over certainty, convex utility.</li>
</ul>
<p>Then we will compare the utility of those gambles</p>
</section>
<section id="attitudes-to-risk-1" class="slide level2">
<h2>Attitudes to Risk</h2>
<p>The solution depends on your <em>risk</em> preferences:</p>
<ul>
<li><p><em>Risk neutral:</em> a risk neutral person is indifferent about fair bets.</p>
<p>Linear Utility</p></li>
<li><p><em>Risk averse:</em> a risk averse person prefers certainty over fair bets. <span class="math display">\[
\mathbb{E}( U(X) ) &lt; U \left ( \mathbb{E}(X) \right ) \; .
\]</span> Concave utility</p></li>
<li><p><em>Risk loving:</em> a risk loving person prefer fair bets over certainty.</p></li>
</ul>
<p>Depends on <span style="color: red">your</span> preferences.</p>
</section>
<section id="ellsberg-paradox" class="slide level2 scrollable">
<h2>Ellsberg Paradox</h2>
<p><em>Probability is counter-intuitive!!!</em></p>
<p>Two urns</p>
<ol type="1">
<li>100 balls with 50 red and 50 blue.</li>
<li>A mix of red and blue but you don’t know the proportion.</li>
</ol>
<ul>
<li>Which urn would you like to bet on?</li>
<li>People don’t like the <span style="color: blue">“uncertainty”</span> about the distribution of red/blue balls in the second urn.</li>
</ul>
</section>
<section id="allais-paradox" class="slide level2 smaller">
<h2>Allais Paradox</h2>
<p>You have to make a choice between the following gambles</p>
<p>First compare the “Gambles”</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;">Experiment 1</th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Gamble <span class="math inline">\(G_1\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">Gamble <span class="math inline">\(G_2\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">Win</td>
<td style="text-align: center;">Chance</td>
<td style="text-align: center;">Win</td>
<td style="text-align: center;">Chance</td>
</tr>
<tr class="odd">
<td style="text-align: center;">$25m</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">$25m</td>
<td style="text-align: center;">0.1</td>
</tr>
<tr class="even">
<td style="text-align: center;">$5m</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">$5m</td>
<td style="text-align: center;">0.89</td>
</tr>
<tr class="odd">
<td style="text-align: center;">$0m</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">$0m</td>
<td style="text-align: center;">0.01</td>
</tr>
</tbody>
</table>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;">Experiment 2</th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Gamble <span class="math inline">\(G_3\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">Gamble <span class="math inline">\(G_4\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">Win</td>
<td style="text-align: center;">Chance</td>
<td style="text-align: center;">Win</td>
<td style="text-align: center;">Chance</td>
</tr>
<tr class="odd">
<td style="text-align: center;">$25</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">$25m</td>
<td style="text-align: center;">0.1</td>
</tr>
<tr class="even">
<td style="text-align: center;">$5</td>
<td style="text-align: center;">0.11</td>
<td style="text-align: center;">$5m</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">$0m</td>
<td style="text-align: center;">0.89</td>
<td style="text-align: center;">$0m</td>
<td style="text-align: center;">0.9</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>If <span class="math inline">\(G_1 \geq G_2\)</span> then <span class="math inline">\(G_3 \geq G_4\)</span> and vice-versa.</p>
</section>
<section id="solution-expected-utility" class="slide level2 smaller">
<h2>Solution: Expected Utility</h2>
<p>Given (subjective) probabilities <span class="math inline">\(P = ( p_1 , p_2 , p_3 )\)</span>. Write <span class="math inline">\(E ( U | P )\)</span> for expected utility. W.l.o.g. set <span class="math inline">\(u ( 0 ) = 0\)</span> and for the high prize set <span class="math inline">\(u(\$25 \; {\rm million} ) = 1\)</span>. Which leaves one free parameter <span class="math inline">\(u = u (\$5 \; {\rm million} )\)</span>.</p>
<ul>
<li>Hence to compare gambles with probabilities <span class="math inline">\(P\)</span> and <span class="math inline">\(Q\)</span> we look at the difference <span class="math display">\[
E ( u | P ) - E ( u | Q ) = ( p_2 - q_2 ) u + ( p_3 - q_3 )
\]</span></li>
<li>For comparing <span class="math inline">\(G_1\)</span> and <span class="math inline">\(G_2\)</span> we get <span class="math display">\[
\begin{aligned}
  E ( u | G_1 ) - E ( u | G_2 ) &amp;= 0.11 u - 0.1 \\
  E ( u | G_3 ) - E ( u | G_4 ) &amp;= 0.11 u - 0.1
  \end{aligned}
\]</span> The order is the same, given <em>your</em> <span class="math inline">\(u\)</span>.</li>
<li>If your utility satisfies <span class="math inline">\(u &lt; 0.1/0.11 = 0.909\)</span> you take the “riskier” gamble.</li>
</ul>
</section>
<section id="power-utility" class="slide level2">
<h2>Power Utility</h2>
<p>Power and log-utilities</p>
<ul>
<li>Constant relative risk aversion (CRRA).</li>
<li>Advantage that the optimal rule is unaffected by wealth effects. The CRRA utility of wealth takes the form</li>
</ul>
<p><span class="math display">\[
U_\gamma (W) = \frac{ W^{1-\gamma} -1 }{1-\gamma}
\]</span> - The special case <span class="math inline">\(U(W) = \log (W )\)</span> for <span class="math inline">\(\gamma = 1\)</span>.</p>
<p>This leads to a myopic Kelly criterion rule.</p>
</section>
<section id="kelly-criterion" class="slide level2">
<h2>Kelly Criterion</h2>
<p>Kelly Criterion corresponds to betting under binary uncertainty. - Consider a sequence of i.i.d. bets where</p>
<p><span class="math display">\[
p ( X_t = 1 ) = p \; \; {\rm and} \; \; p ( X_t = -1 ) = q=1-p
\]</span> The optimal allocation is <span class="math inline">\(\omega^\star = p - q = 2 p - 1\)</span>.</p>
<ul>
<li>Maximising the expected long-run growth rate leads to the solution</li>
</ul>
<p><span class="math display">\[
\begin{aligned}
\max_\omega \mathbb{E} \left ( \ln ( 1 + \omega W_T ) \right )
&amp; = p \ln ( 1 + \omega ) + (1 -p) \ln (1 - \omega ) \\
&amp; \leq p \ln p + q \ln q + \ln 2 \; {\rm and} \; \omega^\star = p - q
\end{aligned}
\]</span></p>
</section>
<section id="kelly-criterion-1" class="slide level2">
<h2>Kelly Criterion</h2>
<ul>
<li>Let <span class="math inline">\(p\)</span> denote the probability of a gain and <span class="math inline">\(O = (1-p)/p\)</span> the odds. We can generalize the rule to the case of asymmetric payouts <span class="math inline">\((a,b)\)</span> where</li>
</ul>
<p><span class="math display">\[
p ( X_t = 1 ) = p \; \; {\rm and} \; \; p ( X_t = -1 ) = q=1-p
\]</span> - Then the expected utility function is</p>
<p><span class="math display">\[
p \ln ( 1 + b \omega ) + (1 -p) \ln (1 - a \omega )
\]</span> - The optimal solution is</p>
<p><span class="math display">\[
\omega^\star = \frac{bp - a q}{ab} = \frac{p-q}{\sigma}
\]</span></p>
</section>
<section id="kelly-criterion-2" class="slide level2">
<h2>Kelly Criterion</h2>
<ul>
<li>If <span class="math inline">\(a=b=1\)</span> this reduces to the pure Kelly criterion.</li>
<li>A common case occurs when <span class="math inline">\(a=1\)</span> and market odds <span class="math inline">\(b=O\)</span>. The rule becomes <span class="math display">\[
\omega^\star = \frac{p \cdot O  -q }{O}
\]</span></li>
</ul>
<p>Two possible market opportunities: one where it offers you <span class="math inline">\(4/1\)</span> when you have personal odds of <span class="math inline">\(3/1\)</span> and a second one when it offers you <span class="math inline">\(12/1\)</span> while you think the odds are <span class="math inline">\(9/1\)</span>.</p>
<p>In expected return these two scenarios are identical both offering a 33% gain.</p>
<p>In terms of maximizing long-run growth, however, they are not identical.</p>
</section>
<section id="example-1" class="slide level2">
<h2>Example</h2>
<ul>
<li>Table below shows the Kelly criteria advises an allocation that is twice as much capital to the lower odds proposition: <span class="math inline">\(1/16\)</span> weight versus <span class="math inline">\(1/40\)</span>.</li>
</ul>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">Market</th>
<th style="text-align: center;">You</th>
<th style="text-align: center;"><span class="math inline">\(p\)</span></th>
<th style="text-align: left;"><span class="math inline">\(\omega^\star\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(4/1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(3/1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(1/4\)</span></td>
<td style="text-align: left;"><span class="math inline">\(1/16\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(12/1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(9/1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(1/10\)</span></td>
<td style="text-align: left;"><span class="math inline">\(1/40\)</span></td>
</tr>
</tbody>
</table>
<ul>
<li>The optimal allocation <span class="math inline">\(\omega^\star = ( p O - q ) / O\)</span> is</li>
</ul>
<p><span class="math display">\[
\frac{ (1/4) \times 4 - (3/4) }{4} = \frac{1}{16} \; {\rm and} \;
    \frac{ (1/10) \times 12 - (9/10) }{12} = \frac{1}{40}
\]</span></p>
</section>
<section id="parrandos-paradoxes" class="slide level2">
<h2>Parrando’s Paradoxes</h2>
<p>Two losing bets can be combined to a winner</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<ul>
<li>Bernoulli market: <span class="math inline">\(1+f\)</span> or <span class="math inline">\(1-f\)</span> with <span class="math inline">\(p=0.51\)</span> and <span class="math inline">\(f = 0.05\)</span></li>
<li>Positive Expectation</li>
<li>Caveat: Growth governed by the median/entropy <span class="math display">\[
\begin{aligned}
  p \log( 1 + f) &amp; + (1-p)\log(1-f) \\
   &amp; = -0.00025 &lt; 0
  \end{aligned}
\]</span> Brownian Ratchets and cross-entropy of Markov processes</li>
</ul>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<p><img data-src="fig/universal1.svg" alt="image"><br>
Two Losing Bets+Volatility</p>
</div>
</div>
</div>
</section>
<section id="parrando" class="slide level2">
<h2>Parrando</h2>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="fig/universal2.svg" style="width:100.0%"></p>
<figcaption>Optimal allocation <span class="math inline">\(\omega\)</span></figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="fig/universal3.svg" style="width:100.0%"></p>
<figcaption>Ex Ante vs Ex Post Realisation</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="breiman-kelly-merton-rule" class="slide level2 smaller scrollable">
<h2>Breiman-Kelly-Merton Rule</h2>
<p>Kelly Criterion: Optimal wager in binary setting <span class="math display">\[
\omega^\star = \frac{p \cdot O  -q }{O}
\]</span></p>
<p>Merton’s Rule: in continuous setting is Kelly <span class="math display">\[
\omega^\star = \frac{1}{\gamma} \frac{\mu}{\sigma^2}
\]</span></p>
<ol type="1">
<li><span class="math inline">\(\mu\)</span>: (excess) expected return</li>
<li><span class="math inline">\(\sigma\)</span>: volatility</li>
<li><span class="math inline">\(\gamma\)</span>: risk aversion</li>
<li><span class="math inline">\(\omega^\star\)</span>: optimal position size</li>
<li><span class="math inline">\(p= Prob(Up), q = Prob(Down), O = Odds\)</span></li>
</ol>
</section>
<section id="example-kelly-criterion-sp500" class="slide level2">
<h2>Example: Kelly Criterion S&amp;P500:</h2>
<p>Consider logarithmic utility (CRRA with <span class="math inline">\(\gamma=1\)</span>). This is a pure Kelly rule.</p>
<ul>
<li>We assume iid log-normal stock returns with an annualized expected excess return of <span class="math inline">\(5.7\)</span>% and a volatility of 16% which is consistent will long-run equity returns. In our continuous time formulation <span class="math inline">\(\omega^\star = 0.057/0.16^2 = 2.22\)</span> and the Kelly criterion which imply that the investor borrows 122% of wealth to invest a total of 220% in stocks. This is a the risk-profile of the Kelly criterion.</li>
<li>One also sees that the allocation is highly sensitive to estimation error in <span class="math inline">\(\hat{\mu}\)</span>. We consider dynamic learning in a later section and show how the long horizon and learning affects the allocation today.</li>
</ul>
</section>
<section id="fractional-kelly" class="slide level2">
<h2>Fractional Kelly</h2>
<p>The fractional Kelly rule leads to a more realistic allocation.</p>
<ul>
<li>Suppose that <span class="math inline">\(\gamma = 3\)</span>. Then the informational ratio is <span class="math display">\[
\frac{\mu}{\sigma^2} = \frac{0.057}{0.16} = 0.357 \; {\rm and} \;
  \omega^\star = \frac{1}{3} \frac{0.057}{0.16^2} = 74.2\%
\]</span></li>
<li>An investor with such a level of risk aversion then has a more reasonable <span class="math inline">\(74.2\)</span>% allocation.</li>
<li>This analysis ignores the equilibrium implications. If every investor acted this way, then this would drive up prices and drive down the equity premium of <span class="math inline">\(5.7\)</span>%.</li>
</ul>
</section>
<section id="rule" class="slide level2">
<h2>60-40 Rule</h2>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="fig/60-40-rule.svg" style="width:100.0%"></p>
<figcaption>.</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="fig/60-40-rule1.svg" style="width:100.0%"></p>
<figcaption>.</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="keynes" class="slide level2">
<h2>Keynes</h2>
<p>Optimal Bayes Rebalancing</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="fig/universal2-k.svg" style="width:100.0%"></p>
<figcaption>Optimal allocation <span class="math inline">\(\omega\)</span></figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="fig/universal3-k.svg" style="width:100.0%"></p>
<figcaption>Keynes vs Universal vs Cash</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="winners-curse" class="slide level2 smaller">
<h2>Winner’s Curse</h2>
<p>Immediately after you have win, you should feel a little regret!</p>
<p>Claiming racehorse whose value is uncertain</p>
<table class="caption-top">
<thead>
<tr class="header">
<th>Value</th>
<th>Outcome</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>horse never wins</td>
</tr>
<tr class="even">
<td>50,000</td>
<td>horse improves</td>
</tr>
</tbody>
</table>
<p>Simple expected value tells you <span class="math display">\[
E(X) = \frac{1}{2} \cdot 0 + \frac{1}{2} \cdot 50,000 = \$25,000.
\]</span> In a $20,000 claiming race (you can buy the horse for this fixed fee ahead of time from the owner) it looks like a simple decision to claim the horse.</p>
<p><em>Asymmetric information!</em></p>
</section>
<section id="lemons-problem" class="slide level2">
<h2>Lemon’s Problem</h2>
<ul>
<li>Asymmetric information.</li>
<li>Proposed by George Akerlof in his 1970 paper “The Market for Lemons: Quality Uncertainty and the Market Mechanism.”</li>
<li>The lemons principle: low-value cars force high-value cars out of the market because of the asymmetrical information</li>
<li>Seller does not know what the true value of a used car is and, not willing to pay a premium o</li>
<li>Sellers are not willing to sell below the premium price so this results in only lemons being sold.</li>
</ul>
</section>
<section id="lemons-problem-1" class="slide level2">
<h2>Lemon’s Problem</h2>
<ul>
<li><p>Suppose that a dealer pays $20K for a car and wants to sell for $25K, a lemon is only worth $5K.</p></li>
<li><p>Let’s first suppose only 10% of cars are lemons, the customer’s calculations are <span class="math display">\[
E (X)= \frac{9}{10} \cdot 25 + \frac{1}{10} \cdot 5 = \$ 23 K
\]</span></p></li>
<li><p>Dealer is missing $2000. Therefore, they should try and persuade the customer its not a lemon by offering a warranty for example.</p></li>
</ul>
</section>
<section id="lemons-problem-2" class="slide level2 smaller">
<h2>Lemon’s Problem</h2>
<ul>
<li>The more interesting case is when <span class="math inline">\(p=0.5\)</span>. The customer now values the car at <span class="math display">\[
E (X)  = \frac{1}{2} \cdot 25 + \frac{1}{2} \cdot 5 = \$ 15K
\]</span></li>
<li>This is lower than the $20K – the reservation price that the dealer would have for a good car. Now what type of car and at what price do they sell?</li>
<li>At $15K dealer is only willing to sell a lemon.</li>
<li>But then if the customer computes a conditional expectation <span class="math display">\[
E ( X \mid L ) = 1 \cdot  5 = \$ 5K
\]</span> Therefore only lemons sell, at $ 5K, even if the dealer has a perfectly good car the customer is not willing to buy!</li>
</ul>
<p>Again what should the dealer do?</p>
</section>
<section>
<section id="decision-trees" class="title-slide slide level1 center">
<h1>Decision Trees</h1>

</section>
<section id="medical-testing" class="slide level2">
<h2>Medical Testing</h2>
<ul>
<li>A patient goes to see a doctor.</li>
<li>The doctor performs a test which is 95% sensitive – that is 95 percent of people who are sick test positive and 99% specific – that is 99 percent of the healthy people test negative.</li>
<li>The doctor also knows that only 1 percent of the people in the country are sick. Now the question is: if the patient tests positive, what are the chances the patient is sick? The intuitive answer is 99 percent, but the correct answer is 66 percent.</li>
</ul>
</section>
<section id="decision-trees-medical-testing" class="slide level2">
<h2>Decision Trees: Medical Testing</h2>
<ul>
<li><span class="math inline">\(D=1\)</span> that indicates you have a disease</li>
<li><span class="math inline">\(T=1\)</span> that indicates you tested positive</li>
</ul>
<div class="cell" data-reveal="true" data-layout-align="default">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource default number-lines code-with-copy"><code class="sourceCode default"><span id="cb1-1"><a></a>flowchart LR</span>
<span id="cb1-2"><a></a>  D[D] --&gt;|0.02| D1(D=1)</span>
<span id="cb1-3"><a></a>  D --&gt;|0.98| D0(D=0)</span>
<span id="cb1-4"><a></a>  D1 --&gt;|0.95| D1T1(T=1)</span>
<span id="cb1-5"><a></a>  D1 --&gt;|0.05| D1T0(T=0)</span>
<span id="cb1-6"><a></a>  D0 --&gt;|0.01| D0T1(T=1)</span>
<span id="cb1-7"><a></a>  D0 --&gt;|0.99| D0T0(T=0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-medtree" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-medtree-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div>
<pre class="mermaid mermaid-js" data-label="fig-medtree">flowchart LR
  D[D] --&gt;|0.02| D1(D=1)
  D --&gt;|0.98| D0(D=0)
  D1 --&gt;|0.95| D1T1(T=1)
  D1 --&gt;|0.05| D1T0(T=0)
  D0 --&gt;|0.01| D0T1(T=1)
  D0 --&gt;|0.99| D0T0(T=0)
</pre>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-medtree-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Medical Diagnostics Decision Tree.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="medical-testing-intuition" class="slide level2">
<h2>Medical Testing: Intuition</h2>
<ul>
<li><p>Imagine that the above story takes place in a small town, with <span class="math inline">\(1,000\)</span> people.</p></li>
<li><p>Prior: 20 people, are sick, and 980 are healthy.</p></li>
<li><p>Aminister the test to everyone: 19 of the 20 sick people test positive, 9.8 of the healthy people test positive, we round it to 10.</p></li>
<li><p>Now if the doctor sends everyone who tests positive to the national hospital, there will be 10 healthy and 19 sick patients. 1 to 2 ratio or 66 percent of the patients are healthy.</p></li>
</ul>
</section>
<section id="medical-testing-with-utility" class="slide level2 smaller">
<h2>Medical Testing: With utility</h2>
<ul>
<li>The decision problem is to treat <span class="math inline">\(a_T\)</span> or not to treat <span class="math inline">\(a_N\)</span></li>
</ul>
<table class="caption-top">
<caption>Utility of the test and the treatment.</caption>
<thead>
<tr class="header">
<th>A/S</th>
<th><span class="math inline">\(a_T\)</span></th>
<th><span class="math inline">\(a_N\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(D_0\)</span></td>
<td>90</td>
<td>100</td>
</tr>
<tr class="even">
<td><span class="math inline">\(D_1\)</span></td>
<td>90</td>
<td>0</td>
</tr>
</tbody>
</table>
<p>Then expected (unconditional) utility of the treatment is 90 and no treatment is 98. A huge difference. Given our prior knowledge, we should not treat everyone.</p>
<p>How does the utility will change when our probability of disease changes?</p>
</section>
<section id="medical-testing-with-utility-1" class="slide level2">
<h2>Medical Testing: With utility</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a></a>p <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.01</span>)</span>
<span id="cb2-2"><a></a><span class="fu">plot</span>(p, <span class="dv">100</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p), <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">xlab =</span> <span class="st">"p"</span>, <span class="at">ylab =</span> <span class="st">"$E[U(a)]$"</span>)</span>
<span id="cb2-3"><a></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">90</span>, <span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb2-4"><a></a><span class="fu">legend</span>(<span class="st">"bottomleft"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"$E[U(a_N)]$"</span>, <span class="st">"$E[U(a_T)]$"</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"red"</span>), <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">bty=</span><span class="st">'n'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="02-utility_files/figure-revealjs/unnamed-chunk-2-1.png" width="960" class="r-stretch quarto-figure-center"><p class="caption">Expected utility of the treatment and no treatment as a function of the prior probability of disease.</p><p>The crossover point is. <span class="math display">\[
100(1-p) = 90, ~p = 0.1
\]</span></p>
</section>
<section id="medical-testing-with-utility-2" class="slide level2">
<h2>Medical Testing: With utility</h2>
<p>The gap of of <span class="math inline">\(0.9-100(1-p)\)</span> is the expected gain from treatment.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a></a><span class="fu">plot</span>(p, <span class="dv">90-100</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p), <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">xlab =</span> <span class="st">"p"</span>, <span class="at">ylab =</span> <span class="st">"Utility gain from treatment"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="02-utility_files/figure-revealjs/unnamed-chunk-3-1.png" width="960" class="r-stretch"></section>
<section id="medical-testing-the-value-of-test" class="slide level2">
<h2>Medical Testing: The value of test</h2>
<p>We will need to calculate the posterior probabilities</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a></a><span class="co"># P(D | T = 0) = P(T = 0 | D) P(D) / P(T = 0)</span></span>
<span id="cb4-2"><a></a>pdt0 <span class="ot">=</span> <span class="fl">0.05</span><span class="sc">*</span><span class="fl">0.02</span><span class="sc">/</span>(<span class="fl">0.05</span><span class="sc">*</span><span class="fl">0.02</span> <span class="sc">+</span> <span class="fl">0.99</span><span class="sc">*</span><span class="fl">0.98</span>) </span>
<span id="cb4-3"><a></a><span class="fu">print</span>(pdt0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.001029654</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a></a><span class="co"># Expected utility given the test is negative </span></span>
<span id="cb6-2"><a></a><span class="co"># E[U(a_N | T=0)]</span></span>
<span id="cb6-3"><a></a>UN0 <span class="ot">=</span> pdt0<span class="sc">*</span><span class="dv">0</span> <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span>pdt0)<span class="sc">*</span><span class="dv">100</span></span>
<span id="cb6-4"><a></a><span class="fu">print</span>(UN0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 99.89703</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a></a><span class="co"># E[U(a_T | T=0)]</span></span>
<span id="cb8-2"><a></a>UT0 <span class="ot">=</span> pdt0<span class="sc">*</span><span class="dv">90</span> <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span>pdt0)<span class="sc">*</span><span class="dv">90</span></span>
<span id="cb8-3"><a></a><span class="fu">print</span>(UT0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 90</code></pre>
</div>
</div>
<p>Given test is negative, our best action is not to treat. Our utility is 100. What if the test is positive?</p>
</section>
<section id="medical-testing-the-value-of-test-1" class="slide level2">
<h2>Medical Testing: The value of test</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a></a><span class="co"># P(D | T = 1) = P(T = 1 | D) P(D) / P(T = 1)</span></span>
<span id="cb10-2"><a></a>pdt <span class="ot">=</span> <span class="fl">0.95</span><span class="sc">*</span><span class="fl">0.02</span><span class="sc">/</span>(<span class="fl">0.95</span><span class="sc">*</span><span class="fl">0.02</span> <span class="sc">+</span> <span class="fl">0.01</span><span class="sc">*</span><span class="fl">0.98</span>)</span>
<span id="cb10-3"><a></a><span class="fu">print</span>(pdt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6597222</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a></a><span class="co"># E[U(a_N | T=1)]</span></span>
<span id="cb12-2"><a></a>UN1 <span class="ot">=</span> pdt<span class="sc">*</span><span class="dv">0</span> <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span>pdt)<span class="sc">*</span><span class="dv">100</span></span>
<span id="cb12-3"><a></a><span class="fu">print</span>(UN1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 34.02778</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a></a><span class="co"># E[U(a_T | T=1)]</span></span>
<span id="cb14-2"><a></a>UT1 <span class="ot">=</span> pdt<span class="sc">*</span><span class="dv">90</span> <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span>pdt)<span class="sc">*</span><span class="dv">90</span></span>
<span id="cb14-3"><a></a><span class="fu">print</span>(UT1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 90</code></pre>
</div>
</div>
<p>The best option is to treat now! Given the test our strategy is to treat if the test is positive and not treat if the test is negative.</p>
</section>
<section id="medical-testing-the-value-of-test-2" class="slide level2">
<h2>Medical Testing: The value of test</h2>
<p>Let’s calculate the expected utility of this strategy.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a></a><span class="co"># P(T=1) = P(T=1 | D) P(D) + P(T=1 | D=0) P(D=0)</span></span>
<span id="cb16-2"><a></a>pt <span class="ot">=</span> <span class="fl">0.95</span><span class="sc">*</span><span class="fl">0.02</span> <span class="sc">+</span> <span class="fl">0.01</span><span class="sc">*</span><span class="fl">0.98</span></span>
<span id="cb16-3"><a></a><span class="fu">print</span>(pt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0288</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a></a><span class="co"># P(T=0) = P(T=0 | D) P(D) + P(T=0 | D=0) P(D=0)</span></span>
<span id="cb18-2"><a></a>pt0 <span class="ot">=</span> <span class="fl">0.05</span><span class="sc">*</span><span class="fl">0.02</span> <span class="sc">+</span> <span class="fl">0.99</span><span class="sc">*</span><span class="fl">0.98</span></span>
<span id="cb18-3"><a></a><span class="fu">print</span>(pt0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9712</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a></a><span class="co"># Expected utility of the strategy</span></span>
<span id="cb20-2"><a></a>pt<span class="sc">*</span>UT1 <span class="sc">+</span> pt0<span class="sc">*</span>UN0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 99.612</code></pre>
</div>
</div>
<p>The utility of out strategy of 100 is above of the strategy prior to testing (98), this difference of 2 is called the <em>value of information</em>.</p>
</section>
<section id="nash-equilibrium" class="slide level2">
<h2>Nash Equilibrium</h2>
<ul>
<li>When multiple decision makers interact with each other, meaning the decision of one player changes the state of the “world” and thus affects the decision of another player - Nash equilibrium: a set of strategies where no player can improve their payoff by unilaterally changing their strategy, assuming others keep their strategies constant.</li>
<li>No player has an incentive to deviate from their current strategy, given the strategies of the other players.</li>
</ul>
</section>
<section id="nash-equilibrium-1" class="slide level2">
<h2>Nash Equilibrium</h2>
<ul>
<li>Prisoner’s Dilemma: Two prisoners must decide whether to cooperate with each other or defect. The Nash equilibrium is for both to defect, even though they would be better off if they both cooperated.</li>
<li>Pricing Strategies: Firms in a market choose prices to maximize profits, taking into account their competitors’ pricing decisions. The equilibrium is the set of prices where no firm can increase profits by changing its price unilaterally.</li>
<li>Traffic Flow: Drivers choose routes to minimize travel time, based on their expectations of other drivers’ choices. The equilibrium is the pattern of traffic flow where no driver can reduce their travel time by choosing a different route.</li>
</ul>
</section>
<section id="marble-game" class="slide level2">
<h2>Marble Game</h2>
<p>Two players <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> have both a red and a blue marble. They present one marble to each other. The payoff table is as follows:</p>
<ul>
<li>If both present red, <span class="math inline">\(A\)</span> wins $3.</li>
<li>If both present blue, <span class="math inline">\(A\)</span> wins $1.</li>
<li>If the colors do not match, <span class="math inline">\(B\)</span> wins $2</li>
</ul>
<p>The <em>tit-for-tat</em> strategy, where you cooperate until your opponent defects. Then you match his last response.</p>
</section>
<section id="marble-game-1" class="slide level2">
<h2>Marble Game</h2>
<p>Nash equilibrium will also allow us to study the concept of a <em>randomized strategy</em> (ie. picking a choice with a certain probability) which turns out to be optimal in many game theory problems.</p>
<p>First, assume that the players have a <span class="math inline">\(\frac{1}{2}\)</span> probability of playing Red or Blue. Thus each player has the same expected payoff <span class="math inline">\(E(A) = 1\)</span> <span class="math display">\[\begin{align*}
    E(A) &amp;= \frac{1}{4} \cdot 3 + \frac{1}{4} \cdot 1 =1 \\
    E(B) &amp;= \frac{1}{4} \cdot 2 + \frac{1}{4} \cdot 2 =1
\end{align*}\]</span></p>
</section>
<section id="marble-game-2" class="slide level2">
<h2>Marble Game</h2>
<p>We might go one step further and look at the risk (and measured by a standard deviation) and calculate the variances of each players payout <span class="math display">\[\begin{align*}
    Var (A) &amp; = (1-1)^2 \cdot \frac{1}{4} +(3-1)^2 \cdot \frac{1}{4} + (0-1)^2 \cdot \frac{1}{2} = 1.5 \\
    Var(B) &amp; = 1^2 \cdot \frac{1}{2} + (2-1)^2 \cdot \frac{1}{2} = 1
\end{align*}\]</span> Therefore, under this scenario, if you are risk averse, player <span class="math inline">\(B\)</span> position is favored.</p>
</section>
<section id="marble-game-3" class="slide level2">
<h2>Marble Game</h2>
<p>The matrix of probabilities with equally likely choices is given by</p>
<table class="caption-top">
<thead>
<tr class="header">
<th><span class="math inline">\(A,B\)</span></th>
<th>Probability</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(P( red, red )\)</span></td>
<td>(1/2)(1/2)=1/4</td>
</tr>
<tr class="even">
<td><span class="math inline">\(P( red, blue )\)</span></td>
<td>(1/2)(1/2)=1/4</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(P( blue, red )\)</span></td>
<td>(1/2)(1/2)=1/4</td>
</tr>
<tr class="even">
<td><span class="math inline">\(P( blue, blue )\)</span></td>
<td>(1/2)(1/2)=1/4</td>
</tr>
</tbody>
</table>
<p>Now they is no reason to assume ahead of time that the players will decide to play <span class="math inline">\(50/50\)</span>. We will show that there’s a mixed strategy (randomized) that is a <em>Nash equilibrium</em> that is, both players won’t deviate from the strategy.</p>
</section>
<section id="marble-game-4" class="slide level2">
<h2>Marble Game</h2>
<p>We’ll prove that the following equilibrium happens:</p>
<ul>
<li><span class="math inline">\(A\)</span> plays Red with probability 1/2 and blue 1/2</li>
<li><span class="math inline">\(B\)</span> plays Red with probability 1/4 and blue 3/4</li>
</ul>
<p>In this case the expected payoff to playing Red equals that of playing Blue for each player. We can simply calculate: <span class="math inline">\(A\)</span>’s expected payoff is 3/4 and <span class="math inline">\(B\)</span>’s is $1 <span class="math display">\[
E(A) = \frac{1}{8} \cdot 3 + \frac{3}{8} \cdot 1 = \frac{3}{4}
\]</span> Moreover, <span class="math inline">\(E(B) =1\)</span>, thus <span class="math inline">\(E(B) &gt; E(A)\)</span>. We see that <span class="math inline">\(B\)</span> is the favored position. It is simple that if I know that you are going to play this strategy and vice-versa, neither of us will deviate from this strategy – hence the Nash equilibrium concept.</p>
</section>
<section id="marble-game-5" class="slide level2">
<h2>Marble Game</h2>
<p>Nash equilibrium probabilities are: <span class="math inline">\(p=P( A \; red )= 1/2, p_1 = P( B \; red ) = 1/4\)</span> with payout matrix</p>
<table class="caption-top">
<thead>
<tr class="header">
<th><span class="math inline">\(A,B\)</span></th>
<th>Probability</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(P( red, red )\)</span></td>
<td>(1/2)(1/4)=1/8</td>
</tr>
<tr class="even">
<td><span class="math inline">\(P( red, blue )\)</span></td>
<td>(1/2)(3/4)=3/8</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(P( blue, red )\)</span></td>
<td>(1/2)(1/4)=1/8</td>
</tr>
<tr class="even">
<td><span class="math inline">\(P( blue, blue )\)</span></td>
<td>(1/2)(3/4)=3/8</td>
</tr>
</tbody>
</table>
<p>We have general payoff probabilities: <span class="math inline">\(p=P( A \; red ), p_1 = P( B \; red )\)</span></p>
<p><span class="math display">\[\begin{align*}
    f_A ( p , p_1 ) =&amp; 3 p p_1 + ( 1 -p ) ( 1 - p_1 ) \\
    f_B ( p , p_1 ) =&amp; 2 \{ p(1 - p_1) + ( 1 -p ) p_1 \}
\end{align*}\]</span></p>
</section>
<section id="marble-game-6" class="slide level2">
<h2>Marble Game</h2>
<p>To find the equilibrium point <span class="math display">\[\begin{align*}
    ( \partial / \partial p ) f_A ( p , p_1 ) =&amp; 3 p_1 - ( 1 - p_1 ) = 4 p_1 -1 \; \; \mathrm{so} \; \; p_1= 1/4 \\
    ( \partial / \partial p_1 ) f_B ( p , p_1 ) =&amp; 2 ( 1 - 2p ) \; \; \mathrm{so} \; \; p= 1/2
\end{align*}\]</span></p>
<p>Much research has been directed to repeated games versus the one-shot game and is too large a topic to discuss further.</p>
<p><br> What are the drawbacks of the equilibrium analysis?</p>


</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="site_libs/revealjs/plugin/search/search.js"></script>
  <script src="site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1226,

        height: 920,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>