<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Bayes, AI and Deep Learning - 11&nbsp; Pattern Matching and Data Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../qmd/theoryai.html" rel="next">
<link href="../qmd/rl.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="../site_libs/quarto-diagram/mermaid.min.js"></script>
<script src="../site_libs/quarto-diagram/mermaid-init.js"></script>
<link href="../site_libs/quarto-diagram/mermaid.css" rel="stylesheet">
</head><body class="nav-sidebar floating fullcontent"><div class="hidden">
<p><span class="math display">\[
\newcommand{\prob}[1]{\operatorname{P}\left(#1\right)}
\newcommand{\Var}[1]{\operatorname{Var}\left(#1\right)}
\newcommand{\sd}[1]{\operatorname{sd}\left(#1\right)}
\newcommand{\Cor}[1]{\operatorname{Corr}\left(#1\right)}
\newcommand{\Cov}[1]{\operatorname{Cov}\left(#1\right)}
\newcommand{\E}[1]{\operatorname{E}\left(#1\right)}
\newcommand{\defeq}{\overset{\text{\tiny def}}{=}}
\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator*{\mini}{minimize}
\]</span></p>
</div>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>





<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../qmd/data.html">AI</a></li><li class="breadcrumb-item"><a href="../qmd/data.html"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Pattern Matching and Data Analysis</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Bayes, AI and Deep Learning</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Principles of Data Science</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Bayes</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/prob.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Probability and Uncertainty</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/bayes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Bayes Rule</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/dec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Utility, Risk and Decisions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/bl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Bayesian Parameter Learning</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/ab.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">AB Testing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/hyp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Bayesian Hypothesis Testing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/sp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Stochastic Processes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/gp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Gaussian Processes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/rl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Reinforcement Learning</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">AI</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/data.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Pattern Matching and Data Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/theoryai.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Theory of AI</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/glm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Linear and Multiple Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Generalized Linear Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/rct.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">RCT: Field vs Observational</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/select.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Model Selection</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/tree.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Tree Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/forecasting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Forecasting</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Deep Learning</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/nn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Neural Networks</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/dlopt.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Gradient Descent</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/arch.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Image Processing</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/ex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Exercises</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../qmd/data.html">AI</a></li><li class="breadcrumb-item"><a href="../qmd/data.html"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Pattern Matching and Data Analysis</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Pattern Matching and Data Analysis</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>The history of data analysis is closely intertwined with the development of pattern matching techniques. The ability to identify and understand patterns in data has been crucial for scientific discoveries, technological advancements, and decision-making. From the early days of astronomy to modern machine learning, pattern matching has played a pivotal role in advancing our understanding of the world around us. This chapter explores the historical development of pattern matching and its impact on data analysis, highlighting key figures and their contributions to the field.</p>
<p>Data science involves two major steps, collection and cleaning of large scale data sets and building a predictive model. In this chapter present the process of building predictive models. To illustrate the process think of your data as being generated by a black box on which a set of input variables <span class="math inline">\(x\)</span> go through the box and generate an output variable <span class="math inline">\(y\)</span>. A black box can be viewed as a model which describes how to find the output <span class="math inline">\(y\)</span> from the input <span class="math inline">\(x\)</span>. One of the key requirement of <span class="math inline">\(f\)</span> is that we should be able to efficiently find this function using an algorithm. In the simple case <span class="math inline">\(y\)</span> and <span class="math inline">\(x\)</span> are both univariate (scalars) and we can view the map as</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart LR
    x((x)) --&gt;f
    f--&gt; y((y))
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<p>Here the function <span class="math inline">\(f\)</span> provides the mapping <span class="math inline">\(y = f(x)\)</span>. The goal of machine learning is to reconstruct this this map from observed data. In a multivariate setting <span class="math inline">\(x = (x_1,\ldots,x_p)\)</span> is a list of <span class="math inline">\(p\)</span> variables. The hallmark nature of artificial intelligence (AI) is that <span class="math inline">\(p\)</span> can be extremely large. A multivariate map corresponds to a black box</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart LR
    x(("(x1...,xp)")) --&gt;f
    f--&gt; y((y))
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<p>This leads to a model of the form <span class="math inline">\(y = f(x_1,\ldots,x_p)\)</span>. There are a number of possible goals of analysis, such as estimation, inference or prediction. The main one being prediction.</p>
<p>The <strong>prediction</strong> task is to calculate a response that corresponds to a new feature input variable and the task of establishing a <strong>causation</strong> is to extract information about the nature of the black box association of the response variable to the input variables. The goal is to use data to find a pattern that we can exploit. The pattern will be ``statistical” in its nature. To uncover the pattern we start with a dataset, denoted by <span class="math display">\[
D = (y_i,x_i)_{i=1}^n
\]</span> and to test the validity of our mode we use out-of-sample dataset <span class="math display">\[
D^* = (y_j^*, x_j^*)_{j=1}^N,
\]</span> where <span class="math inline">\(x_i\)</span> is a set of <span class="math inline">\(p\)</span> predictors ans <span class="math inline">\(y_i\)</span> is response variable. Prediction problem is to use a training dataset <span class="math inline">\(D\)</span> to design a rule that can be used for predicting output values <span class="math inline">\(y\)</span> for new observations <span class="math inline">\(x\)</span>.</p>
<p>Let <span class="math inline">\(f(x)\)</span> be predictor of <span class="math inline">\(y\)</span>, we will use notation <span class="math display">\[\hat{y} = f(x).\]</span></p>
<p>To summarize, we will use the following notation.</p>
<table class="table">
<thead>
<tr class="header">
<th><span class="math inline">\(y\)</span></th>
<th>response/outcome/output variable</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(x\)</span></td>
<td>predictor/covariate/feature/input variable</td>
</tr>
<tr class="even">
<td><span class="math inline">\(f(x)\)</span></td>
<td>regression/classification/function estimation</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\hat y\)</span></td>
<td>prediction</td>
</tr>
</tbody>
</table>
<p>The process of building a model involves specification of three items</p>
<ul>
<li>How inputs are specified and what are the outputs?</li>
<li>How to construct the function <span class="math inline">\(f\)</span>, i.e.&nbsp;what algorithms to use and how to implement it?</li>
<li>What is the criteria to choose the best reconstructed function <span class="math inline">\(f\)</span>?</li>
</ul>
<p>We distinguish several types of input or output variables. First, variables that can only have two possible values, e.g.&nbsp;yes/no, left/right, 0/1, up/down, etc. A generalization of binary variable is a variable that can take a fixed number of possible values, for example, marriage status, number of vehicles owned. Additionally, some of the categorical variable can have a natural order to them, for example education level or salary range. Those variables are called . Lastly, the most common type of a variable is which is described by a real number.</p>
<p>Depending on the type of the output variable, there are three types of prediction problems</p>
<ul>
<li>When <span class="math inline">\(y\)</span> is binary <span class="math inline">\(y\in \{0,1\}\)</span> or categorical, <span class="math inline">\(y\in \{0,\ldots,K\}\)</span>, for <span class="math inline">\(K\)</span> possible categories, the prediction problem is called classification.</li>
<li>When <span class="math inline">\(y\)</span> is quantitative <span class="math inline">\(y \in R\)</span>. This is known as a regression.</li>
<li>When <span class="math inline">\(y\)</span> is ordinal, this problem known as ranking.</li>
</ul>
<p>Let us consider a few example problems that demonstrate the concepts of inputs, output and map.</p>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 11.1</strong></span> Consider the problem of medical diagnostics. In the previous chapter we considered a probabilistic formulation of this problem. Now we consider a problem of building a deterministic map between inputs: parameters of the patient at the given time and outputs: diagnosis or treatment. For example we have an incoming patient and do not have a doctor of the needed specialty to diagnose the patient. The goal is to design an algorithm that can replace the doctor and help the admitting nurse or hospitalist to make the decision. Examples of inputs can be</p>
<ul>
<li>binary: gender, headache, fatigue, vomit, etc.</li>
<li>ordinal: severity of the conditions, hemoglobin level</li>
<li>quantitative: age, pulse, blood pressure</li>
</ul>
<p>The output variable is categorical, thus we are solving the problem of classification.</p>
<p>In the problem of medical diagnostics we have to consider not only the problem of finding the best map but also problems of missing data, algorithm interpretability and it’s reliability, i.e.&nbsp;probabilistic measure of the accuracy. Probabilistic view, that we will discuss later in the chapter, can help assessing the reliability of our models.</p>
</div>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 11.2</strong></span> Credit scoring is another area where predictive models are currently widely used. The problem us to predict whether a specific loan will default or not. The input variable come from the application form and the output variable is binary: yes or no. Examples of input variable include</p>
<ul>
<li>binary: gender, home ownership</li>
<li>categorical: profession, home zip code</li>
<li>ordinal: education, job position</li>
<li>quantitative: age, salary, work experience, loans</li>
</ul>
<p>This is again a classification problem.</p>
</div>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 11.3</strong></span> Another economic example the problem of predicting revenue associated with each new client or a customer. For example on car insurance market, which is very mature, the problem is to predict what coverage a customer will buy and what are expenses associated with potential accidents. The examples of input variables are</p>
<ul>
<li>binary: corporate client, optional coverages</li>
<li>categorical: types of coverage, location</li>
<li>quantitative: age, accident frequency</li>
</ul>
<p>The problem of predicting revenue is the regression problem.</p>
</div>
<p>%Typically we have the following types of inputs: % %- <span class="math inline">\(X \in \{0,1\}\)</span> binary input %- <span class="math inline">\(X \in \{1,\ldots,M\}\)</span> categorical input %- <span class="math inline">\(X \in \{1,\ldots,M\}\)</span> and <span class="math inline">\(Y_j\)</span> has natural order to it - ordinal input %- <span class="math inline">\(X \in R\)</span> - quantitative input % % %Now, let’s enumerate different types of outputs % %- <span class="math inline">\(Y \in \{0,1\}\)</span> (binary classification) %- <span class="math inline">\(Y \in \{1,\ldots,K\}\)</span> - <span class="math inline">\(K\)</span> non-overlapping classes (classification) %- <span class="math inline">\(Y \in \{0,1\}^K\)</span> - <span class="math inline">\(K\)</span> overlapping classes (classification) %- <span class="math inline">\(Y \in R^m\)</span> (regression) %- <span class="math inline">\(Y \in O\)</span>, <span class="math inline">\(O\)</span> is an ordered set (ranking) %</p>
<p>We start with the most widely used type of predictive models, namely the parametric models. To find a parametric model, we search for a predictive rule among a parametrized family of functions <span class="math display">\[
F_{\beta} = \{f(x \mid  \beta) \mid \beta \in B\}
\]</span> here <span class="math inline">\(f:X\times B \rightarrow Y\)</span> is a fixed function and <span class="math inline">\(B\)</span> is a set of all possible values of the parameter <span class="math inline">\(\beta\)</span>.</p>
<p>There are a number of possibilities to specify such a family of functions:</p>
<ul>
<li>Linear combinations of inputs, e.g., <span class="math inline">\(f(x)=\beta_0+\beta_1x\)</span></li>
<li>Expand in terms of a set of basis functions, e.g., <span class="math inline">\(f(x)=\sum_{j=1}^M \beta_j \psi_j(x)\)</span>, where <span class="math inline">\(\psi_j\)</span> are given. Deep Learning/ Neural Net, generalizes this to <span class="math inline">\(\sum_{j=1}^M b_j \psi_j (w_j x+a_j)\)</span></li>
</ul>
<p>The goal of the modeler to choose an appropriate family of functions that does lead to a good reconstruction of the input-output relations (we will talk about the measure of goodness later) as well as simple to compute and interpret.</p>
<p>When <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> are real numbers, the simplest example of such a family of functions for a regression problem are the linear functions <span class="math display">\[
f(x\mid \beta) = \beta_0 + \beta_1 x
\]</span> or for classification <span class="math display">\[
f(x\mid \beta) = \mathrm{sign}\left(\beta_0 + \beta_1 x\right)
\]</span> Here the parameters <span class="math inline">\(\beta = (\beta_0,\beta_1)\)</span> are the constant and intercept parameters of our linear equation. We assume there is a linear relation between the input variable <span class="math inline">\(x\)</span> and output <span class="math inline">\(y\)</span>. In the binary classification case, we use the <span class="math inline">\(\mathrm{sign}\)</span> function to map a real number to binary class <span class="math inline">\(\{-1,+1\}\)</span>.</p>
<p>To select the best possible function <span class="math inline">\(f(x\mid \beta)\)</span> from a given parametrized family, we need to specify the criteria which will be used for the selection. A most natural way is to define a loss function that measures the risk of using the predictor rule <span class="math inline">\(f\)</span>. A choice of a loss function depends on the prediction problem we are solving.</p>
<ul>
<li>Classification loss function: <span class="math display">\[\mathrm{L}(f,x) = I(y\ne \hat y) \text{ where } Y\in \{0,1\}\]</span> % <span class="math display">\[\mathrm{risk}(f) = -\sum_{i=1}^K P(f(x) = i)\log P(\hat{Y} = 0)\]</span></li>
<li>Regression loss function: % <span class="math display">\[\mathrm{L}(f,x) = E ||Y- f(x)||^2\]</span> <span class="math display">\[\mathrm{L}(f,x) = (y- \hat y)^2 \text{ or } \mathrm{L}(f,x) = |y- \hat y|\]</span> % In general, <span class="math inline">\(X_i = {X_{i1},\ldots,X_{ip}} \in R^p\)</span>. One of these is how to calculate the optimal projector. For example, me and squared your loss % <span class="math display">\[
%   \hat{f}(x) = \E{Y\mid X=x}=\arg\min_f E(||Y - f(x)||^2)).
%   \]</span> %</li>
</ul>
<p>Here <span class="math inline">\(I\)</span> is an indicator function that converts logical True/False variable to 0/1 value <span class="math display">\[
I(x) = \left\{ \begin{array}{cc}
1, &amp; \text{ when $x$ =  True}\\
0, &amp; \text{ when $x$ =  False}.
\end{array}
\right.
\]</span></p>
<p>When we train our model using have a sample of size <span class="math inline">\(n\)</span> <span class="math inline">\(D = (y_i,x_i)_{i=1}^n\)</span>, we can calculate an empirical risk associated with the predictor <span class="math inline">\(f\)</span> by averaging the losses <span class="math display">\[
Q(f,X) = \dfrac{1}{n}\sum_{i=1}^{n}L(f,x_i)
\]</span> where <span class="math inline">\(X = (x_1,\ldots,x_n)\)</span> is the input sample available.</p>
<p>Now once we specified the family of functions and the loss function, which measures how good our reconstruction is, we need to find a specific function from this family. We do it by solving the optimization problem</p>
<p><span class="math display">\[
\hat{\beta} = \arg\min_{\beta \in B} Q\left(f(x\mid \beta),X\right)
\]</span> The model found by the optimization process <span class="math inline">\(f(x\mid \hat{\beta})\)</span> we will simply denote <span class="math inline">\(\hat{f}\)</span>.</p>
<p>%These fools from the sounds of squares to composition %<span class="math display">\[
%E(||Y - f(x)||^2 = E(||Y - f(x)||^2
%\]</span></p>
<p>%The case of pacification again we calculate <span class="math inline">\(\hat{f}(x) = E(Y\mid X = x)\)</span>. But now the best classifier is the Bayes classifier %<span class="math display">\[
%\hat{f}_B(x) = 1\left\{E(Y\mid X=x) &gt; \dfrac{1}{2})\right\}
%\]</span> %Again we can show that %<span class="math display">\[
%\mathrm{risk}(f) = P(Y\ne f(x) \mid X=x)\ge  \mathrm{risk}(\hat{f}_B(x))
%\]</span> %Even training data one approach to calculating classification risk is simply to use the empirical average %<span class="math display">\[
%\mathrm{risk}(\hat{f})  = \dfrac{1}{N}\sum_{i=1}^{N}I(Y_i\ne f(x_i))
%\]</span> %and we choose %<span class="math display">\[
%\hat{f}  = \arg\min_f \mathrm{risk}(f)
%\]</span></p>
<p><strong>Breiman’s Two Cultures</strong></p>
<p>Statistical prediction problems are of great practical and theoretical interest. The deep learning predictor has a number of advantages over traditional predictors, including that</p>
<ul>
<li>input data can include all data of possible relevance to the prediction problem at hand</li>
<li>nonlinearities and complex interactions among input data are accounted for seamlessly</li>
<li>overfitting is more easily avoided than traditional high dimensional procedures</li>
<li>there exists fast, scale computational frameworks (TensorFlow)</li>
</ul>
<p>Let <span class="math inline">\(x\)</span> be a high dimensional input containing a large set of potentially relevant data. Let <span class="math inline">\(y\)</span> represent an output (or response) to a task which we aim to solve based on the information in <span class="math inline">\(x\)</span>. Brieman [2000] summaries the difference between statistical and machine learning philosophy as follows.</p>
<blockquote class="blockquote">
<p>“There are two cultures in the use of statistical modeling to reach conclusions from data. One assumes that the data are generated by a given stochastic data model. The other uses algorithmic models and treats the data mechanism as unknown.”</p>
</blockquote>
<blockquote class="blockquote">
<p>“The statistical community has been committed to the almost exclusive use of data models. This commitment has led to irrelevant theory, questionable conclusions, and has kept statisticians from working on a large range of interesting current problems.”</p>
</blockquote>
<blockquote class="blockquote">
<p>“Algorithmic modeling, both in theory and practice, has developed rapidly in fields outside statistics. It can be used both on large complex data sets and as a more accurate and informative alternative to data modeling on smaller data sets. If our goal as a field is to use data to solve problems, then we need to move away from exclusive dependence on data models and adopt a more diverse set of tools.”</p>
</blockquote>
<section id="unreasonable-effectiveness-of-data" class="level1" data-number="12">
<h1 data-number="12"><span class="header-section-number">12</span> Unreasonable Effectiveness of Data</h1>
<p>Telescopes played a crucial role in the advancement of observational astronomy, enabling scientists like Carl Friedrich Gauss, Pierre-Simon Laplace, and Siméon Denis Poisson to collect large amounts of astronomical data. The availability of this data, in turn, led to the development of new data analysis techniques and statistical methods during the late 18th and early 19th centuries.</p>
<p>The availability of data from telescopic observations during the late 18th and early 19th centuries played a pivotal role in the development of new data analysis techniques by Gauss, Laplace, and Poisson. These techniques, such as the method of least squares and the Poisson distribution, were not only crucial for astronomy but also had broader applications in statistics and mathematical modeling. The integration of observational data and statistical methods marked a significant shift in the scientific approach, enabling more rigorous analysis and interpretation of astronomical phenomena.</p>
<p>Back in the 18th and 19th century data collection was often limited to manual measurements or observations, and the amount of available data was typically much smaller compared to the massive datasets encountered in modern data science. Scientists like Gauss and Poisson often conducted carefully designed experiments, collected their own data, and performed manual calculations without the aid of computers or advanced statistical software. The focus of their work was often on theoretical developments in mathematics, physics and astronomy, and the data was used to test and validate their theories. Let’s consider one of those studies from early 18th century.</p>
<div id="exm-Boscovich" class="theorem example">
<p><span class="theorem-title"><strong>Example 12.1 (Boscovich and Shape of Earth)</strong></span> The 18th century witnessed heated debates surrounding the Earth’s precise shape. While the oblate spheroid model – flattened poles and bulging equator – held sway, inconsistencies in measurements across diverse regions fueled uncertainty about its exact dimensions. The French, based on extensive survey work by Cassini, maintained the prolate view while the English, based on gravitational theory of Newton (1687), maintained the oblate view.</p>
<p>The determination of the exact figure of the earth would require very accurate measurements of the length of a degree along a single meridian. The final answer to this debate was given by Roger Boscovich (1711–1787) who used geodetic surveying principles and in collaboration with English Jesuit Christopher Maire, in 1755, they embarked on a bold project: measuring a meridian arc spanning a degree of latitude between Rome and Rimini. He employed ingenious techniques to achieve remarkable accuracy for his era, minimizing errors and ensuring the reliability of his data. In 1755 they published “De litteraria expeditione per pontificiam ditionem” (On the Scientific Expedition through the Papal States) that contained results of their survey and its analysis. For more details about the work of Boscovich, see <span class="citation" data-cites="altic2013">Altić (<a href="#ref-altic2013" role="doc-biblioref">2013</a>)</span>. <span class="citation" data-cites="stigler1981">Stigler (<a href="#ref-stigler1981" role="doc-biblioref">1981</a>)</span> gives an exhaustive introduction to the history of regression.</p>
<p>The data on meridian arcs used by Boscovich was crucial in determining the shape and size of the Earth. He combined data from five locations:</p>
<div class="cell" data-null_prefix="true">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>d<span class="ot">=</span><span class="fu">read.csv</span>(<span class="st">"../../data/boscovich.csv"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(d, <span class="at">digits =</span> <span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Location</th>
<th style="text-align: right;">Latitude</th>
<th style="text-align: right;">ArcLength</th>
<th style="text-align: right;">sin2Latitude</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Quito</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">56751</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cape of Good Hope</td>
<td style="text-align: right;">33</td>
<td style="text-align: right;">57037</td>
<td style="text-align: right;">2987</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Rome</td>
<td style="text-align: right;">43</td>
<td style="text-align: right;">56979</td>
<td style="text-align: right;">4648</td>
</tr>
<tr class="even">
<td style="text-align: left;">Paris</td>
<td style="text-align: right;">49</td>
<td style="text-align: right;">57074</td>
<td style="text-align: right;">5762</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Lapland</td>
<td style="text-align: right;">66</td>
<td style="text-align: right;">57422</td>
<td style="text-align: right;">8386</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(d<span class="sc">$</span>sin2Latitude,d<span class="sc">$</span>ArcLength, <span class="at">ylab=</span><span class="st">"Arc Length"</span>, <span class="at">xlab=</span><span class="fu">expression</span>(sin<span class="sc">^</span><span class="dv">2</span><span class="sc">~</span>(theta)), <span class="at">pch=</span><span class="dv">16</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">56700</span>,<span class="dv">57450</span>), <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">30</span>,<span class="dv">8590</span>))</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(d<span class="sc">$</span>sin2Latitude,d<span class="sc">$</span>ArcLength<span class="dv">-25</span>, <span class="at">labels=</span>d<span class="sc">$</span>Location)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="data_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>The arc length is measured in toises. A toise is a pre-metric unit of length approximately equal to 6.39 feet. It is clear from the table and from the table and from the plot that the the arc length goes up as the latitude increases and the relationship between the arc length and the sine squared of the latitude is approximately linear and the relationship is <span class="math display">\[
\text{Arc Length} = \beta_0 +  \beta_1 \sin^2 \theta
\]</span> where <span class="math inline">\(\theta\)</span> is the latitude. Here <span class="math inline">\(\beta_0\)</span> is the length of a degree of arc at the equator, and <span class="math inline">\(\beta_1\)</span> is how much longer a degree of arc is at the pole. The question that Boscovich asked is how can we combine those five data points to estimate the parameters <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>? His first attempt to answer this question involved calculating ten slopes for each pair of points and then averaging them. The table below shows the ten slopes.</p>
<div class="cell" data-null_prefix="true">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"../../data/boscovich.csv"</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>sl <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,<span class="dv">5</span>,<span class="dv">5</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) {</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(i<span class="dv">-1</span>)) {</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>        dx <span class="ot">=</span> d<span class="sc">$</span>sin2Latitude[i] <span class="sc">-</span> d<span class="sc">$</span>sin2Latitude[j]</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>        dy <span class="ot">=</span> d<span class="sc">$</span>ArcLength[i] <span class="sc">-</span> d<span class="sc">$</span>ArcLength[j]</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>        sl[i,j]<span class="ot">=</span>dy<span class="sc">/</span>dx</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(sl) <span class="ot">=</span> d<span class="sc">$</span>Location</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(sl) <span class="ot">=</span> d<span class="sc">$</span>Location</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">knitr.kable.NA =</span> <span class="st">''</span>)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(sl, <span class="at">digits =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Ten slopes for each pair of the five cities from the Boscovich data</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Quito</th>
<th style="text-align: right;">Cape of Good Hope</th>
<th style="text-align: right;">Rome</th>
<th style="text-align: right;">Paris</th>
<th style="text-align: right;">Lapland</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Quito</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Cape of Good Hope</td>
<td style="text-align: right;">0.096</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Rome</td>
<td style="text-align: right;">0.049</td>
<td style="text-align: right;">-0.035</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Paris</td>
<td style="text-align: right;">0.056</td>
<td style="text-align: right;">0.013</td>
<td style="text-align: right;">0.085</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Lapland</td>
<td style="text-align: right;">0.080</td>
<td style="text-align: right;">0.071</td>
<td style="text-align: right;">0.118</td>
<td style="text-align: right;">0.13</td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
<p>Ten slopes for each pair of the five cities from the Boscovich data</p>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(d<span class="sc">$</span>sin2Latitude,d<span class="sc">$</span>ArcLength, <span class="at">ylab=</span><span class="st">"Arc Length"</span>, <span class="at">xlab=</span><span class="fu">expression</span>(sin<span class="sc">^</span><span class="dv">2</span><span class="sc">~</span>(theta)), <span class="at">pch=</span><span class="dv">16</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(d<span class="sc">$</span>sin2Latitude,d<span class="sc">$</span>ArcLength<span class="dv">-25</span>, <span class="at">labels=</span>d<span class="sc">$</span>Location)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>){</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> (i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="dv">5</span>){</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    slope <span class="ot">=</span> (d<span class="sc">$</span>ArcLength[i] <span class="sc">-</span> d<span class="sc">$</span>ArcLength[j])<span class="sc">/</span>(d<span class="sc">$</span>sin2Latitude[i] <span class="sc">-</span> d<span class="sc">$</span>sin2Latitude[j])</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    intercept <span class="ot">=</span> d<span class="sc">$</span>ArcLength[i] <span class="sc">-</span> slope<span class="sc">*</span>d<span class="sc">$</span>sin2Latitude[i]</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">abline</span>(<span class="at">a=</span>intercept, <span class="at">b=</span>slope)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="data_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="576"></p>
<figcaption>Ten slopes for each pair of the five cities from the Boscovich data</figcaption>
</figure>
</div>
</div>
</div>
<p>The average of the ten slopes is 0.0667. Notice the slope between Cape of Good Hope and Rome is negative. This is due to the measurement error. Boscovich then calculated an average after removing this outlier. The average of the remaining nine slopes is 0.078. In both cases he used length of the arc at Quito as estimate of the intercept <span class="math inline">\(\beta_0\)</span>. <a href="#fig-Boscovich-1" class="quarto-xref">Figure&nbsp;<span class="quarto-unresolved-ref">fig-Boscovich-1</span></a> shows the line that corresponds to the parameter estimates obtained by Boscovich. <a href="#fig-Boscovich-2" class="quarto-xref">Figure&nbsp;<span class="quarto-unresolved-ref">fig-Boscovich-2</span></a> is the same plot but with the modern least squares line.</p>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>d<span class="ot">=</span><span class="fu">read.csv</span>(<span class="st">"../../data/boscovich.csv"</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(d<span class="sc">$</span>sin2Latitude,d<span class="sc">$</span>ArcLength, <span class="at">ylab=</span><span class="st">"Arc Length"</span>, <span class="at">xlab=</span><span class="fu">expression</span>(sin<span class="sc">^</span><span class="dv">2</span><span class="sc">~</span>(theta)), <span class="at">pch=</span><span class="dv">16</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">56700</span>,<span class="dv">57450</span>), <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">30</span>,<span class="dv">8590</span>))</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">56751</span>,<span class="fl">0.06670097</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(d<span class="sc">$</span>sin2Latitude,d<span class="sc">$</span>ArcLength, <span class="at">ylab=</span><span class="st">"Arc Length"</span>, <span class="at">xlab=</span><span class="fu">expression</span>(sin<span class="sc">^</span><span class="dv">2</span><span class="sc">~</span>(theta)), <span class="at">pch=</span><span class="dv">16</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">56700</span>,<span class="dv">57450</span>), <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">30</span>,<span class="dv">8590</span>))</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(ArcLength<span class="sc">~</span>sin2Latitude, <span class="at">data=</span>d), <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-Boscovich" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Boscovich-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-Boscovich" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-Boscovich-1" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-Boscovich-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="data_files/figure-html/fig-Boscovich-1.png" class="img-fluid figure-img" data-ref-parent="fig-Boscovich" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-Boscovich-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Boscovich’s first attempt to estimate the parameters
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-Boscovich" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-Boscovich-2" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-Boscovich-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="data_files/figure-html/fig-Boscovich-2.png" class="img-fluid figure-img" data-ref-parent="fig-Boscovich" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-Boscovich-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Modern least squares approach
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Boscovich-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.1: Comparison of Boscovich’s first attempt to estimate the parameters and the modern least squares approach
</figcaption>
</figure>
</div>
<p>This is a very reasonable approach! However, Boscovich was not satisfied with this approach and he wanted to find a better way to combine the data. He was looking for a method that would minimize the sum of the absolute deviations between the data points and the fitted curve. Two years later he developed a pioneering technique called “least absolute deviations,” which revolutionized data analysis. This method, distinct from the prevalent “least squares” approach, minimized the sum of absolute deviations between data points and the fitted curve, proving particularly effective in handling measurement errors and inconsistencies.</p>
<p>Armed with his meticulous measurements and innovative statistical analysis, Boscovich not only confirmed the oblate spheroid shape of the Earth but also refined its dimensions. His calculations yielded a more accurate value for the Earth’s equatorial radius and the flattening at the poles, providing crucial support for Newton’s theory of gravitation, which predicted this very shape.</p>
</div>
<p>Motivated by the analysis of planetary orbits and determining the shape of the Earth, later in 1805, Adrien-Marie Legendre (1752 - 1833) published the first clear and concise explanation of the <strong>least squares</strong> method in his book “Nouvelles méthodes pour la détermination des orbites des comètes”. The method of least squares is a powerful statistical technique used today fit a mathematical model to a set of data points. Its goal is to find the best-fitting curve that minimizes the sum of the squared distances (a.k.a residuals) between the curve and the actual data points. Compared to the approach proposed by Boscovich, the least squares method is less robust to measurement errors and inconsistencies. However, from computational point of view, it is more efficient and there are various algorithms exist for efficient calculation of curve parameters. This computational efficiency is crucial for modern data analysis, where datasets can be massive and complex, making least squares a fundamental tool in statistics and data analysis, offering a powerful and widely applicable approach to data fitting and model building.</p>
<p>Legendre provided a rigorous mathematical foundation for the least squares method, demonstrating its theoretical underpinnings and proving its optimality under certain conditions. This mathematical basis helped establish the credibility and legitimacy of the method, paving the way for its wider acceptance and application. Legendre actively communicated his ideas and collaborated with other mathematicians, such as Carl Friedrich Gauss (1777-1855), who also contributed significantly to the development of the least squares method. While evidence suggests Gauss used the least squares method as early as 1795, his formal publication came later than Legendre’s in 1809. Despite the delay in publication, Gauss independently discovered the method and applied it to various problems, including celestial mechanics and geodesy. He developed efficient computational methods for implementing the least squares method, making it accessible for practical use by scientists and engineers. While Legendre’s clear exposition and early publication brought the least squares method to the forefront, Gauss’s independent discovery, theoretical development, practical applications, and contributions to computational methods were equally crucial in establishing the method’s significance and impact. Both mathematicians played vital roles in shaping the least squares method into the powerful statistical tool it is today.</p>
<p>Another French polymath Pierre-Simon Laplace (1749 - 1827) extended the methods of Boscovich and showed that the curve fitting problem could be solved by ordering the candidate slopes and finding the weighted median. Besides that Laplace made fundamental contributions to probability theory, developing the Bayesian approach to inference. Most of the work of Laplace was in the field of celestial mechanics, where he used data from astronomical observations to develop mathematical models and equations describing the gravitational interactions between celestial bodies. His analytical methods and use of observational data were pioneering in the field of celestial mechanics. Furthermore, developed methods for estimating population parameters from samples, such as the mean and variance and pioneered the use of random sampling techniques, which are essential for ensuring the validity and generalizability of statistical inferences. These contributions helped lay the foundation for modern sampling theory and survey design, which are crucial for conducting reliable and representative studies. Overall, Laplace’s contributions to data analysis were profound and enduring. His work in probability theory, error analysis, sampling methods, and applications significantly advanced the field and laid the groundwork for modern statistical techniques. He also played a crucial role in promoting statistical education and communication, ensuring that these valuable tools were accessible and utilized across various disciplines.</p>
<section id="why-pattern-matching" class="level2" data-number="12.1">
<h2 data-number="12.1" class="anchored" data-anchor-id="why-pattern-matching"><span class="header-section-number">12.1</span> Why Pattern Matching?</h2>
<p>For Gauss, Laplace and many other scientist, the main problem was the problem of estimating parameters, while the relationship between the variables was known and was usually linear, like in the shape of the earth example of multiplicative, e.g.&nbsp;Newton’s second law <span class="math inline">\(F = ma\)</span>. However, in many cases, the relationship between the variables is unknown and cannot be described by a simple mathematical model. <span class="citation" data-cites="halevy2009">Halevy, Norvig, and Pereira (<a href="#ref-halevy2009" role="doc-biblioref">2009</a>)</span> discuss the problem of human behavior and natural languages. Neither can be described by a simple mathematical model.</p>
<p>This is case, the <strong>pattern matching</strong> approach is a way to use data to find those relations. In data analysis, pattern matching is the process of identifying recurring sequences, relationships, or structures within a dataset. It’s like looking for a specific puzzle piece within a larger picture. By recognizing these patterns, analysts can gain valuable insights into the data, uncover trends, make predictions, and ultimately improve decision-making. Sometimes initial pattern matching analysis leads to a scientific discovery. Consider a case of mammography and early pattern matching.</p>
<div id="exm-mammography" class="theorem example">
<p><span class="theorem-title"><strong>Example 12.2 (Mammography and Early Pattern Matching)</strong></span> The use of mammograms for breast cancer detection relied on <strong>simple pattern matching</strong> in its initial stages. Radiologists visually examined the X-ray images for specific patterns indicative of cancer, such as: dense areas of tissue appearing different from surrounding breast tissue (a.k.a masses) and small white spots of calcium deposits called microcalcifications. These patterns were associated with early-stage cancer and could be easily missed by visual inspection alone.</p>
<p>Radiologists relied on their expertise and experience to identify these patterns and distinguish them from normal breast tissue variations. This process was subjective and prone to errors, particularly with subtle abnormalities or in dense breasts. Subtle abnormalities, especially in dense breasts, could be easily missed using visual assessment alone. Despite these limitations, pattern matching played a crucial role in the early detection of breast cancer, saving countless lives. It served as the foundation for mammography as a screening tool.</p>
<p>Albert Solomon, a German surgeon, played a pivotal role in the early development of mammography (<span class="citation" data-cites="nicosia2023">Nicosia et al. (<a href="#ref-nicosia2023" role="doc-biblioref">2023</a>)</span>). His most significant contribution was his 1913 monograph, “Beiträge zur Pathologie und Klinik der Mammakarzinome” (Contributions to the Pathology and Clinic of Breast Cancers). In this work, he demonstrated the potential of X-ray imaging for studying breast disease. He pioneered the use of X-rays, he compared surgically removed breast tissue images with the actual tissue and was able to identify characteristic features of cancerous tumors, such as their size, shape, and borders. He was one of the first to recognize the association between small calcifications appearing on X-rays and breast cancer.</p>
<p>Presence of calcium deposits is correlated with brest cancer and is still prevailing imaging biomarkers for its detection. Although discovery of the deposit-cancer asosciation induced scientific discoveries, the molecular mechanisms that leads to the formation of these calcium deposits, as well as the significance of their presence in human tissues, have not been completely understood (<span class="citation" data-cites="bonfiglio2021">Bonfiglio et al. (<a href="#ref-bonfiglio2021" role="doc-biblioref">2021</a>)</span>).</p>
</div>
<section id="richard-feynman-on-pattern-matching-and-chess" class="level3" data-number="12.1.1">
<h3 data-number="12.1.1" class="anchored" data-anchor-id="richard-feynman-on-pattern-matching-and-chess"><span class="header-section-number">12.1.1</span> Richard Feynman on Pattern Matching and Chess</h3>
<p>Richard Feynman, the renowned physicist, was a strong advocate for the importance of pattern matching and its role in learning and problem-solving. He argued that in many scientific discoveries, start with pattern matching. He emphasized that experts in any field, whether it’s chess, science, or art, develop a strong ability to identify and understand relevant patterns in their respective domains.</p>
<p>He often used the example of chess to illustrate this concept (<span class="citation" data-cites="feynman">Feynman (<a href="#ref-feynman" role="doc-biblioref">n.d.</a>)</span>). Feynman argued that a skilled chess player doesn’t consciously calculate every possible move. Instead, they recognize patterns on the board and understand the potential consequences of their actions. For example, a chess player might recognize that having a knight in a certain position is advantageous and will lead to a favorable outcome. This ability to identify and understand patterns allows them to make quick and accurate decisions during the game. Through playing and analyzing chess games, players develop mental models that represent their understanding of the game’s rules, strategies, and potential patterns. These mental models allow them to anticipate their opponent’s moves and formulate effective responses.</p>
<p>He emphasized that this skill could be transferred to other domains, such as scientific research, engineering, and even everyday problem-solving.</p>
<p>Here is a quote from his interview</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Richard Feynman
</div>
</div>
<div class="callout-body-container callout-body">
<p>Let’s say a chess game. And you don’t know the rules of the game, but you’re allowed to look at the board from time to time, in a little corner, perhaps. And from these observations, you try to figure out what the rules are of the game, what [are] the rules of the pieces moving.</p>
<p>You might discover after a bit, for example, that when there’s only one bishop around on the board, that the bishop maintains its color. Later on you might discover the law for the bishop is that it moves on a diagonal, which would explain the law that you understood before, that it maintains its color. And that would be analogous we discover one law and later find a deeper understanding of it.</p>
<p>Ah, then things can happen–everything’s going good, you’ve got all the laws, it looks very good–and then all of a sudden some strange phenomenon occurs in some corner, so you begin to investigate that, to look for it. It’s castling–something you didn’t expect …..</p>
<p>After you’ve noticed that the bishops maintain their color and that they go along on the diagonals and so on, for such a long time, and everybody knows that that’s true; then you suddenly discover one day in some chess game that the bishop doesn’t maintain its color, it changes its color. Only later do you discover the new possibility that the bishop is captured and that a pawn went all the way down to the queen’s end to produce a new bishop. That could happen, but you didn’t know it.</p>
</div>
</div>
<p>In an interview on Artificial General Intelligence (AGI), he compares human and machine intelligence</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Richard Feynman
</div>
</div>
<div class="callout-body-container callout-body">
<p>First of all, do they think like human beings? I would say no and I’ll explain in a minute why I say no. Second, for “whether they be more intelligent than human beings: to be a question, intelligence must first be defined. If you were to ask me are they better chess players than any human being? Possibly can be , yes ,”I’ll get you some day”. They’re better chess players than most human beings right now!</p>
</div>
</div>
<p>By 1996, computers had become stronger than GMs. With the advent of deep neural networks in 2002, Stockfish15 is way stronger. A turning point on our understanding of AI algorithms was AlphaZero and Chess</p>
<p>AlphaGo coupled with deep neural networks and Monte Carlo simulation provided a gold standard for chess. AlphaZero showed that neural networks can self-learn by competing against itself. Neural networks are used to pattern match and interpolate both the policy and value function. This implicitly performs “feature selection”. Whilst humans have heuristics for features in chess, such as control center, king safety and piece development, AlphaZero “learns” from experience. With a goal of maximizing the probability of winning, neural networks have a preference for initiative, speed and momentum and space over minor material such as pawns. Thus reviving the old school romantic chess play.</p>
<p>Feynman discusses how machines show intelligence:</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Richard Feynman
</div>
</div>
<div class="callout-body-container callout-body">
<p>With regard to the question of whether we can make it to think like [human beings], my opinion is based on the following idea: That we try to make these things work as efficiently as we can with the materials that we have. Materials are different than nerves, and so on. If we would like to make something that runs rapidly over the ground, then we could watch a cheetah running, and we could try to make a machine that runs like a cheetah. But, it’s easier to make a machine with wheels. With fast wheels or something that flies just above the ground in the air. When we make a bird, the airplanes don’t fly like a bird, they fly but they don’t fly like a bird, okay? They don’t flap their wings exactly, they have in front, another gadget that goes around, or the more modern airplane has a tube that you heat the air and squirt it out the back, a jet propulsion, a jet engine, has internal rotating fans and so on, and uses gasoline. It’s different, right?</p>
<p>So, there’s no question that the later machines are not going to think like people think, in that sense. With regard to intelligence, I think it’s exactly the same way, for example they’re not going to do arithmetic the same way as we do arithmetic, but they’ll do it better.</p>
</div>
</div>
</section>
</section>
<section id="correlations" class="level2" data-number="12.2">
<h2 data-number="12.2" class="anchored" data-anchor-id="correlations"><span class="header-section-number">12.2</span> Correlations</h2>
<p>Arguable, the simplest form of pattern matching is correlation. Correlation is a statistical measure that quantifies the strength of the relationship between two variables. It is a measure of how closely two variables move in relation to each other. Correlation is often used to identify patterns in data and determine the strength of the relationship between two variables. It is a fundamental statistical concept that is widely used in various fields, including science, engineering, finance, and business.</p>
<p>Let’s consider the correlation between returns on Google stock and S&amp;P 500 stock index. The correlation coefficient is a measure of the strength and direction of the linear relationship between two variables. It is a number between -1 and 1.</p>
<div id="exm-googstock" class="theorem example">
<p><span class="theorem-title"><strong>Example 12.3 (Google Stock Returns)</strong></span> <a href="#fig-googsp" class="quarto-xref">Figure&nbsp;<span class="quarto-unresolved-ref">fig-googsp</span></a> shows the scattershot of Google and S&amp;P 500 daily returns</p>
<div class="cell" data-null_prefix="true">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>goog <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"../../data/GOOG2019.csv"</span>) </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>rgoog <span class="ot">=</span> goog<span class="sc">$</span>Adj.Close[<span class="dv">2</span><span class="sc">:</span><span class="dv">251</span>]<span class="sc">/</span>goog<span class="sc">$</span>Adj.Close[<span class="dv">1</span><span class="sc">:</span><span class="dv">250</span>] <span class="sc">-</span> <span class="dv">1</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>sp <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"../../data/SP2019.csv"</span>);   rsp <span class="ot">=</span> sp<span class="sc">$</span>Adj.Close[<span class="dv">2</span><span class="sc">:</span><span class="dv">251</span>]<span class="sc">/</span>sp<span class="sc">$</span>Adj.Close[<span class="dv">1</span><span class="sc">:</span><span class="dv">250</span>] <span class="sc">-</span> <span class="dv">1</span> </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rgoog, rsp, <span class="at">col=</span><span class="st">"lightblue"</span>, <span class="at">pch=</span><span class="dv">21</span>, <span class="at">bg=</span><span class="st">"grey"</span>, <span class="at">xlab=</span><span class="st">"GOOG return"</span>, <span class="at">ylab=</span><span class="st">"SP500 return"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-googsp" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-googsp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="data_files/figure-html/fig-googsp-1.png" class="img-fluid figure-img" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-googsp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.2: Scattershot of Google and S&amp;P 500 daily returns
</figcaption>
</figure>
</div>
</div>
</div>
<p>Let’s calculate the covariance and correlation between the daily returns of the Google stock and S&amp;P 500.</p>
<div class="cell" data-null_prefix="true">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>var_goog <span class="ot">=</span> <span class="fu">mean</span>((rgoog <span class="sc">-</span> <span class="fu">mean</span>(rgoog))<span class="sc">^</span><span class="dv">2</span>) </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>var_sp <span class="ot">=</span> <span class="fu">mean</span>((rsp <span class="sc">-</span> <span class="fu">mean</span>(rsp))<span class="sc">^</span><span class="dv">2</span>) </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>cov <span class="ot">=</span> <span class="fu">mean</span>((rgoog <span class="sc">-</span> <span class="fu">mean</span>(rgoog))<span class="sc">*</span>(rsp <span class="sc">-</span> <span class="fu">mean</span>(rsp))); <span class="fu">print</span>(cov) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> 8e-05</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>cor <span class="ot">=</span> cov<span class="sc">/</span>(<span class="fu">sqrt</span>(var_goog)<span class="sc">*</span><span class="fu">sqrt</span>(var_sp)); <span class="fu">print</span>(cor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> 0.67</code></pre>
</div>
</div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-altic2013" class="csl-entry" role="listitem">
Altić, Mirela Slukan. 2013. <span>“Exploring Along the Rome Meridian: <span>Roger</span> Boscovich and the First Modern Map of the Papal States.”</span> In <em>History of Cartography: <span>International</span> Symposium of the <span>ICA</span>, 2012</em>, 71–89. <span>Springer</span>.
</div>
<div id="ref-bonfiglio2021" class="csl-entry" role="listitem">
Bonfiglio, Rita, Annarita Granaglia, Raffaella Giocondo, Manuel Scimeca, and Elena Bonanno. 2021. <span>“Molecular Aspects and Prognostic Significance of Microcalcifications in Human Pathology: <span>A</span> Narrative Review.”</span> <em>International Journal of Molecular Sciences</em> 22 (120).
</div>
<div id="ref-feynman" class="csl-entry" role="listitem">
Feynman, Richard. n.d. <span>“Feynman :: <span>Rules</span> of Chess.”</span>
</div>
<div id="ref-halevy2009" class="csl-entry" role="listitem">
Halevy, Alon, Peter Norvig, and Fernando Pereira. 2009. <span>“The Unreasonable Effectiveness of Data.”</span> <em>IEEE Intelligent Systems</em> 24 (2): 8–12.
</div>
<div id="ref-nicosia2023" class="csl-entry" role="listitem">
Nicosia, Luca, Giulia Gnocchi, Ilaria Gorini, Massimo Venturini, Federico Fontana, Filippo Pesapane, Ida Abiuso, et al. 2023. <span>“History of Mammography: <span>Analysis</span> of Breast Imaging Diagnostic Achievements over the Last Century.”</span> <em>Healthcare</em> 11 (1596).
</div>
<div id="ref-stigler1981" class="csl-entry" role="listitem">
Stigler, Stephen M. 1981. <span>“Gauss and the Invention of Least Squares.”</span> <em>The Annals of Statistics</em>, 465–74.
</div>
</div>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../qmd/rl.html" class="pagination-link  aria-label=" &lt;span="" learning&lt;="" span&gt;"="">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Reinforcement Learning</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../qmd/theoryai.html" class="pagination-link" aria-label="<span class='chapter-number'>12</span>&nbsp; <span class='chapter-title'>Theory of AI</span>">
        <span class="nav-page-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Theory of AI</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>